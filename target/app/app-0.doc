
0:F:\git\coin\bisheng commerce\App\Admin\Common\index.html
 

1:F:\git\coin\bisheng commerce\App\Admin\Conf\config.php
<?php
return array(
	//'配置项'=>'配置值'
);

2:F:\git\coin\bisheng commerce\App\Admin\Conf\index.html
 

3:F:\git\coin\bisheng commerce\App\Admin\Controller\AdminController.class.php
<?php
namespace Admin\Controller;
use Common\Controller\CommonController;
class AdminController extends CommonController {
	protected $admin;
	protected $config;
	public function _initialize(){
		parent::_initialize();
		//验证登录
		if (empty($_SESSION['admin_userid'])){
			$this->redirect('Login/login');
		}
		
		//管理员信息
		$uid=$_SESSION['admin_userid'];
		$admin_user=M("Admin")->where("admin_id='$uid'")->find();
		$this->admin=$admin_user;
		//网站配置信息
		$config=M("Config")->field('key,value')->select();
		foreach ($config as $k=>$v){
			$config[$v['key']]=$v['value'];
		}
		$this->config=$config;
		//**************权限管理***********
		$URL_MODULE_MAP = array_keys(C('URL_MODULE_MAP'))[0];
		$adminquanxian=M("Admin")->field('Nav')->where("admin_id='{$_SESSION['admin_userid']}'")->find();
		$rules=$adminquanxian['nav'];
		if(empty($rules)){
			$this->error('此账号尚未分配权限',$URL_MODULE_MAP.'/Login/login');
		}
		$rules=explode(',', $rules);
		foreach ($rules as $k=>$v){
			$list[]=M("Nav")->where('nav_id='.$v)->find();
		}
		foreach ($list as $k=>$v){
			$v['nav_url'] = '/'.$URL_MODULE_MAP.$v['nav_url'];
			$value[$v['cat_id']][]=$v;
		}
		foreach ($value as $k=>$v){
			$this->assign($k."_nav",$v);
		}
		$this->assign('URL_MODULE_MAP',$URL_MODULE_MAP);
	}
	//图片处理
	public function upload($file){
	    
	    switch($file['type'])
	    {
	        case 'image/jpeg': $ext = 'jpg'; break;
	        case 'image/gif': $ext = 'gif'; break;
	        case 'image/png': $ext = 'png'; break;
	        case 'image/tiff': $ext = 'tif'; break;
	        default: $ext = ''; break;
	    }
	    if (empty($ext)){
	        return false;
	    }
		$upload = new \Think\Upload();// 实例化上传类
		$upload->maxSize   =     3145728 ;// 设置附件上传大小
		$upload->exts      =     array('jpg', 'gif', 'png', 'jpeg');// 设置附件上传类型
		$upload->savePath  =      './Public/Uploads/'; // 设置附件上传目录
		// 上传文件
		$info   =  $upload->uploadOne($file);
		if(!$info) {
			// 上传错误提示错误信息
			$this->error($upload->getError());exit();
		}else{
			// 上传成功
			$pic=$info['savepath'].$info['savename'];
			$url='/Uploads'.ltrim($pic,".");
		}
		return $url;
	}
	
	public function upload_art($file){
			
		// 		switch($file['type'])
		// 		{
		// 			case 'image/jpeg': $ext = 'jpg'; break;
		// 			case 'image/gif': $ext = 'gif'; break;
		// 			case 'image/png': $ext = 'png'; break;
		// 			case 'image/tiff': $ext = 'tif'; break;
		// 			default: $ext = ''; break;
		// 		}
		// 		if (empty($ext)){
		// 			return false;
		// 		}
	
		if($file['type'] != "application/msword"){
			return false;
		}
		$ext = "doc";
		$upload = new \Think\Upload();// 实例化上传类
		$upload->maxSize   =     3145728 ;// 设置附件上传大小
		// 		$upload->exts      =     array('jpg', 'gif', 'png', 'jpeg');// 设置附件上传类型
		$upload->exts      =     array('doc');
		$upload->savePath  =      './Public/Uploads/'; // 设置附件上传目录
		// 上传文件
	
		$info   =  $upload->uploadOne($file);
		if(!$info) {
			// 上传错误提示错误信息
			$this->error($upload->getError());exit();
		}else{
			// 			dump($file);die;
			// 上传成功
			$pic=$info['savepath'].$info['savename'];
			$url='/Uploads'.ltrim($pic,".");
		}
		return $url;
	}
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
}




4:F:\git\coin\bisheng commerce\App\Admin\Controller\ArtController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class ArtController extends AdminController{
    //空操作
    public function _empty(){
        header("HTTP/1.0 404 Not Found");
        $this->display('Public:404');
    }
    /**
     * 显示公告，资信，团队信息的文章列表
     * 
     */
    public function index(){
    	//$article_category_id为权限配置中的一个参数
    	$article_category_id = I("article_category_id");
    	$news_id = I("news_id");
		$news_title = I("title");
		
        if(!empty($news_title)){
        	$where[C('DB_PREFIX')."article.title"] = array('like','%'.$news_title.'%');
        	$inquire['news_title'] = $news_title;
        }
      	//当进入的分类id为公告，资信，团队信息
        $where[C('DB_PREFIX')."article_category.id"] = $article_category_id;
	    $count = $this->getCountArticleByWhere($where);
	    //查找对应$article_category_id的文章类型名称，反馈到页面
	    $condition = C("DB_PREFIX")."article_category.id = {$article_category_id}";
	    $article_category = $this->getArticleCategoryNameByArticleCategoryId($condition);

        // 实例化分页类 传入总记录数和每页显示的记录数
        $Page  = new \Think\Page($count,20);
        //给分页传参数 ，因为公告，资信，团队信息，没有id查询，所以只有title
        	setPageParameter($Page, array("title"=>$news_title));
        //分页显示输出性
        $show = $Page->show();
		//根据条件查询文章信息等所以资料
        $info = $this->getContentArticleByWhere($where, $Page);
		//限制页面显示的文字数量
        foreach ($info as $k=>$v){
             $info[$k]['title']=mb_substr((strip_tags(html_entity_decode($v['title']))),0,14,'utf-8');
             $info[$k]['content']=mb_substr((strip_tags(html_entity_decode($v['content']))),0,30,'utf-8');
        }
        
       $this->assign('inquire',$inquire);
       $this->assign('category',$article_category);
       $this->assign('page',$show);
       $this->assign('info',$info);
       $this->display();
    }
    
    /**
     * 显示帮助中心的文章列表
     */
    public function helpindex(){

    	$news_id = I("news_id");
    	$news_title = I("title");

    	if(!empty($news_title)){
    		$where[C('DB_PREFIX')."article.title"] = array('like','%'.$news_title.'%');
    		$inquire['news_title'] = $news_title;
    	}
    	//是否有帮助中心的类型查询
    	if(!empty($news_id)){
    		$where[C('DB_PREFIX')."article.position_id"] = $news_id;
    		$inquire['news_id'] = $news_id;
    	}
    	//查询条件为，parent_id为6的信息（如果没有索引查询，就查出帮助中心的所有信息）
    		$where[C('DB_PREFIX')."article_category.parent_id"] = 6;
    		$count = $this->getCountArticleByWhere($where);
			
    		//将parent_id为6的分类查新出来，显示到页面作为下菜单
    		$article_category = M('Article_category')->order("id asc")->where('parent_id = 6')->select();//查找1级分类
    		//以一级为基础，形成遍历
    		foreach($article_category as $k=>$v){
    			//加入二级分类，以一级id为查询条件
    			$article_category[$k]['children']= M('Article_category')->where(C("DB_PREFIX")."article_category.parent_id = {$v['id']}")->order("id asc")->select();
    		}

    	// 实例化分页类 传入总记录数和每页显示的记录数
    	$Page  = new \Think\Page($count,20);
    	//给分页传参数
    	setPageParameter($Page, array("news_id"=>$news_id,"title"=>$news_title));
    	//分页显示输出性
    	$show = $Page->show();
    	//根据条件查找的所以信息
    	$info = $this->getContentArticleByWhere($where, $Page);
    
    	//限制页面显示的文字数量
    	foreach ($info as $k=>$v){
    		$info[$k]['title']=mb_substr((strip_tags(html_entity_decode($v['title']))),0,14,'utf-8');
    		$info[$k]['content']=mb_substr((strip_tags(html_entity_decode($v['content']))),0,30,'utf-8');
    	}


    	$this->assign('inquire',$inquire);
    	$this->assign('category',$article_category);
    	$this->assign('page',$show);
    	$this->assign('info',$info);
    	$this->display();
    
    }
    /**
     * 添加/修改系统公告，市场等文章
     * 
     */
    public function insert(){
    	$article_category_id = I('article_category_id');
        if(IS_POST){
            $data['title']=I('post.title');//标题
            $data['content'] =  I('post.content','','html_entity_decode');//内容
            $data['position_id'] = I('post.category_id');//类型  根据类型表的id 对比
            $data['add_time'] = time();//添加时间
            $data['sign'] =I('sign');//是否标红
            //如果post中有id，证明是修改传来的，所以save
            if($_POST['article_id']){
            	$data['article_id'] = I('post.article_id');
            	$re = M('Article')->save($data);
            }else{
            	$re = M('Article')->add($data);//加入数据库
            }
            if($re===false){
                $this->error('操作失败');
                return;
            }
            else{
            	//将公告发给所有用户
            	if($data['position_id']==1) {
            		$content = $data['title']
            		. "<br/><a href=" . U('Home/Art/details', array('id' => $re)) . ">点击显示详情</a>";
            		$this->addMessage_all(-1, -1, $data['title'], $content);
            	}
                $this->success('操作成功',I('post.url'));
                return;
           }
        }else{
        	//当获取到get，证明是修改功能， 显示所选的信息到页面
        	if($_GET['article_id']){
        		$article_id = I('get.article_id');
        		$list = M('Article')->where("article_id = {$article_id}")->find();
        		$this->assign("list",$list);
        	} 	
 
        		//查找对应article_category_id的文章分类，如果是帮追中心（6），遍历显示。如果不是，直接查询显示
        		if($article_category_id == 6){
        			$article_category = M('Article_category')->order("id asc")->where('parent_id = 6')->select();//查找1级分类
        			//以一级为基础，形成遍历
        			foreach($article_category as $k=>$v){
        				//加入二级分类，以一级id为查询条件
        				$article_category[$k]['children']= M('Article_category')->where(C("DB_PREFIX")."article_category.parent_id = {$v['id']}")->order("id asc")->select();
        			}
        		}else{
        			$condition = C("DB_PREFIX")."article_category.id = {$article_category_id}";
        			$article_category = $this->getArticleCategoryNameByArticleCategoryId($condition);
        		}

	            $this->assign('category',$article_category);
            	$this->display();
        	}
    	}


    /**
     * 删除文章
     * return boolen
     */
    public function delete(){
        $id=intval(I('get.article_id'));
        $re = M('Article')->delete($id);
        if($re){
            $this->success('删除成功');
        }else{
            $this->error('删除失败');
            return;
        }
    }
    
    /**
     * 查找不同类型的文章分类
     * @param array $where 查询条件 数组形式
     * @return boolean|Array 返回查询数组 成功返回结果集 失败返回null
     */
    private function getArticleCategoryNameByArticleCategoryId($where){
    	$info= M('Article_category')->where($where)->select();
    	return $info;
    }
    /**
     * 查询对应条件的数据个数
     * @param array $where 查询条件
     * @param unknown $article_category_id 对应的文章类型id
     * @return boolean|Array 返回查询数量  成功返回数量 失败返回null
     */
    private function getCountArticleByWhere($where){
    	$count = M('Article')->join(C('DB_PREFIX')."article_category ON ".C('DB_PREFIX')."article.position_id = ".C('DB_PREFIX')."article_category.id")
                    ->where($where)
        			->count();
    	return $count;
    }
    /**
     * 查询对应文章信息
     * @param unknown $where 查询条件
     * @param unknown $article_category_id 对应的文章类型id
     * @return boolean|Array 返回查询数组 成功返回结果集 失败返回null
     */
    private function getContentArticleByWhere($where,$Page){
    	 $info = M('Article')->join(C('DB_PREFIX')."article_category ON ".C('DB_PREFIX')."article.position_id = ".C('DB_PREFIX')."article_category.id")
				    ->where($where)
				    ->order('add_time desc,sort')
				    ->limit($Page->firstRow.','.$Page->listRows)
				    ->select();
    	return $info;
    }
}

5:F:\git\coin\bisheng commerce\App\Admin\Controller\ArttypeController.class.php
<?php

namespace Admin\Controller;
use Admin\Controller\CommonController;
class ArttypeController extends AdminController{
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}

		public function index(){
			$this->display();
		}
		/**
		 * 添加文章分类
		 * return id 添加成功信息的id
		 */
		public function insert(){
			$art_cat = M('Article_category');
	
			if(IS_POST){
				//确定分类别
				$data['parent_id']= 6;
				//分类名称
				$data['name']=I('name');
				//关键字
				$data['keywords'] =  I('keyword','','html_entity_decode');
				//排序
				$data['sort'] = I('sort','','html_entity_decode');
				
				//加入数据库
				
				if(I('fenlei_id')){
					$data['id'] = I('fenlei_id');
					$re = $art_cat->save($data);
				}else{
					$re = $art_cat->add($data);
				}
				if($re===false){
					$this->error('操作失败');
					return;
				}else{
					$this->success('操作成功');
					return;
				}
			}else{
				if($_GET['id']){
					$id = I('get.id');
					$list = M('Article_category')->where("id = {$id}")->find();
					$this->assign("list",$list);
				}
				//遍历分类（无限级分类）
				$cat = $art_cat->order("id asc")->where('parent_id = 6')->select();//查找1级分类
				//以一级为基础，形成遍历树		

			}		
				$this->assign('cat',$cat);
				$this->display();
			
		}

		/**
		 * 删除分类
		 * return boolen
		 */
		public function delete(){
			$art_cat = M('Article_category');
			$id=intval(I('get.id'));
			$re = $art_cat->delete($id);
			if($re){
				$this->success('删除成功');
			}else{
				$this->error('删除失败');
				return;
			}
		}
	}


?>

6:F:\git\coin\bisheng commerce\App\Admin\Controller\BonusController.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午12:28
 */

namespace Admin\Controller;
use Admin\Controller\AdminController;
class BonusController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    /**
     * 发红添加
     */
    public function index(){
    	$type = M('Currency')->field('currency_id,currency_name')->where('status = 0')->select();
    	foreach($type as $k=>$v){
    		$money = $this ->getSumMoneyByCurrencyId(10,$v['currency_id']);
    		$sumMoney = $this->getSumMoneyByCurrencyId(11,$v['currency_id']);
    		$list[$k]['sumMoney'] = $sumMoney[0]['money'];
    		$list[$k]['money'] = $money[0]['money'];
    		$list[$k]['currency_id'] = $v['currency_id'];
    	}
    
    	$this->assign('list',$list);
        $this->assign('currency',$type);// 赋值数据集    
        $this->display(); // 输出模板
    }
    
    public function bonusList(){
    	$where['type'] = '10';
    	$finance = M('Finance');
    	
    	$count      = $finance->where($where)->count();// 查询满足要求的总记录数
    	$Page       = new \Think\Page($count,15);// 实例化分页类 传入总记录数和每页显示的记录数(25)
    	//给分页传参数
    	$show       = $Page->show();// 分页显示输出
    	// 进行分页数据查询 注意limit方法的参数要使用Page类的属性
    	
    	$list = $finance
    	->where($where)
    	->limit($Page->firstRow.','.$Page->listRows)->select();
    	$this->assign('list',$list);// 赋值数据集
    	$this->assign('page',$show);// 赋值分页输出
    	$this->display(); // 输出模板
    }
    
//     /**
//      * 添加分红
//      */
//     public function addBonus(){
//         if(IS_POST){
//         	if(empty($_POST['num'])){
//         		$this->error('分红数值不能为空');
//         	}
//         	if(empty($_POST['currency_id'])){
//         		$this->error('分红币种不能为空');
//         	}
//         	if(empty($_POST['text'])){
//         		$this->error('消息提醒不能为空');
//         	}
//         	if(!is_numeric($_POST['num'])){
//         		$this->error('分红数值不正确');
//         	}
//         	$num = $_POST['num']; //分红的份额
//         	$text = $_POST['text']; //分红说明
//         	$where['currency_id']  = $_POST['currency_id'] ;
//         	$where['num'] = array('gt',0);
//         	//设置分红只有在账号正常情况下才可以分红  status  =1 位正常情况
//         	$member=M("Member")->where("status = 1")->select();
//         	if(empty($member)){
//         		$this->error('没有需要分红的人数');
//         	}
//         	foreach ($member as $v){
//         		$item[]=$v['member_id'];
//         	}
//         	$where['member_id']=array("in",$item);
//         	$list = M('Currency_user')->where($where)->field('currency_id,cu_id,member_id,num')->select();
//         	$count = M('Currency_user')-> where($where)->sum('num');
// 			if(empty($list)){
// 				$this->error('没有需要分红的人数');
// 			}
//         	foreach ($list as $k => $v){
//         		$currency_num = $num * ( $v['num'] / $count );
//         		$currency_num = round($currency_num,4);
//         		$this->updateMemberRmb($v['member_id'],$currency_num);
// //         	  	$this -> updateCurrencyNum($v['currency_id'],$v['member_id'], $currency_num);
//         		addFinanceLog($v['member_id'], 10, $text, $currency_num,1, $v['currency_id']);
//         		$this -> addMessage_all($v['member_id'],-2,'分红奖励',$text);
//         	}
//         	$this ->success("分红成功");
//         }
//     }

    
    
    /**
     * 添加分红
     */
    public function addBonus(){
    	if(IS_POST){
    		if(empty($_POST['num'])){
    			$this->error('分红数值不能为空');
    		}
    		if(empty($_POST['currency_id'])){
    			$this->error('分红币种不能为空');
    		}
    		 
    		if(empty($_POST['text'])){
    			$this->error('消息提醒不能为空');
    		}
    		if(!is_numeric($_POST['num'])){
    			$this->error('分红数值不正确');
    		}
    		if(!isset($_POST['set_currency_id'])){
    			$this->error('分红基数不正确');
    		}
    		 
    		$num = $_POST['num']; //分红的份额
    		$text = $_POST['text']; //分红说明
    		$where['currency_id']  = $_POST['currency_id'] ;
    		$where['num'] = array('gt',0);
    		//设置分红只有在账号正常情况下才可以分红  status  =1 位正常情况
    		$member=M("Member")->where("status = 1")->select();
    		if(empty($member)){
    			$this->error('没有需要分红的人数');
    		}
    		foreach ($member as $v){
    			$item[]=$v['member_id'];
    		}
    		$where['member_id']=array("in",$item);
    		$list = M('Currency_user')->where($where)->field('currency_id,cu_id,member_id,num')->select();
    		 
    		$count = M('Currency_user')-> where($where)->sum('num');
    			
    		if(empty($list)){
    			$this->error('没有需要分红的人数');
    		}
    		foreach ($list as $k => $v){
    			$currency_num = $num * ( $v['num'] / $count );
    			$currency_num = round($currency_num,4);
    			if($_POST['set_currency_id'] == 0){
    				$this -> updateMemberRmb($v['member_id'], $currency_num);
    				addFinanceLog($v['member_id'], 10, $text, $currency_num,1, 0);
    			}else{
    				$this -> updateCurrencyNum($_POST['set_currency_id'],$v['member_id'], $currency_num);
    				addFinanceLog($v['member_id'], 10, $text, $currency_num,1, $v['currency_id']);
    			}
    
    			$this -> addMessage_all($v['member_id'],-2,'分红奖励',$text);
    		}
    		$this ->success("分红成功");
    	}
    }
    
    
    /**
     *  添加 分红奖励(虚拟币)
     * @param unknown  Int  $currency_id   币种 id
     * @param unknown  Int  $member_id      用户 id
     * @param unknown  float  $currency_num	    分红数量
     * @return boolean
     */
    private function updateCurrencyNum($currency_id,$member_id,$currency_num){
    	$where['currency_id']= $currency_id;
    	$where['member_id']= $member_id;
    	$re = M('Currency_user')-> where($where)->setInc('num',$currency_num);
    	if($re){
    		return  true;
    	}else{
    		return false;
    	}
    }
   
    /**
     *  添加 分红奖励 (人民币)
     * @param unknown  Int  $currency_id   币种 id
     * @param unknown  Int  $member_id      用户 id
     * @param unknown  float  $currency_num	    分红数量
     * @return boolean
     */
    private function updateMemberRmb($member_id,$currency_num){
    	$where['member_id']= $member_id;
    	$re = M('Member')-> where($where)->setInc('rmb',$currency_num);
    	if($re){
    		return  true;
    	}else{
    		return false;
    	}
    }
    
    
    /**
     *  在日志表里 统计分红 按照日志 type 
     * @param unknown $type          日志表type
     * @param unknown $currency_id   货币id
     */
    private  function getSumMoneyByCurrencyId($type,$currency_id){
    	if(!empty($currency_id)){
    		$currency_id = "currency_id  = ".$currency_id;
    	}
    	
    	$sql = "SELECT SUM(money)AS money,currency_id  from  ".C("DB_PREFIX")."finance  where type = ".$type." 
    			and ".$currency_id." GROUP BY  currency_id ";
    	$list = M()->query($sql);
    	return $list;
    }
}

7:F:\git\coin\bisheng commerce\App\Admin\Controller\ConfigController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class ConfigController extends AdminController {
	public function _initialize(){
		parent::_initialize();
	}
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	
	public function index(){
		$list=M('Config')->select();
		foreach ($list as $k=>$v){
               $list[$v['key']]=$v['value'];
				
		}
		$this->assign('config',$list);
       	$this->display();
     }
     
     public function customerService(){
     	$this->display();
     }
     
     public function shortMessage(){
     	$this->display();
     }
     public function finance(){
     	$this->display();
     }
     public function information(){
     	$this->display();
     }
     
     
     public function websiteBank(){
     	$this->display();
     }
     
     public function updateCofig(){
         if($_FILES["logo"]["tmp_name"]){
                $_POST['logo']=$this->upload($_FILES["logo"]);
                if (!$_POST['logo']){
                    $this->error('非法上传');
                }
         }
         if($_FILES["weixin"]["tmp_name"]){
              $_POST['weixin']=$this->upload($_FILES["weixin"]);
              if (!$_POST['weixin']){
                  $this->error('非法上传');
              }
         }

         if($_FILES["biaoge_url"]["tmp_name"]){
         	$_POST['biaoge_url']=$this->upload_art($_FILES["biaoge_url"]);
         	if (!$_POST['biaoge_url']){
         		$this->error('非法上传');
         	}
         }
         
         if (!empty($_POST['friendship_tips'])){
     	      $_POST['friendship_tips'] = I('post.friendship_tips','','html_entity_decode');
         }
         if (!empty($_POST['withdraw_warning'])){
        	$_POST['withdraw_warning'] = I('post.withdraw_warning','','html_entity_decode');
         }
         if (!empty($_POST['risk_warning'])){
             $_POST['risk_warning'] = I('post.risk_warning','','html_entity_decode');
         }
         if (!empty($_POST['VAP_rule'])){
             $_POST['VAP_rule'] = I('post.VAP_rule','','html_entity_decode');
         }
         if (!empty($_POST['disclaimer'])){
         	$_POST['disclaimer'] = I('post.disclaimer','','html_entity_decode');
         }
         if (!empty($_POST['FWTK'])){
         	$_POST['FWTK'] = I('post.FWTK','','html_entity_decode');
         }
         if (!empty($_POST['new_coin_up'])){
         	$_POST['new_coin_up'] = I('post.new_coin_up','','html_entity_decode');
         }
		 if (!empty($_POST['reg_risk_warning'])){
         	$_POST['reg_risk_warning'] = I('post.reg_risk_warning','','html_entity_decode');
         }
     	foreach ($_POST as $k=>$v){
     		$rs[]=M('Config')->where(C("DB_PREFIX")."config.key='{$k}'")->setField('value',$v);
     	}
     	if($rs){
     		$this->success('配置修改成功');
     	}else{
     		$this->error('配置修改失败');
     	}
     }
}

8:F:\git\coin\bisheng commerce\App\Admin\Controller\CurrencyController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class CurrencyController extends AdminController {
	protected $currency;
	public function _initialize(){
		parent::_initialize();
		$this->currency=M('Currency');
	}
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	
	/**
	 * 提币记录
	 */
	public function tibi_index(){
		
		$cuid=I('cuid');
		$email=I('email');
		if(!empty($cuid)){
			$where[C("DB_PREFIX")."tibi.currency_id"]=$cuid;
			$this->assign("id",$cuid);
		}
		if(!empty($email)){
			$name=M("Member")->where("email='{$email}'")->find();
			$where[C("DB_PREFIX")."tibi.user_id"]=$name['member_id'];
		}
		$where[C("DB_PREFIX")."tibi.status"]=array("in",array(0,1));
		
		$field=C("DB_PREFIX")."tibi.*,".C("DB_PREFIX")."member.email,".C("DB_PREFIX")."currency.currency_name";
		$count      = M("Tibi")->where($where)->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."tibi.user_id=".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."tibi.currency_id=".C("DB_PREFIX")."currency.currency_id")->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		//给分页传参数
		setPageParameter($Page, array('cuid'=>I("cuid"),'email'=>$name['member_id']));
		$show       = $Page->show();// 分页显示输出
		// 进行分页数据查询 注意limit方法的参数要使用Page类的属性

		$list = M("Tibi")->field($field)->where($where)->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."tibi.user_id=".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."tibi.currency_id=".C("DB_PREFIX")."currency.currency_id")->limit($Page->firstRow.','.$Page->listRows)->select();
		$this->assign('list',$list);// 赋值数据集
		$this->assign('page',$show);// 赋值分页输出
		
		
		//读取币种表
		
		$curr=M("Currency")->select();
		$this->assign("curr",$curr);
		
		$this->display();
	}
	
	/**
	 * 充值记录
	 */
	public function chongzhi_index(){
		$cuid=I('cuid');
		$email=I('email');
	
		if(!empty($cuid)){
			$where[C("DB_PREFIX")."tibi.currency_id"]=I("cuid");
			$this->assign("id",I("cuid"));
		}
		if(!empty($cuid)){
			$name=M("Member")->where("email='{$email}'")->find();
			$where[C("DB_PREFIX")."tibi.user_id"]=$name['member_id'];
		}
		$where[C("DB_PREFIX")."tibi.status"]=array("in",array(2,3));
			
		$field=C("DB_PREFIX")."tibi.*,".C("DB_PREFIX")."member.email,".C("DB_PREFIX")."currency.currency_name";
		
		$count      = M("Tibi")
		->where($where)
		->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."tibi.user_id= ".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."tibi.currency_id=".C("DB_PREFIX")."currency.currency_id")->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		//给分页传参数
		setPageParameter($Page, array('cuid'=>$cuid,'email'=>$email));
		$show       = $Page->show();// 分页显示输出
		// 进行分页数据查询 注意limit方法的参数要使用Page类的属性
		$list = M("Tibi")->field($field)->where($where)->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."tibi.user_id=".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."tibi.currency_id=".C("DB_PREFIX")."currency.currency_id")->limit($Page->firstRow.','.$Page->listRows)->select();
		$this->assign('list',$list);// 赋值数据集
		$this->assign('page',$show);// 赋值分页输出
	
	
		//读取币种表
	
		$curr=M("Currency")->select();
		$this->assign("curr",$curr);
	
		$this->display();
	}
	
	Public function add(){
		if(IS_POST){
			if(!empty($_POST['currency_id'])){
				$cu=M("Currency")->where("currency_name='{$_POST['currency_name']}' and currency_id <> '{$_POST['currency_id']}'")->find();
			}else{
				$cu=M("Currency")->where("currency_name='{$_POST['currency_name']}'")->find();
			}
			if(!empty($cu)){
				$this->error("币种名称已经存在");
			}
			
			foreach ($_POST as $k=>$v){
				$data[$k]=$v;
			}
			$data['add_time']=time();
			if($_FILES["Filedata"]["tmp_name"]){
				$data['currency_logo']=$this->upload($_FILES["Filedata"]);
			}
			
			if(!empty($_POST['currency_id'])){
				$rs=$this->currency->save($data);
				$currency_id=$data['currency_id'];
			}else{
				$rs=$this->currency->add($data);
				$currency_id=$rs;
			}
			if($_FILES["pic"]["tmp_name"]){
				$te['pic']=$this->upload($_FILES["pic"]);
				$te['currency_id']=$currency_id;
				$te['add_time']=time();
				$te['status']=0;
				M('Currency_pic')->add($te);
			}
			if($rs){
				$this->success("操作成功");
	    	}else{
	    		$this->error('操作失败');
	    	}
		}else{
			if(!empty($_GET['currency_id'])){
				$list=$this->currency->where('currency_id='.$_GET['currency_id'])->find();
				$this->assign('list',$list);
				$currency_pic=M('Currency_pic')->where('currency_id='.$_GET['currency_id'])->order('add_time')->select();
				$this->assign('pic',$currency_pic);
			}
			
			$currency_currency=M("Currency")->where("currency_id <> '{$_GET['currency_id']}'")->select();
			$this->assign("currency_currency",$currency_currency);
			
			$this->display();
		}
	}
	public function index(){
		$list=$this->currency->select();
		foreach ($list as $k=>$v){
			$list[$k]['qianbao_balance']=$this->get_qianbao_balance($v);
		}
		$this->assign('list',$list);
		$this->assign('empty','暂无数据');
		$this->display();
    }
    public function shangxian(){
    	if(!empty($_GET['currency_id'])){
    		$rs=M('Currency')->where('currency_id='.$_GET['currency_id'])->setField('is_lock',0);
    	}
    	if($rs){
    		$this->success('操作成功');
    	}else{
    		$this->error('操作失败');
    	}
    }
    //删除的时候，要判断个人账户下有没有钱
    public function del(){
    	if(empty($_GET['currency_id'])){
    		$this->error('删除数据不存在');
    	}
    	$rs=M('Currency_user')->where('currency_id='.$_GET['currency_id'])->sum("num");
    
    	if($rs>0){
    		$this->error('该币种尚有用户持有，不能删除');
    	}
    
    	$list=$this->currency->where('currency_id='.$_GET['currency_id'])->delete();
    	M('Currency_user')->where('currency_id='.$_GET['currency_id'])->delete();
    	if($list){
    		$this->success('删除成功');
    	}else{
    		$this->error('删除失败');
    	}
    }
    //删除对应的币种详情图片
    public function delCurrencyPic(){
    	$id=I('get.id');
    	$list=M('Currency_pic')->where('id='.$id)->delete();
    	if($list){
    		$this->success('删除成功');
    	}else{
    		$this->error('删除失败');
    	}
    }
    
 
    
    /**
     * 给某个用户钱包转账
     */
    public function  set_member_currencyForQianbao(){
    	$cuid=intval(I("cuid"));
    	if(empty($cuid)){
    		$this->error("无效货币参数",U("Currency/index"));exit();
    	}
    	$currency=M("Currency")->where("currency_id='$cuid'")->find();
    	
    	$currency['balance']=$this->get_qianbao_balance($currency);
    
    	if(empty($currency)){
    		$this->error("无效货币",U("Currency/index"));exit();
    	}
    	if(IS_POST){
    	
    		$admin=M("Admin")->where("admin_id='{$_SESSION['admin_userid']}'")->find();
    		if(empty($_POST['password'])){
    			$this->error("请输入管理员密码");
    		}
    		if(md5($_POST['password'])!=$admin['password']){
    			$this->error("您输入的管理员密码错误");
    		}
    		
    		$username=I("name");//用户名
    		$num=I('num');//数量
    		if(empty($username)){
    			$this->error("请输入用户名");exit();
    		}
    		if(empty($num)||!is_numeric($num)){
    			$this->error("数量请输入数字类型");exit();
    		}
    		$member=M("Member")->where("email='$username'")->find();
    		if(empty($member)){
    			$this->error("查无此人，请核实");exit();
    		}
    		
    		$qa=M("Qianbao_address")->where("user_id='{$member['member_id']}' and currency_id='{$cuid}'")->find();
    		if(empty($qa['qianbao_url'])){
    			$this->error("此用户没有绑定提币地址，无法转账");exit();
    		}
    		//判断看这个钱包地址是否是真实地址
    		if(!$this->check_qianbao_address($qa['qianbao_url'],$currency)){
    		$this->error("提币地址不是一个有效地址");exit();
    		}
    		$num=floatval($num);
    		$data['fee']=0;//手续费
    		$data['currency_id']=$cuid;
    		$data['user_id']=$qa['user_id'];
    		$data['url']=$qa['qianbao_url'];
    		$data['name']=$qa['name'];
    		$data['num']=$num;
    		$data['actual']=$num;//实际到账价格
    		$data['status']=0;
    		$data['add_time']=time();
    		
    		$tibi=$this->qianbao_tibi($qa['qianbao_url'],$num,$currency);//提币程序
    		
    		if($tibi){//成功写入数据库
    			$data['ti_id']=$tibi;
    			$re=M("Tibi")->add($data);
    			//减钱操作
//     			M("Currency_user")->where("member_id='{$_SESSION['USER_KEY_ID']}' and currency_id='$cuid'")->setDec("num",$num);
    			$this->success("转账成功，请耐心等待",U('Currency/index'));exit();
    		
    		}else{//失败提示
    			$this->error("转账失败");exit();
    		}
    	}
    	
    	$this->assign("currency",$currency);
    	$this->display();
    }
    
    /**
     * 检测地址是否是有效地址
     *
     * @return boolean 如果成功返回个true
     * @return boolean 如果失败返回个false；
     *  @param unknown $url
     *  @param $port_number 端口号 来区分不同的钱包
     */
     
    private function check_qianbao_address($url,$currency){
    	require_once 'App/Common/Common/easybitcoin.php';
    	$bitcoin = new \Bitcoin($currency['rpc_user'],$currency['rpc_pwd'],$currency['rpc_url'],$currency['port_number']);
    	$address = $bitcoin->validateaddress($url);
    	if($address['isvalid']){
    		return true;
    	}else{
    		return false;
    	}
    }
    /**
     * 提币引用的方法
     * @param unknown $url 钱包地址
     * @param unknown $money 提币数量
     */
    private function qianbao_tibi($url,$money,$currency){
     	require_once 'App/Common/Common/easybitcoin.php';
    $bitcoin = new \Bitcoin($currency['rpc_user'],$currency['rpc_pwd'],$currency['rpc_url'],$currency['port_number']);
    $bitcoin->walletlock();//强制上锁
    $bitcoin->walletpassphrase($currency['qianbao_key'],20);
    $id=$bitcoin->sendtoaddress($url,$money);
    $bitcoin->walletlock();
    	return $id;
    }
    /**
     * 修改涨停跌停价格
     */
    public function savePrice(){
    	$currency_id = trim(I('id','','intval'));
    	if(empty($currency_id)){
    		$data['status'] = -1;
    		$data['info'] = '参数错误';
    		$this->ajaxReturn($data);
    	}
    	if(!is_numeric($_POST['price_up']) || !is_numeric($_POST['price_down'])){
    		$data['status'] = -2;
    		$data['info'] = '填写必须是数字';
    		$this->ajaxReturn($data);
    	}
    	$r[] = M('Currency')->where("currency_id = {$currency_id}")->setField('price_up',$_POST['price_up']);
    	$r[] = M('Currency')->where("currency_id = {$currency_id}")->setField('price_down',$_POST['price_down']);
    	if(in_array($r, false)){
    		$data['status'] = -3;
    		$data['info'] = '服务器繁忙,请稍后重试';
    		$this->ajaxReturn($data);
    	}else{
    		$data['status'] = 1;
    		$data['info'] = '修改成功';
    		$this->ajaxReturn($data);
    	}
    }
    
}

9:F:\git\coin\bisheng commerce\App\Admin\Controller\CurrencyUserController.class.php
<?php

namespace Admin\Controller;

use Admin\Controller\CommonController;

class CurrencyUserController extends AdminController {
	public function _empty() {
		header ( "HTTP/1.0 404 Not Found" );
		$this->display ( 'Public:404' );
	}
	
	/**
	 * 会员钱包充值地址列表
	 */
	public function MemberQianbaoChongzhiUrl(){
		
		$where=array();
		$cuid=I('cuid');
		$email=I('email');
		if(!empty($cuid)){
			$where[C("DB_PREFIX")."currency_user.currency_id"]=I("cuid");
			$this->assign("id",I("cuid"));
		}
		if(!empty($email)){
			$name=M("Member")->where("email='{$email}'")->find();
			$where[C("DB_PREFIX")."currency_user.member_id"]=$name['member_id'];
		}
		
		$count      = M("Currency_user")
					->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."currency_user.member_id=".C("DB_PREFIX")."member.member_id")
					->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."currency_user.currency_id=".C("DB_PREFIX")."currency.currency_id")
					->where($where)->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		//给分页传参数
		setPageParameter($Page, array('cuid'=>I("cuid"),'email'=>$name['member_id']));
		$show       = $Page->show();// 分页显示输出// 进行分页数据查询 注意limit方法的参数要使用Page类的属性
		$field=C("DB_PREFIX")."currency_user.*,".C("DB_PREFIX")."member.email,".C("DB_PREFIX")."currency.currency_name";
		$list =  M("Currency_user")
		->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."currency_user.member_id=".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."currency_user.currency_id=".C("DB_PREFIX")."currency.currency_id")
		->field($field)
		->where($where)->order(C("DB_PREFIX")."currency_user.cu_id desc")->limit($Page->firstRow.','.$Page->listRows)->select();
		$this->assign('list',$list);// 赋值数据集
		$this->assign('page',$show);// 赋值分页输出
		

		$curr=M("Currency")->select();
		$this->assign("curr",$curr);
		$this->display();
	}
	
	/**
	 * 会员钱包提币地址列表
	 */
	public function MemberQianbaoTibiUrl(){
	
		$where=array();
		$cuid=I('cuid');
		$email=I('email');
		if(!empty($cuid)){
			$where[C("DB_PREFIX")."qianbao_address.currency_id"]=I("cuid");
			$this->assign("id",I("cuid"));
		}
		if(!empty($email)){
			$name=M("Member")->where("email='{$email}'")->find();
			$where[C("DB_PREFIX")."qianbao_address.user_id"]=$name['member_id'];
		}
		
		$count      = M("Qianbao_address")
		->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."qianbao_address.user_id=".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."qianbao_address.currency_id=".C("DB_PREFIX")."currency.currency_id")
		->where($where)->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		//给分页传参数
		setPageParameter($Page, array('cuid'=>I("cuid"),'email'=>$name['member_id']));
		$show       = $Page->show();// 分页显示输出// 进行分页数据查询 注意limit方法的参数要使用Page类的属性
		$field=C("DB_PREFIX")."qianbao_address.*,".C("DB_PREFIX")."member.email,".C("DB_PREFIX")."currency.currency_name";
		$list =  M("Qianbao_address")
		->join(C("DB_PREFIX")."member on ".C("DB_PREFIX")."qianbao_address.user_id=".C("DB_PREFIX")."member.member_id")
		->join(C("DB_PREFIX")."currency on ".C("DB_PREFIX")."qianbao_address.currency_id=".C("DB_PREFIX")."currency.currency_id")
		->field($field)
		->where($where)->order(C("DB_PREFIX")."qianbao_address.id desc")->limit($Page->firstRow.','.$Page->listRows)->select();
		foreach ($list as $k=>$v){
				
		}
		$this->assign('list',$list);// 赋值数据集
		$this->assign('page',$show);// 赋值分页输出
		
		
		$curr=M("Currency")->select();
		$this->assign("curr",$curr);
		$this->display();
	}
	
	
}

?>

10:F:\git\coin\bisheng commerce\App\Admin\Controller\DividendController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class DividendController extends AdminController {
	public function _initialize(){
		parent::_initialize();
	}
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	public function index(){
		$config=M('Dividend_config')->select();
		foreach ($config as $k=>$v){
               $list[$v['name']]=$v['value'];
		}
		$currency = M('Currency')->field('currency_id,currency_name')->select();
		$this->assign('config',$list);
		$this->assign('currency',$currency);
       	$this->display();
     }
     
   
     public function updateCofig(){
     	foreach ($_POST as $k=>$v){
     		$rs[]=M('Dividend_config')->where("name='{$k}'")->setField('value',$v);
     	}
     	if($rs){
     		$this->success('配置修改成功');
     	}else{
     		$this->error('配置修改失败');
     	}
     }
}

11:F:\git\coin\bisheng commerce\App\Admin\Controller\DownloadController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class DownloadController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    //空操作
    public function _empty(){
        header("HTTP/1.0 404 Not Found");
        $this->display('Public:404');
    }
    public function index(){
    	$currency=M('currency')->field('currency_id,currency_name,qianbao_url,guanwang_url')->select();
        $this->assign('list',$currency);
    	$this->display();
    }
    //处理钱包上传
    public function qianbaoDownload(){
    	if(!empty($_FILES)){
    				$upload = new \Think\Upload();// 实例化上传类
			    	$upload->maxSize   =     99999999 ;// 设置附件上传大小
			    	$upload->exts      =     array('zip', 'rar','CAB ','ISO ');// 设置附件上传类型
			    	$upload->savePath  =      './Public/Uploads/'; // 设置附件上传目录
			    	// 上传文件
			    	$info   =  $upload->upload();
			    	if(!$info) {
			    		// 上传错误提示错误信息
			    		$this->error($upload->getError());exit();
			    	}else{
			    		// 上传成功
			    		foreach ($info as $k=>$v){
			    			$url=$v['savepath'].$v['savename'];
			    			$r[]=M('Currency')->where('currency_id='.$k)->setField('qianbao_url','/Uploads'.ltrim($url,"."));
			    		}
			    		if(isset($r)){
			    			$this->success('上传成功');
			    		}else{
			    			$this->error('上传失败');
			    		}
			    	}
    			}
    }
    public function biaogeDownload(){
    	$upload = new \Think\Upload();// 实例化上传类
    	$upload->maxSize   =     3145728 ;// 设置附件上传大小
    	$upload->exts      =     array('xls', 'xlsx');// 设置附件上传类型
    	$upload->savePath  =      './Public/Uploads/'; // 设置附件上传目录
    	// 上传文件
    	$info   =  $upload->upload();
    	if(!$info) {
    		// 上传错误提示错误信息
    		$this->error($upload->getError());exit();
    	}else{
    		// 上传成功
    		foreach ($info as $k=>$v){
    			$url=$v['savepath'].$v['savename'];
    			$url='/Uploads'.ltrim($url,".");
    			$r=M('Config')->where(C("DB_PREFIX")."config.key='biaoge_url'")->setField('value',$url);
    		}
    		if(isset($r)){
    			$this->success('上传成功');
    		}else{
    			$this->error('上传失败');
    		}
    	}
    }
    public function guanwangUrl(){
    	//返回带有currency_id的一维数组
    	$arr_guanwang_url=I("post.guanwang_url");
    	foreach($arr_guanwang_url as $k=>$v){
    		$data['currency_id']=$k;
    		$data['guanwang_url']=$v;
    		$re = M("Currency")->save($data);
    		if($re===false){
    			$this->error('操作失败');
    		}
    	}
    		$this->success('操作成功');
//     	}else{
    		
    }
}

12:F:\git\coin\bisheng commerce\App\Admin\Controller\EmptyController.class.php
<?php

namespace Admin\Controller;

use Common\Controller\CommonController;
/**
 * 空模块，主要用于显示404页面，请不要删除
 */
class EmptyController extends CommonController{
	//没有任何方法，直接执行HomeController的_empty方法
	//请不要删除该控制器
	
    //空操作
    public function _empty(){
        header("HTTP/1.0 404 Not Found");
        $this->display('Public:404');
    }
    public function index() {
    	header ( "HTTP/1.0  404  Not Found" );
    	$this->display ( 'Public:404' );
    }
}

13:F:\git\coin\bisheng commerce\App\Admin\Controller\ExamineController.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午12:28
 */

namespace Admin\Controller;
use Think\Controller;
use Think\Page;
use Think\Upload;

class ExamineController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    /**
     * 审核列表
     */
    public function index(){
        $u_id = I('email');
        if(!empty($u_id)){
            $where['u_id'] = array('like','%'.$u_id.'%');
        }
        
       
        $M_Examine_pwdtrade = M('Examine_pwdtrade');
        $count      = $M_Examine_pwdtrade->where($where)->count();// 查询满足要求的总记录数
        $Page       = new Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
        //给分页传参数
        setPageParameter($Page, array('u_id'=>$u_id));
        
        $show       = $Page->show();// 分页显示输出
        // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
        $list = $M_Examine_pwdtrade
            ->where($where)
            ->order(" add_time desc ")
            ->limit($Page->firstRow.','.$Page->listRows)->select();
        $this->assign('list',$list);// 赋值数据集
        $this->assign('page',$show);// 赋值分页输出
        $this->display(); // 输出模板
    }

    /**
     * 查看并修改审核状态
     */
    public function saveExamine(){
        $id = I('id');
        $list = M('Examine_pwdtrade')->where(array('id'=>$id))->find();
        if(IS_POST){
            $id = $id;
            $data['status'] = I('post.status');
            if(empty($id)){
                $this->error('参数错误');
                return;
            }
            if($data['status']!=0){
                $data['examine_time'] = time();
                $data['examine_name'] = session('admin_user');
            }
            $r = M('Examine_pwdtrade')->where("id= '$id'")->save($data);
            if($r===false){
                $this->error('服务器繁忙,请稍后重试');
                return;
            }else{
                if($data['status']==1){
                    $member_data['pwdtrade'] = $list['pwdtrade'];
                    M('Member')->where(array('member_id'=>$list['u_id']))->save($member_data);
                    //审核成功后增加个人提示消息
                    $this->addMessage_all(
                        $list['u_id'],-2,
                        "您申请的修改支付密码已审核通过",
                        "您申请的修改支付密码已审核通过,审核通过时间为( ".date('Y-m-d H:i:s',$data['examine_time'])." )"
                    );
                }
                if($data['status']==2){
                    //审核未通过后添加个人消息提示
                    $this->addMessage_all(
                        $list['u_id'],-2,
                        "很抱歉您申请的修改支付密码审核未通过",
                        "很抱歉您申请的修改支付密码审核未通过,请重新审核。或联系客服"
                    );
                }
                $this->success('审核成功',U('Examine/index'));
                return;
            }
        }
        if(empty($id)){
            header("HTTP/1.0 404 Not Found");
            $this->display('Public:404');
        }
        $this->assign('list',$list);
        $this->display();

    }
}

14:F:\git\coin\bisheng commerce\App\Admin\Controller\FileconfigoperationController.class.php
<?php

namespace Admin\Controller;

use Admin\Controller\AdminController;
use Think\Controller;

/**
 * 修改配置文件类
 */
class FileconfigoperationController extends AdminController {
	public function _initialize() {
		parent::_initialize ();
	}
	public function _empty() {
		header ( "HTTP/1.0 404 Not Found" );
		$this->display ( 'Public:404' );
	}
	
	/**
	 * 展示修改界面
	 */
	public function saveDb() {
		$this->display ();
	}
	/**
	 * 修改表前缀并且修改MySql表前缀
	 */
	public function saveDbPrefix() {
		$this->success('此功能暂未开放...');
		return;
		if (empty ( $_POST ['DB_PREFIX'] )) {
			$this->error ( '请输入修改表前缀' );
			return;
		}
		$r = $this->setDbPrefix ( $_POST ['DB_PREFIX'] );
		if ($r) {
			// 写入配置项
			$this->setConfigByFileName ( 'Common', 'db', array (
					'DB_PREFIX' => $_POST ['DB_PREFIX'] 
			) );
			$this->success ( '修改成功' );
		} else {
			$this->error ( '服务器繁忙请稍后重试' );
		}
	}
	/**
	 * 修改配置项数据库密码(需手动修改数据库密码,这里只提供修改配置项)
	 */
	public function saveDbPwd() {
		if (empty ( $_POST ['DB_PWD'] )) {
			$this->error ( '请输入修改密码' );
			return;
		}
		$new_pwd = trim ( $_POST ['DB_PWD'] );
		$r = $this->setConfigByFileName ( 'Common', 'db', array (
				'DB_PWD' => $new_pwd 
		) );
		if ($r) {
			$this->success ( '修改配置项密码成功' );
			return;
		} else {
			$this->error ( '修改配置项密码失败' );
			return;
		}
	}
	/**
	 * 修改后台入口地址
	 */
	public function saveEntrance() {
		if (IS_POST) {
			if (empty ( $_POST ['URL_MODULE_MAP'] )) {
				$this->error ( '请输入后台入口路径设置' );
				return;
			}
			$URL_MODULE_MAP = trim ( $_POST ['URL_MODULE_MAP'] );
			// 删除文件
			$r = $this->setConfigByFileName ( 'Common', 'adminEntrance', array (
					'URL_MODULE_MAP' => array (
							$URL_MODULE_MAP => 'admin' 
					) 
			) );
			if ($r) {
				$this->success ( '修改成功', U ( 'Home/Index/index' ) );
				return;
			} else {
				$this->error ( '修改失败' );
				return;
			}
		} else {
			$this->display ();
		}
	}
	/**
	 * 修改配置的值
	 *
	 * @param [type] $fileName
	 *        	[ 配置文件名 ]
	 * @param [type] $arrData
	 *        	[ 保存的数值 数组 ]
	 * @param [type] $model
	 *        	[ 需要修改的模块 ]
	 */
	private function setConfigByFileName($model, $fileName, $arrData) {
		$model or $model = MODULE_NAME;
		$fileName or die ( '没有文件名' );
		$savePath = str_replace ( 'Common', $model, CONF_PATH . $fileName . '.php' );
		if (file_exists ( $savePath )) {
			$return = require $savePath;
		}
		// 数据为空的时候,则读取文件信息
		if (empty ( $arrData )) {
			return $return;
		}
		$return = array_merge ( ( array ) $return, $arrData );
		$str = var_export ( $return, true );
		$str = '<?php return ' . $str . ';';
		return file_put_contents ( $savePath, $str );
	}
	/**
	 * 修改表前缀
	 * @param String $new_prefix 新的表前缀
	 * @return boolean 执行结果
	 */
	private function setDbPrefix($new_prefix) {
		// 设置好相关信息
		$dbserver = C ( 'DB_HOST' ); // 连接的服务器
		$dbname = C ( 'DB_NAME' ); // 数据库名
		$dbuser = C ( 'DB_USER' ); // 数据库用户名
		$dbpassword = C ( 'DB_PWD' ); // 数据库密码
		$old_prefix = C ( 'DB_PREFIX' ); // 数据库的前缀
		if (! is_string ( $dbname ) || ! is_string ( $old_prefix ) || ! is_string ( $new_prefix )) {
			return false;
		}
		if (! mysql_connect ( $dbserver, $dbuser, $dbpassword )) {
			print 'Could not connect to mysql';
			exit ();
		}
		// 取得数据库内所有的表名
		$result = mysql_list_tables ( $dbname );
		if (! $result) {
			print "DB Error, could not list tablesn";
			print 'MySQL Error: ' . mysql_error ();
			exit ();
		}
		// 把表名存进$data
		while ( $row = mysql_fetch_row ( $result ) ) {
			$data [] = $row [0];
		}
		// 过滤要修改前缀的表名
		foreach ( $data as $k => $v ) {
			$preg = preg_match ( "/^($old_prefix{1})([a-zA-Z0-9_-]+)/i", $v, $v1 );
			if ($preg) {
				$tab_name [$k] = $v1 [2];
				// $tab_name[$k] = str_replace($old_prefix, '', $v);
			}
		}
		if ($preg) {
			// echo '<pre>';
			// print_r($tab_name);
			// exit();
			// 批量重命名
			foreach ( $tab_name as $k => $v ) {
				$sql = 'RENAME TABLE `' . $old_prefix . $v . '` TO `' . $new_prefix . $v . '`';
				mysql_query ( $sql );
			}
			mysql_free_result ( $result );
			mysql_close ( $result );
			return true;
			// print "数据表前缀：" . $old_prefix . "<br>" . "已经修改为：" . $new_prefix . "<br>";
		} else {
			mysql_free_result ( $result );
			mysql_close ( $result );
			return false;
		}
	}
}

15:F:\git\coin\bisheng commerce\App\Admin\Controller\FinanceController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
use Think\Page;
class FinanceController extends AdminController{
    //空操作
    public function _empty(){
        header("HTTP/1.0 404 Not Found");
        $this->display('Public:404');
    }
    //财务日志
	public function index(){
		$type_id=I('type_id');
		$name=I('name');
		$member_id=I('member_id');
		if(!empty($type_id)){
			$where['type']=$type_id;
		}
		if(!empty($name)){
			$uid=M('Member')->where("name like '%{$name}%'")->find();
			$where[C("DB_PREFIX")."member.member_id"]=$uid['member_id'];
		}
        if(!empty($member_id)){
            $where[C("DB_PREFIX")."member.member_id"]=$member_id;
        }
		//筛选
        $type=M('Finance_type')->select();
        $this->assign('type',$type);
		//显示日志
        $count = M('Finance')
        ->field(C("DB_PREFIX")."finance.*,".C("DB_PREFIX")."member.name as username,".C("DB_PREFIX")."currency.currency_name,".C("DB_PREFIX")."finance_type.name as typename")
        ->join("left join ".C("DB_PREFIX")."member on ".C("DB_PREFIX")."member.member_id=".C("DB_PREFIX")."finance.member_id")
        ->join("left join ".C("DB_PREFIX")."finance_type on ".C("DB_PREFIX")."finance_type.id=".C("DB_PREFIX")."finance.type")
        ->join("left join ".C("DB_PREFIX")."currency on ".C("DB_PREFIX")."currency.currency_id=".C("DB_PREFIX")."finance.currency_id")
        ->where ( $where )->count (); // 查询满足要求的总记录数
        $Page = new Page ( $count, 25 ); // 实例化分页类 传入总记录数和每页显示的记录数(25)
        //给分页传参数
        setPageParameter($Page, array('type_id'=>$type_id,'name'=>$name,'member_id'=>$member_id));
        
        $show = $Page->show (); // 分页显示输出
        		
		$list=M('Finance')
		->field(C("DB_PREFIX")."finance.*,".C("DB_PREFIX")."member.name as username,".C("DB_PREFIX")."currency.currency_name,".C("DB_PREFIX")."finance_type.name as typename")
		->join("left join ".C("DB_PREFIX")."member on ".C("DB_PREFIX")."member.member_id=".C("DB_PREFIX")."finance.member_id")
		->join("left join ".C("DB_PREFIX")."finance_type on ".C("DB_PREFIX")."finance_type.id=".C("DB_PREFIX")."finance.type")
		->join("left join ".C("DB_PREFIX")."currency on ".C("DB_PREFIX")."currency.currency_id=".C("DB_PREFIX")."finance.currency_id")
		->limit($Page->firstRow.','.$Page->listRows)
		->where($where)
		->order('add_time desc')
		->select();
		//echo M('Finance')->_sql();
		foreach ($list as $k=>$v){
			if($v['currency_id']==0){
				$list[$k]['currency_name']='人民币';
			}
		}
		$this->assign('empty','暂未查询到数据');
		$this->assign('list',$list);
		$this->assign ( 'page', $show ); // 赋值分页输出
        $this->display();
     }
    //财务明细
    public function count(){
    	$pay=$this->getFinenceByType(array('6'),1);
    	$this->assign('pay',$pay);
    	$pay_admin=$this->getFinenceByType(array('3','13'),0);
    	$this->assign('pay_admin',$pay_admin);
    	$draw=$this->getFinenceByType(array('23'),1);
    	$this->assign('draw',$draw);
    	//统计人民币总额
    	$rmb_count=M('Member')->sum('rmb');
    	$forzen_rmb_count=M('Member')->sum('forzen_rmb');
    	$rmb=$rmb_count+$forzen_rmb_count;
    	$this->assign('rmb',$rmb);
    	//分币种统计
    	$currency=M('Currency')->field('currency_id,currency_name')->select();
    	foreach ($currency as $k=>$v){
    		$currency_user[$k]['num']=M('Currency_user')->where('currency_id='.$v['currency_id'])->sum('num');
    		$currency_user[$k]['forzen_num']=M('Currency_user')->where('currency_id='.$v['currency_id'])->sum('forzen_num');
    		$currency_user[$k]['name']=$v['currency_name'];
    	}
    	$this->assign('currency_user',$currency_user);
    	$this->display();
    }
    private function getFinenceByType($type,$currency=1){
		if($currency==0){
			$where['currency_id']=0;
		}
    	$where['type']=array('in',$type);
    	$rs=M('Finance')->where($where)->sum('money');
    	return $rs;
    }
    /**
     * 导出excel文件
     */
    public function derivedExcel(){
    	//时间筛选
    	$add_time=I('get.add_time');
    	$end_time=I('get.end_time');
    	$add_time=empty($add_time)?0:strtotime($add_time);
    	$end_time=empty($end_time)?0:strtotime($end_time);
    	$where[C("DB_PREFIX").'finance.add_time'] = array('lt',$end_time);
    	$list= M('Finance')
    	->field(C("DB_PREFIX")."finance.finance_id,"
    			.C("DB_PREFIX")."member.name as uesrname,"
    			.C("DB_PREFIX")."finance_type.name as typename,"
    			.C("DB_PREFIX")."finance.content,"
    			.C("DB_PREFIX")."finance.money,"
    			.C("DB_PREFIX")."currency.currency_name,"
    			.C("DB_PREFIX")."finance.money_type,"
    			.C("DB_PREFIX")."finance.add_time")
    			->join("left join ".C("DB_PREFIX")."member on ".C("DB_PREFIX")."member.member_id=".C("DB_PREFIX")."finance.member_id")
    			->join("left join ".C("DB_PREFIX")."finance_type on ".C("DB_PREFIX")."finance_type.id=".C("DB_PREFIX")."finance.type")
    			->join("left join ".C("DB_PREFIX")."currency on ".C("DB_PREFIX")."currency.currency_id=".C("DB_PREFIX")."finance.currency_id")
    			->limit($Page->firstRow.','.$Page->listRows)
    			->order('add_time desc')
    			->where($where)
    			->where(C("DB_PREFIX").'finance.add_time>'.$add_time)		
    			->select();
    	//     	echo M("Pay")->getLastSql();die;
    	//echo M('Finance')->_sql();die;
    	foreach ($list as $k=>$v){
    		if($list[$k]['money_type']==1){
    			$list[$k]['money_type']='支出';
    		}else{
    			$list[$k]['money_type']='收入';
    		}
    		if($list[$k]['currency_id']==0)$list[$k]['currency_name']='人民币';
    		$list[$k]['add_time']=date('Y-m-d H:i:s',$list[$k]['add_time']);
    	}
    	$title = array(
    			'日志编号',
    			'所属',
    			'财务类型',
    			'内容',
    			'金额',
    			'币种',
    			'收入/支出',
    			'时间',
    	);
    	$filename= $this->config['name']."财务日志-".date('Y-m-d',time());
    	$r = exportexcel($list,$title,$filename);
    }
    
}

16:F:\git\coin\bisheng commerce\App\Admin\Controller\FlashController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
use Home\Controller\PublicController;
class FlashController extends AdminController {
	//空操作
	public function _initialize(){
		parent::_initialize();
	}
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	Public function add(){
		$flash=M('Flash');
		if(IS_POST){
			if($_FILES["Filedata"]["tmp_name"]){
				$data['pic']=$this->upload($_FILES["Filedata"]);
			}
			if(!empty($_POST['jump_url'])){
				$data['jump_url']=$_POST['jump_url'];
			}
			if(!empty($_POST['sort'])){
				$data['sort']=$_POST['sort'];
			}
			if(!empty($_POST['title'])){
				$data['title']=$_POST['title'];
			}
			$data['add_time']=time();
			if(!empty($_POST['flash_id'])){
				$data['flash_id']=$_POST['flash_id'];
				$rs=$flash->save($data);
			}else{
				$rs=$flash->add($data);
			}
			if($rs){
				$this->success('操作成功');
			}else{
				$this->error('操作失败');
			}
		}else{
			if(!empty($_GET['flash_id'])){
				$list=$flash->where('flash_id='.$_GET['flash_id'])->find();
				$this->assign('flash',$list);
			}
			$this->display();
		}
	}
	public function index(){
		$list=M('Flash')->select();
		$this->assign('flash',$list);
		$this->assign('empty','暂无数据');
		$this->display();
    }
    public function del(){
    	if(!empty($_GET['flash_id'])){
            $list=M('Flash')->where('flash_id='.$_GET['flash_id'])->delete();
        }
    	if($list){
    		$this->success('删除成功');
    	}else{
    		$this->error('删除失败');
    	}
    }
}

17:F:\git\coin\bisheng commerce\App\Admin\Controller\index.html
 

18:F:\git\coin\bisheng commerce\App\Admin\Controller\IndexController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class IndexController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    //空操作
    public function _empty(){
        header("HTTP/1.0 404 Not Found");
        $this->display('Public:404');
    }
    public function index(){
        //币种信息
//        $list=M('Currency')->select();
//        foreach ($list as $k=>$v){
//            $currency_message=$this->getCurrencyMessageById($v['currency_id']);
//            $list[$k]=array_merge($currency_message,$list[$k]);
//            $list[$k]['balance']=$this->get_qianbao_balance($v['port_number']);
//        }
//
//        $this->assign('list',$list);
//        $this->assign('empty','暂无数据');
        $this->display();
    }

    /**
     * 统计全站信息
     */
    public function infoStatistics(){
        //统计全站信息
        //总人数
        $member_count=M('Member')->count();
        //众筹总数量
        $issue_count=M('issue')->field("sum(num)-sum(deal) as count")->find();
        //人民币收入
        $pay_money_count = M('pay')->where("status = 1 ")->sum('count');
        //人民币支出
        $withdraw_money_count = M('withdraw')->where(" status = 2")->sum("money");
        //充值单数
        $pay_count = M('pay')->where("status = 1 ")->count();
        //提现单数
        $withdraw_count = M('withdraw')->where(" status = 2")->count();
        //全站币种统计
        $currency_u_info = M('currency')
                        ->alias('a')
                        ->field('a.currency_name,sum(b.num) as num,sum(b.forzen_num) as forzen_num')
                        ->join("left join ".C("DB_PREFIX")."currency_user AS b on a.currency_id = b.currency_id")
                        ->group('a.currency_id')
                        ->select();
        $this->assign('member',$member_count);
        $this->assign('issue_count',$issue_count);
        $this->assign('pay_money_count',$pay_money_count);
        $this->assign('withdraw_money_count',$withdraw_money_count);
        $this->assign('pay_count',$pay_count);
        $this->assign('withdraw_count',$withdraw_count);
        $this->assign('currency_u_info',$currency_u_info);
        $this->display();
    }

    /**
     * 删除缓存方法
     */
    public function cache(){
        $cacheDir = $_POST['type'];
        $type = $cacheDir;
        //将传递过来的值进行切割，我是已“-”进行切割的
        $name = explode('-', $type);
        //得到切割的条数，便于下面循环
        $count = count($name);
        //循环调用上面的方法
        for ($i = 0; $i < $count; $i++)
        {
            //得到文件的绝对路径
            $abs_dir = dirname(dirname(dirname(dirname(__FILE__))));
            //组合路径
            $pa = $abs_dir . str_replace("/", "\\", str_replace("./", "\\", RUNTIME_PATH)); //得到运行时的目录
            $runtime = $pa . 'common~runtime.php';
            if (file_exists($runtime))//判断 文件是否存在
            {
                unlink($runtime); //进行文件删除
            }
            //调用删除文件夹下所有文件的方法
            $this->rmFile($pa, $name[$i]);
        }
        $data['status'] = 1;
        $data['info'] = "清理成功";
        $this->ajaxReturn($data);
    }

    /**
     * 删除文件和目录
     * @param type $path 要删除文件夹路径
     * @param type $fileName 要删除的目录名称
     */
    private function rmFile($path, $fileName)
    {//删除执行的方法
        //去除空格
        $path = preg_replace('/(\/){2,}|{\\\}{1,}/', '/', $path);
        //得到完整目录
        $path.= $fileName;
        //判断此文件是否为一个文件目录
        if (is_dir($path))
        {
            //打开文件
            if ($dh = opendir($path))
            {
                //遍历文件目录名称
                while (($file = readdir($dh)) != false)
                {
                    $sub_file_path = $path . "\\" . $file;
                    if ("." == $file || ".." == $file)
                    {
                        continue;
                    }
                    if (is_dir($sub_file_path))
                    {
                        $this->rmFile($sub_file_path, "");
                        rmdir($sub_file_path);
                    }
                    //逐一进行删除
                    unlink($sub_file_path);
                }
                //关闭文件
                closedir($dh);
            }
            rmdir($sub_file_path);//删除当前目录
        }
    }
}

19:F:\git\coin\bisheng commerce\App\Admin\Controller\LinkController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\CommonController;
class LinkController extends AdminController{
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	public function index(){
		$Link = M('Link'); // 实例化User对象
		$count      = $Link->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		$show       = $Page->show();// 分页显示输出
		// 进行分页数据查询 注意limit方法的参数要使用Page类的属性
		$list = $Link->order('add_time desc')->limit($Page->firstRow.','.$Page->listRows)->select();
		$this->assign('list',$list);// 赋值数据集
		$this->assign('page',$show);// 赋值分页输出
		$this->display();
	}
	public function add(){
		$id=I('id');
		if(!empty($id)){
			$list=M("Link")->where("id='$id'")->find();
			$this->assign("list",$list);
		}
		$this->display();
	}
	public function add_link(){
		
		if(empty($_POST['name'])){
			$this->error("请输入链接名称");
		}
		if(empty($_POST['url'])){
			$this->error("请输入链接地址");
		}
		if(!isset($_POST['status'])){
			$this->error("请选择链接状态");
		}
		$id=I('id');
		
		$data['name']=I('name');
		$data['url']=I('url');
		$data['status']=I('status');
		$data['add_time']=time();
		if(empty($id)){
			$re=M("Link")->add($data);
		}else{
			$re=M("Link")->where("id='$id'")->save($data);
		}
		if($re){
			$this->success("添加成功",U('Link/index'));
		}else{
			$this->error("添加失败");
		}
		
	}
	
	public function del(){
		$id=I('id');
		if(empty($id)){
			$this->error("无效参数，无法删除");
		}
		$re=M("Link")->where("id='$id'")->delete();
		if($re){
			$this->success("删除成功",U("Link/index"));
		}else{
			$this->error("删除失败");
		}
	}
}    

20:F:\git\coin\bisheng commerce\App\Admin\Controller\LoginController.class.php
<?php
namespace Admin\Controller;
use Common\Controller\CommonController;
class LoginController extends CommonController {
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	public function login(){
        $this->display();
    }
    //登录验证
    public function checkLogin(){
    	$username=trim(I('post.username'));
    	$pwd=trim(I('post.pwd'));
     	if(empty($username)||empty($pwd)){
     		$this->error('请填写完整信息');
     	}
     	$admin=M('Admin')->where("username='$username'")->find();
     	if($admin['password']!=md5($pwd)){
     		$this->error('登录密码不正确');
     	}
    	$_SESSION['admin_userid']=$admin['admin_id'];
    	$this->redirect('Index/index');
    }

    //登出
    public function loginout(){
    	$_SESSION['admin_userid']=null;
    	$this->redirect('Login/login');
    }
     
}

21:F:\git\coin\bisheng commerce\App\Admin\Controller\ManageController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
class ManageController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    //判断权限
    private function auth(){
        $admin=$this->admin;
        if($admin['admin_id']!=1){
            $this->error('只有超级管理员可以进入此页面');exit();
        }
    }
    /**
     * 管理员列表
     */
    public function index(){
        $this->auth();
        $admin = M('Admin');
        $count      = $admin->count();// 查询满足要求的总记录数
        $Page       = new \Think\Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
        $show       = $Page->show();// 分页显示输出
        // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
        $list = $admin->limit($Page->firstRow.','.$Page->listRows)->select();
        $this->assign('list',$list);// 赋值数据集
        $this->assign('page',$show);// 赋值分页输出
        $this->display(); // 输出模板
    }
    /**
     * 添加管理员
     */
    public function addAdmin(){
        $admin=M('Admin');
        if(IS_POST){
            $username=I('post.username');

            $pwd=md5(I('post.password'));
            if(empty($username)||empty($pwd)){
                $this->error('请补全信息');
            }
            $data['username']=$username;
            $data['password']=$pwd;
            $data['pwd_show']=I('post.password');
            if(empty($_POST['admin_id'])){
                $rs=$admin->where("username='$username'")->find();
                if($rs){
                    $this->error('用户名称已存在');
                }
                $rs=$admin->add($data);
            }else{
                $data['admin_id']=I('post.admin_id');
                if(empty($pwd)){
                    $data['password']=md5(I('post.pwd_show'));
                    $data['pwd_show']=I('post.pwd_show');
                }
                $rs=$admin->save($data);
            }
            if($rs){
                $this->success('操作成功');
            }else{
                $this->error('操作失败');
            }
        }
        if(!empty($_GET['admin_id'])){
            $list=$admin->where('admin_id='.$_GET['admin_id'])->find();
        }
        $this->assign('list',$list);
        $this->display();
    }
    //修改权限页面
    public function showNav(){
        $this->auth();
        $where['admin_id']=$_GET['admin_id'];
        $admin=M('Admin')->where($where)->find();
        $list=explode(',',$admin['nav']);
        $nav=M('Nav')->select();
        foreach ($nav as $k=>$v){
            if(in_array($v['nav_id'],$list)){
                $nav[$k]['status']=1;
            }
        }
        $this->assign('nav',$nav);
        $this->assign('id',$_GET['admin_id']);
        $this->display();
    }
    //修改权限程序
    public function saveNav(){
        $this->auth();
        if(I('post.admin_id')){
            $data['nav']=implode(',', I('post.nav'));
            $data['admin_id']=I('post.admin_id');
            $rs=M('Admin')->save($data);
            if($rs){
                $this->success('修改成功');
            }else{
                $this->error('修改失败');
            }
        }else{
            $this->error('操作有误');
        }
    }
    /**
     * 修改本账号密码
     */
    public function pwdUpdate(){
        header("Content-type:text/html;charset=utf-8");
        $admin_id = session('admin_userid');
        $list=M('Admin')->where('admin_id='.$admin_id)->find();
        if(empty($admin_id)){
            $this->error('操作有误');
            return;
        }
        if(IS_POST){
            if(empty($_POST['old_pwd'])){
                $this->error('请输入原始密码');
                return;
            }
            if(empty($_POST['password'])){
                $this->error('请输入新密码');
                return;
            }
            $old_pwd = md5($_POST['old_pwd']);
            if($list['password'] != $old_pwd){
                $this->error('您输入的原始密码错误');
                return;
            }
            if(!checkPwd($_POST['password'])){
                $this->error('验证密码长度在6-20个字符之间');
                return;
            }
            $r = M('Admin')->where('admin_id='.$admin_id)->setField('password',md5($_POST['password']));
            if($r===true){
                $this->error('修改失败');
                return;
            }else{
                $this->redirect('Login/loginout','',1,"<script>alert('修改成功请重新登录')</script>");
                return;
            }
        }else{
            $this->assign('list',$list);
            $this->display();
        }
    }
    /**
     * 删除管理员
     */
    public function delMember(){
        $this->auth();
        if(empty($_GET['admin_id'])){
            $this->error('要删除的ID不存在');
        }
        if($_GET['admin_id']==1){
            $this->error('此ID不可删除');
        }
        $admin = M('Admin');
        $r = $admin->delete($_GET['admin_id']);
        if($r){
            $this->success('删除成功',U('Manage/index'));
            return;
        }else{
            $this->error('删除失败');
            return;
        }
    }
}

22:F:\git\coin\bisheng commerce\App\Admin\Controller\MemberController.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午12:28
 */

namespace Admin\Controller;
use Think\Page;
use Think\Upload;
class MemberController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    /**
     * 会员列表
     */
    public function index(){
        $email = I('email');
        $member_id=I('member_id');
        if(!empty($email)){
            $where['email'] = array('like','%'.$email.'%');
        }
        if (!empty($member_id)){
            $where['member_id']=$member_id;
        }
        
        $count      =  M('Member')->where($where)->count();// 查询满足要求的总记录数

        $Page       = new Page($count,20);// 实例化分页类 传入总记录数和每页显示的记录数(25)

        //给分页传参数
        setPageParameter($Page, array('email'=>$email,'member_id'=>$member_id));

        $show       = $Page->show();// 分页显示输出
        
        $list =  M('Member')
            ->where($where)
            ->order(" member_id desc ")
            ->limit($Page->firstRow.','.$Page->listRows)->select();
        
        
        $this->assign('list',$list);// 赋值数据集
        $this->assign('page',$show);// 赋值分页输出
        $this->display(); // 输出模板
    }
    /**
     * 添加会员
     */
    public function addMember(){
        if(IS_POST){
            $M_member = D('Member');
            $_POST['ip'] = get_client_ip();
            $_POST['reg_time'] = time();
            if($r = $M_member->create()){
                if($r['pwd']==$r['pwdtrade']){
                    $this->error('支付密码不能和密码一样');
                    return;
                }
                if($M_member->add($r)){
                    $this->success('添加成功',U('Member/index'));
                    return;
                }else{
                    $this->error('服务器繁忙,请稍后重试');
                    return;
                }
            }else{
                $this->error($M_member->getError());
                return;
            }
        }else{
            $this->display();
        }
    }
    /**
     * 添加个人信息
     */
    public function saveModify(){
        $member_id = I('get.member_id','','intval');
        $M_member = D('Member');
        if(IS_POST){
            $_POST['status'] = 1;//0=有效但未填写个人信息1=有效并且填写完个人信息2=禁用
            if (!$data=$M_member->create()){ // 创建数据对象
                // 如果创建失败 表示验证没有通过 输出错误提示信息
                $this->error($M_member->getError());
                return;
            }else {
                $where['member_id'] = $_POST['member_id'];
                $r = $M_member->where($where)->save();
                if($r){
                    $this->success('添加成功',U('Member/index'));
                    return;
                }else{
                    $this->error('服务器繁忙,请稍后重试');
                    return;
                }
            }
        }else{
            $where['member_id'] = $member_id;
            $list = $M_member->where($where)->find();
            $this->assign('list',$list);
            $this->display();
        }
    }
    /**
     * 显示自己推荐列表
     */
    public function show_my_invit(){
        $member_id = $_GET['member_id'];
        if(empty($member_id)){
            $this->error('参数错误');
            return;
        }
        $M_member = M('Member');
        $count      = $M_member->where(array('pid'=>$member_id))->count();// 查询满足要求的总记录数
        $Page       = new Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
        $show       = $Page->show();// 分页显示输出
        // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
        $my_invit = $M_member
            ->where(array('pid'=>$member_id))
            ->order(" reg_time desc ")
            ->limit($Page->firstRow.','.$Page->listRows)->select();
        if($my_invit){
            $this->assign('my_invit',$my_invit);
            $this->assign('page',$show);// 赋值分页输出
            $this->display(); // 输出模板
        }else{
            $this->error('抱歉,您还没有推荐其他人');
            return;
        }
    }
    /**
     * 修改会员
     */
    public function saveMember(){
        $member_id = I('get.member_id','','intval');
        $M_member = M('Member');
        if(IS_POST){
            $member_id = I('post.member_id','','intval');
            $where['member_id'] = $member_id;
            $list = $M_member->where($where)->find();
            //头像上传
            $upload = new Upload();// 实例化上传类
            $upload->maxSize   =     3145728 ;// 设置附件上传大小
            $upload->exts      =     array('jpg', 'gif', 'png', 'jpeg');// 设置附件上传类型
            $upload->rootPath  =     './Uploads/'; // 设置附件上传根目录
            $upload->savePath  =     'Member/Head/'; // 设置附件上传（子）目录
            // 上传文件
            if(!$_FILES['head']['error']){
                $info   =   $upload->upload();
                $file_path = ltrim($upload->rootPath.$info['head']["savepath"].$info['head']["savename"],'.');
            }
            $_POST['head'] = empty($file_path)?I('post.headold'):$file_path;
            //头像上传end
            if($_POST['pwd'] == $_POST['pwdtrade'] && $_POST['pwd']!=null ){
                $this->error('交易密码不能和密码一致');
                return;
            }
            if($_POST['nick']!=$list['nick']){
                $where = null;
                $where['member_id']  = array('NEQ',$member_id);
                $where['nick'] = $_POST['nick'];
                if($M_member->field('nick')->where($where)->select()){
                    $this->error('昵称重复');
                    return;
                }
            }
            if($_POST['phone']!=$list['phone']){
                $where = null;
                $where['member_id']  = array('NEQ',$member_id);
                $where['phone'] = $_POST['phone'];
                if($M_member->field('phone')->where($where)->select()){
                    $this->error('手机号重复');
                    return;
                }
            }
            $_POST['pwd'] =  $_POST['pwd']?I('post.pwd','','md5'):$list['pwd'];
            $_POST['pwdtrade'] = $_POST['pwdtrade']?I('post.pwdtrade','','md5'):$list['pwdtrade'];
            $r = $M_member->save($_POST);
            if($r!==false){
                $this->success('修改成功',U('Member/index'));
                return;
            }else{
                $this->error('修改失败');
                return;
            }
        }else{
            if($member_id){
                $where['member_id'] = $member_id;
                $list = $M_member->where($where)->find();
                $this->assign('list',$list);
                $this->display();
            }else{
                $this->error('参数错误');
                return;
            }
        }
    }
    /**
     * 删除会员
     */
    public function delMember(){
        $member_id = I('get.member_id','','intval');
        $M_member = M('Member');
        //判断还有没有余额
        $where['member_id']= $member_id;
        $member = $M_member->where($where)->find();
        $member_currency = M('Currency_user')->where($where)->find();
        if($member['rmb']>0||$member['forzen_rmb']>0||$member_currency['num']>0||$member_currency['forzen_num']>0){
            $this->error('因账户有剩余余额,禁止删除');
            return;
        }
        $r[] = $M_member->delete($member_id);
        $r[] = M('Currency_user')->where($where)->delete();
        $r[] = M('Finance')->where($where)->delete();
        $r[] = M('Orders')->where($where)->delete();
        $r[] = M('Trade')->where($where)->delete();
        $r[] = M('Withdraw')->where('uid='.$member_id)->delete();
        $r[] = M('Pay')->where($where)->delete();
        if($r){
            $this->success('删除成功',U('Member/index'));
            return;
        }else{
            $this->error('删除失败');
            return;
        }
    }
    /**
     * ajax判断邮箱
     * @param $email
     */
    public function ajaxCheckEmail($email){
        $email = urldecode($email);
        $data = array();
        if(!checkEmail($email)){
            $data['status'] = 0;
            $data['msg'] = "邮箱格式错误";
        }else{
            $M_member = M('Member');
            $where['email']  = $email;
            $r = $M_member->where($where)->find();
            if($r){
                $data['status'] = 0;
                $data['msg'] = "邮箱已存在";
            }else{
                $data['status'] = 1;
                $data['msg'] = "";
            }
        }
        $this->ajaxReturn($data);
    }

    /**
     * ajax验证昵称是否存在
     */
    public function ajaxCheckNick($nick){
        $nick = urldecode($nick);
        $data =array();
        $M_member = M('Member');
        $where['nick']  = $nick;
        $r = $M_member->where($where)->find();
        if($r){
            $data['msg'] = "昵称已被占用";
            $data['status'] = 0;
        }else{
            $data['msg'] = "";
            $data['status'] = 1;
        }
        $this->ajaxReturn($data);
    }
    /**
     * ajax手机验证
     */
    function ajaxCheckPhone($phone) {
        $phone = urldecode($phone);
        $data = array();
        if(!checkMobile($phone)){
            $data['msg'] = "手机号不正确！";
            $data['status'] = 0;
        }else{
            $M_member = M('Member');
            $where['phone']  = $phone;
            $r = $M_member->where($where)->find();
            if($r){
                $data['msg'] = "此手机已经绑定过！请更换手机号";
                $data['status'] = 0;
            }else{
                $data['msg'] = "";
                $data['status'] = 1;
            }
        }
        $this->ajaxReturn($data);
    }
    
    /**
     * 查看个人币种
     */
    public function show(){
    	$currency = M('Currency_user');
    	$member = M('Member');
    	$member_id = I('member_id');
    	if(empty($member_id)){
    		$this->error('参数错误',U('Member/index'));
    	}
    	$where['member_id'] = $member_id;
    	$count = $currency->join(C("DB_PREFIX")."currency ON ".C("DB_PREFIX")."currency_user.currency_id = ".C("DB_PREFIX")."currency.currency_id")
    			->where($where)->count();
    	$Page = new \Think\Page ( $count,20); // 实例化分页类 传入总记录数和每页显示的记录数
    	$show = $Page->show();//分页显示输出性
    	$info = $currency->join(C("DB_PREFIX")."currency ON ".C("DB_PREFIX")."currency_user.currency_id = ".C("DB_PREFIX")."currency.currency_id")
    			->where($where)->limit($Page->firstRow.','.$Page->listRows)
    			->select();
    	$member_info = $member->field('member_id,name,phone,email')->where($where)->find();
    	$this->assign('member_info',$member_info);
    	$this->assign('info',$info);
    	$this->assign('page',$show);
    	$this->display();
    }
    //修改个人币种数量
    public function updateMemberMoney(){
    	$member_id=I('post.member_id');
    	$currency_id=I('post.currency_id');
    	$num=I('post.num');
    	$forzen_num=I('post.forzen_num');
    	if(empty($member_id)||empty($member_id)){
    		$data['info']="参数不全";
    		$data['status']=0;
    	}
    	$where['member_id']=$member_id;
    	$where['currency_id']=$currency_id;
    	$r[]=M('Currency_user')->where($where)->setField('num',$num);
    	$r[]=M('Currency_user')->where($where)->setField('forzen_num',$forzen_num);
    	if($r){
    		$data['info']="修改成功";
    		$data['status']=1;
    	}else{
    		$data['info']="修改失败";
    		$data['status']=0;
    	}
    	$this->ajaxReturn($data);
    }
    
    
}

23:F:\git\coin\bisheng commerce\App\Admin\Controller\MessageController.class.php
<?php

/**
 * Created by PhpStorm.
 * User: "姜鹏"
 * Date: 16-3-14
 * Time: 上午10:35
 */
namespace Admin\Controller;

use Think\Page;

class MessageController extends AdminController {
	public function _initialize() {
		parent::_initialize ();
	}
	/**
	 * 显示系统消息界面
	 */
	public function index() {
		$title = I ( 'post.title' );
		if (! empty ( $title )) {
			$where ['title'] = array (
					'like',
					'%' . $title . '%' 
			);
		}
		$where ['type'] = array (
				"GT",
				0 
		);
		$M_member_all = M ( 'Message_all' );
		$count = $M_member_all->where ( $where )->count (); // 查询满足要求的总记录数
		$Page = new Page ( $count, 25 ); // 实例化分页类 传入总记录数和每页显示的记录数(25)
		 //给分页传参数
        setPageParameter($Page, array('title'=>$title));
		
		$show = $Page->show (); // 分页显示输出
		                             // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
		$list = $M_member_all->where ( $where )->alias ( 'a' )->field ( 'a.*, b.name type_name' )->join ( C("DB_PREFIX")."message_category as b on a.type = b.id " )->order ( " a.add_time desc " )->limit ( $Page->firstRow . ',' . $Page->listRows )->select ();
		// 查询消息类型
		$this->assign ( 'list', $list ); // 赋值数据集
		$this->assign ( 'page', $show ); // 赋值分页输出
		$this->display (); // 输出模板
	}
	
	/**
	 * 添加/修改消息
	 */
	public function addMessage() {
		if (IS_POST) {
			// 判断发送个人还是全体
			if ($_POST ['radios'] == 'one') {
				$data ['u_id'] = I ( 'post.u_id', '', 'intval' );
			} else {
				$data ['u_id'] = - 1; // -1 状态代表群发
			}
			$data ['add_time'] = time ();
			$data ['title'] = I ( 'post.title' );
			$data ['content'] = I ( 'post.content', '', 'html_entity_decode' );
			$data ['type'] = I ( 'post.type' );
			$M_Message_all = D ( 'Message_all' );
			if (! $M_Message_all->create ( $data )) {
				$this->error ( $M_Message_all->getError () );
				return;
			}
			if ($M_Message_all->add () === false) {
				$this->error ( '服务器繁忙,请稍后重试' );
				return;
			}
			$this->success ( '添加成功', U ( 'Message/index' ) );
			return;
		} else {
			$id = I ( 'get.id' );
			$list = M ( 'Message_all' )->where ( array (
					'id' => $id 
			) )->find ();
			// 分类
			$type = M ( 'Message_category' )->where ( 'id > 0' )->select ();
			$this->assign ( 'list', $list );
			$this->assign ( 'type', $type );
			$this->display ();
		}
	}
	/**
	 * 删除消息
	 * 
	 * @param
	 *        	$id
	 */
	public function delMessage($id) {
		if (empty ( $id )) {
			$this->error ( '参数错误' );
		}
		if (M ( 'Message_all' )->where ( array (
				'id' => $id 
		) )->delete () === false) {
			$this->error ( '服务器繁忙,请稍后重试' );
		}
		if (M ( 'Message' )->where ( array (
				'message_all_id' => $id 
		) )->delete () === false) {
			$this->error ( '服务器繁忙,请稍后重试' );
		}
		$this->success ( '删除成功', U ( 'Message/index' ) );
	}
}

24:F:\git\coin\bisheng commerce\App\Admin\Controller\PayController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
use Think\Page;

class PayController extends AdminController {
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	
     //人工充值审核页面
    public function payByMan(){
    
    		$status=I('status');
    		$member_name=I('member_name');
    		if(!empty($status)||$status==="0"){
    			$where[C("DB_PREFIX")."pay.status"]=$status;
    		}
    		if(!empty($member_name)){
    			$where[C("DB_PREFIX")."pay.member_name"]=array('like',"%".$member_name."%");
    		}
    	$count =  M('Pay')->where($where)->count();// 查询满足要求的总记录数
    	$Page  = new \Think\Page($count,20);// 实例化分页类 传入总记录数和每页显示的记录数(25)
    	//给分页传参数
    	setPageParameter($Page, array('status'=>$status,'member_name'=>$member_name));
    	
    	$show       = $Page->show();// 分页显示输出

    	$list= M('Pay')
    	->field(C("DB_PREFIX")."pay.*,".C("DB_PREFIX")."member.email")
    	->join("left join ".C("DB_PREFIX")."member on ".C("DB_PREFIX")."member.name=".C("DB_PREFIX")."pay.member_name")

    	->where($where)
    	->limit($Page->firstRow.','.$Page->listRows)
    	->order('add_time desc')
    	->select();
//     	echo M("Pay")->getLastSql();die;
    	foreach ($list as $k=>$v){
    		$list[$k]['status']=payStatus($v['status']);
    		$list[$k]['pay_reward']=$v['money']*$this->config['pay_reward']/100;
    	}
    	$this->assign('page',$show);
    	$this->assign('list',$list);
    	$this->assign('empty','暂无数据');
     	$this->display();
     }
     //人工充值审核处理
     public function payUpdate(){
     	$pay=M('Pay');
     	$where['pay_id']=$_POST['pay_id'];
     	$list=$pay->where($where)->find();
     	if($list['status']!=0){
     		$data['status'] = -1;
     		$data['info'] = "请不要重复操作";
     		$this->ajaxReturn($data);
     	}
     	$member_id=M('Member')->where("member_id='".$list['member_id']."'")->find();
     	if($_POST['status']==1){
     		$pay->where($where)->setField('status',1);
     		if($list['money']>=$this->congif['pay_reward_limit']){
     			$list['count']=$list['count']+$list['money']*$this->config['pay_reward']/100;
     		}
     		//修改member表钱数
     		$rs=M('Member')->where("member_id='".$list['member_id']."'")->setInc('rmb',$list['count']);
     		//添加财务日志
     		$this->addFinance($member_id['member_id'],6,"线下充值".$list['count']."。",$list['count'],1,0);
     		//添加信息表
     		$this->addMessage_all($member_id['member_id'], -2, '人工充值成功', '您申请的人工充值已成功，充值金额为'.$xnb);
     	}elseif($_POST['status']==2){
     		$rs=$pay->where($where)->setField('status',2);
     		//添加信息表
      		$this->addMessage_all($member_id['member_id'], -2, '人工充值审核未通过', '您申请的人工充值审核未通过,请重新处理');
     	}else{
     		$data['status'] = 0;
     		$data['info'] = "操作有误";
     		$this->ajaxReturn($data);
     	}
     	if($rs){
     		$data['status'] = 1;
     		$data['info'] = "修改成功";
     		$this->ajaxReturn($data);
     	}else{
     		$data['status'] = 2;
     		$data['info'] = "修改失败";
     		$this->ajaxReturn($data);
     	}
     }
     /**
      * 添加管理员充值
      */
     public function admRecharge(){
     	if(IS_POST){
     		$admin=M("Admin")->where("admin_id='{$_SESSION['admin_userid']}'")->find();
     		if(empty($_POST['password'])){
     			$this->error("请输入管理员密码");
     		}
     		if(md5($_POST['password'])!=$admin['password']){
     			$this->error("您输入的管理员密码错误");
     		}
     		if(empty($_POST['member_id'])){
     			$this->error('请输入充值人员');
     		}
     		if(!isset($_POST['currency_id'])){
     			$this->error('请输入币种');
     		}
     		if(empty($_POST['money'])){
     			$this->error('请输入充值金额');
     		}
     		$data['member_id'] = I('member_id','','intval');
     		$member=M('Member')->where('member_id='.$data['member_id'])->find();
     		if(!$member){
     			$this->error('用户不存在');
     		}
     		$data['member_name'] = $member['name'];
     		$data['currency_id'] = I('currency_id','','intval');
     		$data['money'] = I('money');
     		$data['status'] = 1;
     		$data['add_time']  = time();
     		$data['type'] = 3;//管理员充值类型
     		M()->startTrans();//开启事务
     		$r[] = M('Pay')->add($data);
     		if($data['currency_id']==0){
     			$r[] = M('Member')->where(array('member_id'=>$data['member_id']))->setInc('rmb',$data['money']);
     		}else{
     			$r[] = M('Currency_user')->where(array('member_id'=>$data['member_id'],array('currency_id'=>$data['currency_id'])))->setInc('num',$data['money']);
     		}
     		$r[] = $this->addFinance($data['member_id'], 3, "管理员充值", $data['money'], 1, $data['currency_id']);
     		$r[] = $this->addMessage_all($data['member_id'], -2, "管理员充值", "管理员充值".getCurrencynameByCurrency($data['currency_id']).":".$data['money']);
     		if(!in_array(false,$r)){
     			M()->commit();
     			$this->success('添加成功');
     			
     		}else{
     			M()->rollback();
     			$this->error('添加失败');
     		}
     	}else{
	     	$type_id=I('type_id');
			$email=I('email');
			$member_id=I('member_id');
			if(!empty($type_id)){
				$where['currency_id']=$type_id;
			}
			if(!empty($email)){
				$uid=M('Member')->where("email like '%{$email}%'")->find();
				$where["member_id"]=$uid['member_id'];
			}
	        if(!empty($member_id)){
	            $where["member_id"]=$member_id;
	        }
	        $where['type']=3;
     		$count =  M('pay')->where($where)->count();// 查询满足要求的总记录数
     		$Page  = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
     		//给分页传参数
     		setPageParameter($Page, array('type_id'=>$type_id,'email'=>$email,'member_id'=>$member_id));
     		
     		$show       = $Page->show();// 分页显示输出
     		
     		$list= M('Pay')->where($where)->limit($Page->firstRow.','.$Page->listRows)->order('add_time desc')->select();
     		//筛选
     		$type=M('Currency')->select();
     		$this->assign('type',$type);
     		$this->assign('page',$show);
     		$this->assign('list',$list);
     		$this->display();
     	}
     }
	  /**
      * 导出excel文件
      */
     public function derivedExcel(){

     	//时间筛选
     	$add_time=I('get.add_time');
     	$end_time=I('get.end_time');
     	$add_time=empty($add_time)?0:strtotime($add_time);
     	$end_time=empty($end_time)?0:strtotime($end_time);

     	$where[C("DB_PREFIX").'pay.add_time'] = array('lt',$end_time);
     	$list= M('Pay')
    	->field(C("DB_PREFIX")."pay.pay_id,"
		.C("DB_PREFIX")."member.email,"
		.C("DB_PREFIX")."member.name,"
		.C("DB_PREFIX")."pay.account,"
		.C("DB_PREFIX")."pay.money,"
		.C("DB_PREFIX")."pay.status,"
		.C("DB_PREFIX")."pay.add_time")
    	->join("left join ".C("DB_PREFIX")."member on ".C("DB_PREFIX")."member.name=".C("DB_PREFIX")."pay.member_name")

    	->where($where)
    	->where(C("DB_PREFIX").'pay.add_time>'.$add_time)
    	->order('add_time desc')
    	->select();
//     	echo M("Pay")->getLastSql();die;
    	foreach ($list as $k=>$v){
    		$list[$k]['status']=payStatus($v['status']);
    		$list[$k]['add_time']=date('Y-m-d H:i:s',$list[$k]['add_time']);
    	}
     	$title = array(
     		'订单号',
     		'汇款人账号',
     		'汇款人',
     		'银行卡号',
     		'充值钱数',
     		'实际打款',
     		'状态',
     		'时间',
     	);
     	$filename= $this->config['name']."人工充值日志-".date('Y-m-d',time());
     	$r = exportexcel($list,$title,$filename);
     }
	  //人工充值审核页面
    public function fill(){
     		$count =  M('Fill')->count();// 查询满足要求的总记录数
     		$Page  = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
     		$show       = $Page->show();// 分页显示输出
     		$list= M('Fill')->where()->limit($Page->firstRow.','.$Page->listRows)->order('id desc')->select();
     		$this->assign('page',$show);
     		$this->assign('list',$list);
     		$this->display();
     }
}

25:F:\git\coin\bisheng commerce\App\Admin\Controller\PendingController.class.php
<?php
/*
 * 后台审核提现
 */
namespace Admin\Controller;
use Admin\Controller\AdminController;
class PendingController extends AdminController {
	// 空操作
	public function _empty() {
		header ( "HTTP/1.0 404 Not Found" );
		$this->display ( 'Public:404' );
	}
	public function index() {
		$withdraw = M('withdraw');
		$bank = M ('bank');
		$cardname = I('get.cardname', '');
		$keyname = I('get.keyname', '');
		$status = I('get.status', '');

		$where = array();
		if (!empty($cardname))
			$where['b.cardname'] = array('LIKE', "%{$cardname}%");
		if (!empty($cardname))
			$where['b.cardname'] = array('LIKE', "%{$keyname}%");
		if (!empty($status))
			$where['w.status'] = $status;

		$count = $withdraw
						->table('__WITHDRAW__ w')
						->join('__BANK__ b ON w.bank_id=b.id', 'LEFT')
						->where($where)
						->count();
		$Page = new \Think\Page ($count, 20);
		// 分页显示输出
		$show = $Page->show(); 
		$info = $withdraw
					->table('__WITHDRAW__ w')
					->field('w.*,b.cardname,b.bank_branch,b.cardnum,b.bankname,ab.area_name barea_name,ab.parent_id,a.area_name aarea_name,m.nick,m.email')
					->join('__BANK__ b ON w.bank_id=b.id', 'LEFT')
					->join('__AREAS__ ab ON ab.area_id=b.address', 'LEFT')
					->join('__AREAS__ a ON a.area_id=ab.parent_id', 'LEFT')
					->join('__MEMBER__ m ON m.member_id=w.uid', 'LEFT')
					->where($where)
					->group('w.withdraw_id')
					->order('w.status desc,w.add_time desc')
					->limit($Page->firstRow . ',' . $Page->listRows)
					->select();

/*
		// 查询满足要求的总记录数
		$count = $withdraw->join ( C("DB_PREFIX")."bank ON ".C("DB_PREFIX")."withdraw.bank_id = ".C("DB_PREFIX")."bank.id" )->where ( $where )->count (); 
		// 实例化分页类 传入总记录数和每页显示的记录数
		$Page = new \Think\Page ( $count, 20 ); 
		//将分页（点击下一页）需要的条件保存住，带在分页中
		$Page->parameter = array (
				C("DB_PREFIX")."withdraw.status" => $where [C("DB_PREFIX")."withdraw.status"],
				C("DB_PREFIX")."bank.cardname" =>  $cardname 
		);
		// 分页显示输出
		$show = $Page->show(); 
		//需要的数据
		$field = C("DB_PREFIX")."withdraw.*,".C("DB_PREFIX")."bank.cardname,".C("DB_PREFIX")."bank.cardnum,".C("DB_PREFIX")."bank.bankname,b.area_name as barea_name,a.area_name as aarea_name";
		$info = $bank->field ( $field )

				->join ( C("DB_PREFIX")."withdraw ON ".C("DB_PREFIX")."withdraw.bank_id = ".C("DB_PREFIX")."bank.id" )
				->join(C("DB_PREFIX")."areas as b ON b.area_id = ".C("DB_PREFIX")."bank.address")
				->join(C("DB_PREFIX")."areas as a ON a.area_id = b.parent_id ")
				->join("__PREFIX__member as m ON m.member_id= b.uid ", 'LEFT')

				->where ( $where )
				->order ( C("DB_PREFIX")."withdraw.status desc,".C("DB_PREFIX")."withdraw.add_time desc" )
				->limit ( $Page->firstRow . ',' . $Page->listRows )
				->select ();*/

		$this->assign ( 'info', $info ); // 赋值数据集
		$this->assign ( 'page', $show ); // 赋值分页输出
		$this->assign ( 'inquire', $keyname );
		$this->display ();
	}

	/**
	 * 通过提现请求
	 * @param unknown $id
	 */
	public function successByid(){		
		$id = intval ( I ( 'post.id' ) );
			//判断是否$id为空
			if (empty ( $id ) ) {
				$datas['status'] = 3;
			    $datas['info'] = "参数错误";
			    $this->ajaxReturn($datas);
			}
		//查询用户可用金额等信息
		$info = $this->getMoneyByid($id);
		if($info['status']!=3){
			$datas['status'] = -1;
			$datas['info'] = "请不要重复操作";
			$this->ajaxReturn($datas);
		}
		//通过状态为2
		$data ['status'] = 2;
		$data ['check_time'] = time();
		$data ['admin_uid'] =$_SESSION['admin_userid'];
		//更新数据库
		$re = M ( 'Withdraw' )->where ( "withdraw_id = '{$id}'" )->save ( $data );	
		$num= M ( 'Withdraw' )->where ( "withdraw_id = '{$id}'" )->find ();
		M('Member')->where("member_id={$num['uid']}")->setDec('forzen_rmb',$num['all_money']);	
		if($re == false){
			$datas['status'] = 0;
			$datas['info'] = "提现操作失败";
			$this->ajaxReturn($datas);
		}
		$this->addMessage_all($info['member_id'],-2,'CNY提现成功',"恭喜您提现{$info['all_money']}成功！");
		$this->addFinance($info['member_id'],23,"提现{$info['all_money']}",$info['all_money']-$info['withdraw_fee'],2,0);
		$datas['status'] = 1;
		$datas['info'] = "提现通过，操作成功";
		$this->ajaxReturn($datas);
	}

	/**
	 * 不通过提现请求
	 * @param unknown $id
	 */
	public function falseByid(){
		$id = intval ( I ( 'post.id' ) );
			//判断是否$id为空
			if (empty ( $id ) ) {
				$this->error ( "参数错误" );
				return;
			}
		//查询用户可用金额等信息
		$info = $this->getMoneyByid($id);
		if($info['status']!=3){
			$datas['status'] = -1;
			$datas['info'] = "请不要重复操作";
			$this->ajaxReturn($datas);
		}
		//将提现的钱加回可用金额
		$money['rmb'] = floatval($info['rmb']) + floatval($info['all_money']);
		//将冻结的钱减掉
		$money['forzen_rmb'] = floatval($info['forzen_rmb']) - floatval($info['all_money']);
		
		//不通过状态为1
		$data ['status'] = 1;
		$data ['check_time'] = time();
		$data ['admin_uid'] =$_SESSION['admin_userid'];
		//更新数据库,member修改金额
		$res = M( 'Member' )->where("member_id = {$info['member_id']}")->save($money);
		//withdraw修改状态
		$re = M ( 'Withdraw' )->where ( "withdraw_id = '{$id}'" )->save ( $data );
		if($res == false){
			$datas['status'] = 0;
			$datas['info'] = "提现不通过，操作失败";
			$this->ajaxReturn($datas);
		}
		if($re == false){
			$datas['status'] = 2;
			$datas['info'] = "提现不通过，操作失败";
			$this->ajaxReturn($datas);
		}
		$this->addMessage_all($info['member_id'],-2,'CNY提现失败','很抱歉您提现失败，请重新操作或联系客服！');
		$datas['status'] = 1;
		$datas['info'] = "提现不通过，操作成功";
		$this->ajaxReturn($datas);
	}
	
	/**
	 * 获取提现金额信息
	 * @param unknown $id
	 * @return boolean|unknown $rmb 会员号，可用金额，冻结金额，手续费，提现金额
	 */
	public function getMoneyByid($id){

		$field = C("DB_PREFIX")."member.member_id,".C("DB_PREFIX")."member.rmb,".C("DB_PREFIX")."member.forzen_rmb,".C("DB_PREFIX")."withdraw.status,".C("DB_PREFIX")."withdraw.all_money,".C("DB_PREFIX")."withdraw.withdraw_fee";
		$rmb = M('Withdraw')
				->field($field)
				->join(C("DB_PREFIX")."member ON ".C("DB_PREFIX")."withdraw.uid = ".C("DB_PREFIX")."member.member_id")
				->where("withdraw_id = '{$id}'")
				->find();
		if(empty($rmb)){
			return false;
		}
		return $rmb;
	}
	/**
	 * 导出excel文件
	 */
	public function derivedExcel(){
		//时间筛选
		$add_time=I('get.add_time');
		$end_time=I('get.end_time');
		$add_time=empty($add_time)?0:strtotime($add_time);
		$end_time=empty($end_time)?0:strtotime($end_time);
		$where[C("DB_PREFIX").'withdraw.add_time'] = array('lt',$end_time);
		$withdraw = M('withdraw');
		$list = $withdraw
		->table('__WITHDRAW__ w')
		->field('
				w.withdraw_id,
				b.cardname,
				w.uid,
				b.bankname,
				b.cardnum,
				a.area_name aarea_name,
				ab.area_name barea_name,
				b.bank_branch,
				w.all_money,
				w.withdraw_fee,
				w.money,
				w.order_num,
				w.add_time,
				w.status')
		->join('__BANK__ b ON w.bank_id=b.id', 'LEFT')
		->join('__AREAS__ ab ON ab.area_id=b.address', 'LEFT')
		->join('__AREAS__ a ON a.area_id=ab.parent_id', 'LEFT')
		->join('__MEMBER__ m ON m.member_id=w.uid', 'LEFT')
		->where('w.add_time >'.$add_time)
		->select();
		foreach ($list as $k=>$v){
			$list[$k]['status']=drawStatus($v['status']);
			$list[$k]['add_time']=date('Y-m-d H:i:s',$v['add_time']);
			$list[$k]['cardnum']='`'.$list[$k]['cardnum'].'`';
		}
		$title = array(
				'Id',
				'提现人',
				'会员ID',
				'银行',
				'银行账号',
				'银行开户地',
				'银行开户地',
				'开户支行',
				'提现金额',
				'手续费',
				'实际金额',
				'订单号',
				'提交时间',
				'状态',
		);
		$filename= $this->config['name']."提现日志-".date('Y-m-d',time());
		$r = exportexcel($list,$title,$filename);
	}
}
?>

26:F:\git\coin\bisheng commerce\App\Admin\Controller\TongjiController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
use Think\Page;

class TongjiController extends AdminController {
	//空操作
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	
     //人工充值审核页面
    public function tuiguang(){
    	$memberid=I('userid');
    	$stime=strtotime(I('stime'));
    	$etime=strtotime(I('etime'));
    	if(!empty($memberid)){
    		$where['pid']=$memberid;
    	}
    	if(!empty($stime)){
    		$where['reg_time']=array('gt',$stime);
    	}
    	if(!empty($etime)){
    		$where['reg_time']=array('lt',$stime);
    	}
    	if(!empty($etime)&&!empty($stime)){
    		$where['reg_time']=array('between',$stime.','.$etime);
    	}
    	if(empty($memberid)){
    		$where['pid']=array('neq','');
    	}
       	$list=$this->getMemberTuijianPaiming($where);
		//获取本月第一天/最后一天的时间戳
       	$year = date("Y");
       	$month = date("m");
       	$allday = date("t");
       	$strat_time = strtotime($year."-".$month."-1");
       	$end_time = strtotime($year."-".$month."-".$allday);
       	
       	$monthWhere['reg_time']=array('between',$strat_time.','.$end_time);
    	$monthWhere['pid']=array('neq','');
       	$toMonth=$this->getMemberTuijianPaiming($monthWhere);
       	
       	//获取本周第一天/最后一天的时间戳
       	$year = date("Y");
       	$month = date("m");
       	$day = date('w');
       	$nowMonthDay = date("t");
       	$firstday = date('d') - $day;
       	if(substr($firstday,0,1) == "-"){
       		$firstMonth = $month - 1;
       		$lastMonthDay = date("t",$firstMonth);
       		$firstday = $lastMonthDay - substr($firstday,1);
       		$time_1 = strtotime($year."-".$firstMonth."-".$firstday);
       	}else{
       		$time_1 = strtotime($year."-".$month."-".$firstday);
       	}
       	
       	$lastday = date('d') + (7 - $day);
       	if($lastday > $nowMonthDay){
       		$lastday = $lastday - $nowMonthDay;
       		$lastMonth = $month + 1;
       		$time_2 = strtotime($year."-".$lastMonth."-".$lastday);
       	}else{
       		$time_2 = strtotime($year."-".$month."-".$lastday);
       	}
       	$weekWhere['reg_time']=array('between',$time_1.','.$time_2);
    	$weekWhere['pid']=array('neq','');
       	$week=$this->getMemberTuijianPaiming($weekWhere);
       	$this->assign('list',$list);
       	$this->assign('tomonth',$toMonth);
       	$this->assign('week',$week);
     	$this->display();
     }
    public function shuju(){
    	$memberid=I('userid');
    	$stime=strtotime(I('stime'));
    	$etime=strtotime(I('etime'));
    	if(!empty($memberid)){
    		$where['member_id']=$memberid;
    	}
    	if(!empty($stime)){
    		$where['add_time']=array('gt',$stime);
    	}
    	if(!empty($etime)){
    		$where['add_time']=array('lt',$stime);
    	}
    	if(!empty($etime)&&!empty($stime)){
    		$where['add_time']=array('between',$stime.','.$etime);
    	}
    	$list=M('Currency')->select();
    	foreach ($list as $k=>$v){
    		$alltj[$k]['currency_name']=$v['currency_name'];
    		$alltj[$k]['currency_id']=$v['currency_id'];
    		$alltj[$k]['currency_mark']=$v['currency_mark'];
    		$alltj[$k]['paytj']=$this->getCurrencyPayTongjiByCurrencyId($v['currency_id'],$where);
    		$alltj[$k]['tibitj']=$this->getCurrencyTibiTongjiByCurrencyId($v['currency_id'],$where);
    	}
    	$order=$this->getCurrencyOrderTongji($where);
    	$trade=$this->getCurrencyTradeTongji($where);
       	$this->assign('alltj',$alltj);
       	$this->assign('order',$order);
       	$this->assign('trade',$trade);
     	$this->display();
     }
    public function xiangxi(){
    	$memberid=I('userid');
    	$stime=strtotime(I('stime'));
    	$etime=strtotime(I('etime'));
    	if(!empty($memberid)){
    		$where['member_id']=$memberid;
    		$wherepaytj['member_id']=$memberid;
    	}
    	if(!empty($stime)){
    		$where['reg_time']=array('gt',$stime);
    	}
    	if(!empty($etime)){
    		$where['add_time']=array('lt',$stime);
    	}
    	if(!empty($etime)&&!empty($stime)){
    		$where['add_time']=array('between',$stime.','.$etime);
    	}
    	if(empty($memberid)){
    		$where['pid']=array('neq','');
    	}
    	$list=M('Currency')->select();
    	foreach ($list as $k=>$v){
    		$alltj[$k]['paytj']=$this->getCurrencyNumByCurrencyId($v['currency_id'],$wherepaytj);
    		$alltj[$k]['membertj']=$this->getCurrencyMemberNumByCurrencyId($v['currency_id'],$wherepaytj);
    		$alltj[$k]['cztxtj']=$this->getCurrencyTibiByCurrencyId($v['currency_id'],$where);
    		$where['currency_id']=$v['currency_id'];
	    	$order[]=$this->getCurrencyOrderTongji($where);
	    	$trade[]=$this->getCurrencyTradeTongji($where);
	    	$list[$k]['currency']=$this->getCurrencynameById($v['currency_id']);
	    	$list[$k]['trade_currency']=$this->getCurrencynameById($v['trade_currency_id']);
    	}
       	$this->assign('list',$list);
       	$this->assign('order',$order);
       	$this->assign('trade',$trade);
       	$this->assign('alltj',$alltj);
     	$this->display();
     }
    public function yue(){
    	$currencylist=M('Currency')->select();
    	$currency=I('currency_id')?I('currency_id'):'26';
    	$cur=$this->getCurrencynameById($currency);
    	$cur['currency_id']=$currency;
    	$list=$this->getMemberCurrencyPmByCurrencyId($currency);
    	$this->assign('currencylist',$currencylist);
    	$this->assign('cur',$cur);
    	$this->assign('list',$list);
     	$this->display();
     }
   private function getMemberTuijianPaiming($where){
	   	$list=M('Member')
	   	->field('count(member_id) as num,pid')
	   	->order('num desc')
	   	->where($where)
	   	->group('pid')
	   	->select();
	   	foreach ($list as $k=>$v){
	  	 	$list[$k]['pname']=$this->getMemberEailByMemberId($v['pid']);
	   	}
	   	return $list;
   }
   private function getMemberEailByMemberId($id){
   		$where['memner_id']=$id;
	   	$list=M('Member')
	   	->field('email')
	   	->where($where)
	   	->find();
	   	return $list['email'];
   }
   private function getMemberCurrencyPmByCurrencyId($currency,$where){
   		$where['currency_id']=$currency;
	   	$list=M('Currency_user')
	   	->field('')
	   	->order('num desc')
	   	->limit('0,200')
	   	->where($where)
	   	->select();
	   	foreach ($list as $k=>$v){
	   		$list[$k]['member']=$this->getMemberAllbyMemberId($v['member_id']);
	   		$list[$k]['allmoney']=$v['num']+$v['forzen_num'];
	   	}
	   	return $list;
   }
   private function getMemberAllbyMemberId($memberid){
   	return M('Member')->where('member_id='.$memberid)->find();
   	
   }
   private function getCurrencyPayTongjiByCurrencyId($currency,$where=''){
    	$where['currency_id']=$currency;
	   	$list=M('Pay')
	   	->field('count(pay_id) as allnum,sum(money) as allmoney')
	   	->group('currency_id')
	   	->where($where)
	   	->find();
	   	return $list;
   }
   private function getCurrencyTibiByCurrencyId($currency,$where=''){
    	$where['currency_id']=$currency;
    	$list['currency']=$this->getCurrencynameById($currency);
    	$where['status']=1;
    	if(!empty($where['member_id'])){
    		$where['user_id']=$where['member_id'];
    	}
	   	$list['txmoney']=M('Tibi')
	   	->field('sum(num) as txmoney')
	   	->group('currency_id')
	   	->where($where)
	   	->find();
	   	$where['status']=3;
	   	$list['czmoney']=M('Tibi')
	   	->field('sum(num) as czmoney')
	   	->group('currency_id')
	   	->where($where)
	   	->find();
	   	$where['status']=0;
	   	$list['jymoney']=M('Trade')
	   	->field('sum(num) as jymoney')
	   	->where($where)
	   	->find();
	   	return $list;
   }
   private function getCurrencyNumByCurrencyId($currency,$where=''){
    	$where['currency_id']=$currency;
	   	$list=M('Currency_user')
	   	->field('sum(num) as allnum,sum(forzen_num) as allcoldnum')
	   	->group('currency_id')
	   	->where($where)
	   	->find();
	   	$list['currency']=$this->getCurrencynameById($currency);
	   	return $list;
   }
   private function getCurrencyMemberNumByCurrencyId($currency,$where=''){
    	$where['currency_id']=$currency;
	   	$list=M('Currency_user')
	   	->field('sum(num) as allnum,sum(forzen_num) as allcoldnum')
	   	->group('currency_id')
	   	->where($where)
	   	->find();
	   	$list['currency']=$this->getCurrencynameById($currency);
	   	return $list;
   }
   private function getCurrencyTibiTongjiByCurrencyId($currency,$where=''){
    	$where['currency_id']=$currency;
	   	$list=M('tibi')
	   	->field('count(id) as allnum,sum(num) as allmoney')
	   	->group('currency_id')
	   	->where($where)
	   	->find();
	   	return $list;
   }
   private function getCurrencyOrderTongji($where=''){
	   	$list=M('orders')
	   	->field('count(orders_id) as num,sum(num*price) as jiaoyiprice,sum(num) as jiaoyinum,currency_trade_id,currency_id')
	   	->group('currency_id')
	   	->where($where)
	   	->select();
	   	foreach ($list as $k=>$v){
	   		$list[$k]['currency_trade_name']=$this->getCurrencynameById($v['currency_trade_id']);
	   		$list[$k]['currency_name']=$this->getCurrencynameById($v['currency_id']);
	   		$list[$k]['allmoney']+=$v['jiaoyiprice'];
	   	}
	   	return $list;
   }
   private function getCurrencyTradeTongji($where=''){
   		$where['type']='sell';
	   	$list=M('Trade')
	   	->field('count(trade_id) as num,sum(num*price) as jiaoyiprice,sum(num) as jiaoyinum,currency_trade_id,currency_id')
	   	->group('currency_id')
	   	->where($where)
	   	->select();
	   	foreach ($list as $k=>$v){
	   		$list[$k]['currency_trade_name']=$this->getCurrencynameById($v['currency_trade_id']);
	   		$list[$k]['currency_name']=$this->getCurrencynameById($v['currency_id']);
	   		$list[$k]['allmoney']+=$v['jiaoyiprice'];
	   	}
	   	return $list;
   }
}

27:F:\git\coin\bisheng commerce\App\Admin\Controller\TradeController.class.php
<?php
namespace Admin\Controller;
use Common\Controller\CommonController;
use Think\Page;

class TradeController extends AdminController {
    //空操作
    public function _empty(){
        header("HTTP/1.0 404 Not Found");
        $this->display('Public:404');
    }
    /**
     * 挂单记录
     */
    public function trade(){
            $type=I('type');
			$currency_id=I('currency_id');
			$email=I('email');
        	if(!empty($type)){
                $where['a.type'] = array("EQ",$type);
            }
            if(!empty($currency_id)){
                $where['a.currency_id'] = array("EQ",$currency_id);
            }
            if(!empty($email)){
                $where['c.email'] = array('like',"%".$email."%");
            }
        $field = "a.*,b.currency_name as b_name,c.email as email";
        $count      = M('Trade')
            ->alias('a')
            ->field($field)
            ->join("LEFT JOIN ".C("DB_PREFIX")."currency AS b ON a.currency_id = b.currency_id")
            ->join("LEFT JOIN ".C("DB_PREFIX")."member as c on a.member_id = c.member_id ")
            ->where($where)
            ->count();// 查询满足要求的总记录数
        $Page       = new Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
        //给分页传参数
        setPageParameter($Page, array('type'=>$type,'currency_id'=>$currency_id,'email'=>$email));
         
        $show       = $Page->show();// 分页显示输出
        // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
        $list = M('Trade')
            ->alias('a')
            ->field($field)
            ->join("LEFT JOIN ".C("DB_PREFIX")."currency AS b ON a.currency_id = b.currency_id")
            ->join("LEFT JOIN ".C("DB_PREFIX")."member as c on a.member_id = c.member_id ")
            ->where($where)
            ->order(" a.add_time desc ")
            ->limit($Page->firstRow.','.$Page->listRows)
            ->select();
        if($list){
            foreach ($list as $key=>$vo) {
                $list[$key]['type_name'] = getOrdersType($vo['type']);
            }
        }
        //币种
        $currency = M('Currency')->field('currency_name,currency_id')->select();
        $this->assign('currency',$currency);
        $this->assign('list',$list);
        $this->assign('page',$show);// 赋值分页输出
        $this->display();
    }

    /**
     * 委托记录
     */
    public function orders(){
        $status_id=I('status_id');
        $currency_id=I('currency_id');
        $email=I('email');
       
            if(!empty($currency_id)){
                $where['a.currency_id'] = array("EQ",$currency_id);
            }
            if(!empty($status_id)||$status_id==="0"){
                $where['a.status'] = array('EQ',$status_id);
            }
            if(!empty($email)){
                $where['c.email'] = array('like',"%".$email."%");
            }

        
        $field = "a.*,b.currency_name as b_name,c.email as email";
        $count      = M('Orders')
            ->alias('a')
            ->field($field)
            ->join("LEFT JOIN ".C("DB_PREFIX")."currency AS b ON a.currency_id = b.currency_id")
            ->join("LEFT JOIN ".C("DB_PREFIX")."member as c on a.member_id = c.member_id ")
            ->where($where)
            ->order(" a.add_time desc ")->count();// 查询满足要求的总记录数
        $Page       = new Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
        //给分页传参数
        setPageParameter($Page, array('status_id'=>$status_id,'currency_id'=>$currency_id,'email'=>$email));
        
        $show       = $Page->show();// 分页显示输出
        // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
        $list = M('Orders')
            ->alias('a')
            ->field($field)
            ->join("LEFT JOIN ".C("DB_PREFIX")."currency AS b ON a.currency_id = b.currency_id")
            ->join("LEFT JOIN ".C("DB_PREFIX")."member as c on a.member_id = c.member_id ")
            ->where($where)
            ->order(" a.add_time desc ")
            ->limit($Page->firstRow.','.$Page->listRows)
            ->select();
        //币种
        $currency = M('Currency')->field('currency_name,currency_id')->select();
        $this->assign('currency',$currency);
        $this->assign('list',$list);
        $this->assign('page',$show);// 赋值分页输出
        $this->display();
    }
    
    /**
     *撤销订单  
     */
	public function cancel($order_id){
		$order_id = I('post.order_id');
	
		if(empty($order_id)){
			$info['status'] = 0;
			$info['info'] = '撤销订单不正确';
			$this ->ajaxReturn($info);
		}
		 
		$where['orders_id'] = $order_id ;
		$where['status'] = array('in','0,1');
		$list = M('Orders')->where("orders_id = '$order_id'")->find();
		 
		if(empty($list)){
			$info['status'] = 1;
			$info['info'] = '撤销订单有误';
			$this ->ajaxReturn($info);
		}
		$member_id = $list['member_id'];
		$info =$this->cancelOrdersByOrderId($list);
		$this ->ajaxReturn($info);
	}
	/**
	 *撤销订单
	 * @param   int $list  订货单信息
	 * @param   int $member_id  用户id
	 * @param   int $order_id  订单号 id
	 */
	protected  function cancelOrdersByOrderId($one_order){
		M()->startTrans();
		$r[]=$this->setOrdersStatusByOrdersId(-1, $one_order['orders_id']);
		//返还资金
		switch ($one_order['type']){
			case 'buy':
				$money=($one_order['num']-$one_order['trade_num'])*$one_order['price'];
				$r[]= $this->setUserMoney($one_order['member_id'], $one_order['currency_trade_id'],$money , 'inc', 'num');
				$r[]=$this->setUserMoney($one_order['member_id'], $one_order['currency_trade_id'], $money, 'dec', 'forzen_num');
				break;
			case 'sell':
				$num=$one_order['num']-$one_order['trade_num'] ;
				$r[]= $this->setUserMoney($one_order['member_id'], $one_order['currency_id'],$num, 'inc', 'num');
				$r[]=$this->setUserMoney($one_order['member_id'], $one_order['currency_id'], $num, 'dec', 'forzen_num');
				break;
		}
		//更新订单状态
		if(!in_array(false, $r)){
			M()->commit();
			$info['status'] =1;
			$info['info'] = '撤销成功';
			return $info;
		}else{
			M()->rollback();
			$info['status'] = -1;
			$info['info'] = '撤销失败';
	
			return $info;
		}
	}
	/**
	 * 设置订单状态
	 * @param int $status  0 1 2 -1
	 * @param int $orders_id 订单id
	 * @return  boolean
	 */
	protected function setOrdersStatusByOrdersId($status,$orders_id){
		return M('Orders')->where("orders_id=$orders_id")->setField('status',$status);
	}
	
}

28:F:\git\coin\bisheng commerce\App\Admin\Controller\UploadController.class.php
<?php
namespace Admin\Controller;
use Common\Controller\CommonController;
class UploadController extends CommonController {
	public function _initialize(){
		parent::_initialize();
	}
	/**
	 * ajax上传图片方法
	 */
	function addPicForAjax(){
	    $upload = new \Think\Upload();// 实例化上传类
	    $upload->maxSize   =     3145728 ;// 设置附件上传大小
	    $upload->exts      =     array('jpg', 'gif', 'png', 'jpeg');// 设置附件上传类型
	    $upload->savePath  =      './Public/Uploads/'; // 设置附件上传目录
	    // 上传文件
	    $info   =   $upload->upload();
	    if(!$info) {// 上传错误提示错误信息
	        $arr['status']=0;
	        $arr['info']=$upload->getError();
	        $this->ajaxReturn();
	    }else{
	        // 上传成功
	        $pic='/Uploads'.ltrim($info['Filedata']['savepath'].$info['Filedata']['savename'],"."); ;//去除左侧点
	        $arr['status']=1;
	        $arr['info']=$pic;
	        $this->ajaxReturn($arr);
	    }
	}
}
?>

29:F:\git\coin\bisheng commerce\App\Admin\Controller\WebsitebankController.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午12:28
 */

namespace Admin\Controller;
use Think\Controller;
use Think\Page;
use Think\Upload;

class WebsitebankController extends AdminController {
    public function _initialize(){
        parent::_initialize();
    }
    /**
     * 会员列表
     */
    public function index(){
       
      	//$where['status'] = 1;
      	$where=array();
        $Website_bank = M('Website_bank');
        $count      = $Website_bank->where($where)->count();// 查询满足要求的总记录数
        $Page       = new Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
        $show       = $Page->show();// 分页显示输出
        // 进行分页数据查询 注意limit方法的参数要使用Page类的属性
        $list = $Website_bank
            ->where($where)
            ->limit($Page->firstRow.','.$Page->listRows)->select();
        $this->assign('list',$list);// 赋值数据集
        $this->assign('page',$show);// 赋值分页输出
        $this->display(); // 输出模板
    }
    /**
     * 添加银行卡
     */
    public function addBank(){
        if(IS_POST){
        	
            $Website_bank= D('Website_bank');
          
            if($r = $Website_bank->create()){
            	
                if($Website_bank->add($r)){
                    $this->success('添加成功',U('Websitebank/index'));
                    return;
                }else{
                    $this->error('服务器繁忙,请稍后重试');
                    return;
                }
            }else{
                $this->error($Website_bank->getError());
                return;
            }
        }else{
            $this->display();
        }
    }
    
    /**
     * 修改银行卡
     */
    public function saveBank(){
        $bank_id = I('get.bank_id','','intval');
        $Website_bank = D('Website_bank');
        if(IS_POST){
            $bank_id = I('post.bank_id','','intval');
            $where['bank_id'] = $bank_id;
            
            if($r = $Website_bank->create()){
            	 
            	if($Website_bank->save($r)){
            		$this->success('修改成功',U('Websitebank/index'));
            		return;
            	}else{
            		$this->error('服务器繁忙,请稍后重试');
            		return;
            	}
            }else{
            	$this->error($Website_bank->getError());
            	return;
            }
        }else{
            if($bank_id){
                $where['bank_id'] = $bank_id;
                $list = $Website_bank->where($where)->find();
                $this->assign('list',$list);
                $this->display();
            }else{
                $this->error('参数错误');
                return;
            }
        }
    }
    /**
     * 删除银行卡
     */
    public function delBank(){
    	
    	if(empty($_POST['bank_id'])){
    		$info['status'] = -1;
    		$info['info'] ='传入参数有误';
    		$this->ajaxReturn($info);
    	}
    	
        $bank_id = I('post.bank_id','','intval');
        $r = M('Website_bank')->delete($bank_id);

        if(!$r){
          	$info['status'] = 0;
        	$info['info'] ='删除失败';
        	$this->ajaxReturn($info);
        }
        
        $info['status'] = 1;
        $info['info'] ='删除成功';
        $this->ajaxReturn($info);
    }

    
}

30:F:\git\coin\bisheng commerce\App\Admin\Controller\ZhongchouController.class.php
<?php
namespace Admin\Controller;
use Admin\Controller\AdminController;
use Home\Controller\PublicController;
class ZhongchouController extends AdminController {
	//空操作
	public function _initialize(){
		parent::_initialize();
	}
	public function _empty(){
		header("HTTP/1.0 404 Not Found");
		$this->display('Public:404');
	}
	Public function add(){
		if(IS_POST){
			$D_Issue=D('Issue');
			if(!$data=$D_Issue->create($_POST)){
				$this->error($D_Issue->getError());
				return;
			}
			//处理上传文件
			if($_FILES["wenjian_url"]["tmp_name"]){
				$wenjian_url=$this->wenjianDownload($_FILES["wenjian_url"]);
				$data['wenjian_url']=$wenjian_url;
			}
			//处理图片
			if($_FILES["Filedata1"]["tmp_name"]){
				$data['url1']=$this->upload($_FILES["Filedata1"]);
			}
			if($_FILES["Filedata2"]["tmp_name"]){
				$data['url2']=$this->upload($_FILES["Filedata2"]);
			}
			//dump($data);
			//处理时间
			$data['add_time']=strtotime($data['add_time'])?strtotime($data['add_time']):time();
			$data['end_time']=strtotime($data['end_time'])?strtotime($data['end_time']):time();
			$data['ctime']=time();
			//成功比例
			if(!empty($_POST['zhongchou_success_bili'])){
				$data['zhongchou_success_bili']=I('post.zhongchou_success_bili')/100;
			}
			if(!empty($_POST['id'])){
				$data['id']=I('post.id');
				$rs=M('Issue')->save($data);
			}else{
				$rs=M('Issue')->add($data);
			}
			if($rs){
				$this->success('操作成功');
			}else{
				$this->error('操作失败');
			}
		}else{
			if(!empty($_GET['id'])){
				$list=M('Issue')->where('id='.I('get.id'))->find();
				$list['zhongchou_success_bili']=$list['zhongchou_success_bili']*100;
				$this->assign('info',$list['info']);
				$this->assign('list',$list);
			}
			$list=M('Currency')->field('currency_id,currency_name')->select();
			$this->assign('currency',$list);
			$this->display();
		}
		
	}
	
	//文件下载
	private function wenjianDownload($file){
		$upload = new \Think\Upload();// 实例化上传类
		$upload->maxSize   =     3145728 ;// 设置附件上传大小
		$upload->exts      =     array('xls', 'xlsx','doc');// 设置附件上传类型
		$upload->savePath  =      './Public/Uploads/'; // 设置附件上传目录
		// 上传文件
		$info   =  $upload->uploadOne($file);
		if(!$info) {
			// 上传错误提示错误信息
			$this->error($upload->getError());exit();
		}else{
			// 上传成功
				$url=$info['savepath'].$info['savename'];
				$url='/Uploads'.ltrim($url,".");
			if(isset($url)){
				return $url;
			}else{
				$this->error('文件上传失败');exit();
			}
		}
	}
	public function index(){
		$this->checkZhongchou();
		$Issue=M('Issue');
		$count      = $Issue->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		$show       = $Page->show();// 分页显示输出
		$list=$Issue
		->field(C("DB_PREFIX")."issue.*,".C("DB_PREFIX")."currency.currency_name as name")
		->join("left join ".C("DB_PREFIX")."currency on ".C("DB_PREFIX")."currency.currency_id=".C("DB_PREFIX")."issue.currency_id")
		->limit($Page->firstRow.','.$Page->listRows)
		->order('ctime desc')
		->select();
		foreach ($list as $k=>$v){
			$list[$k]['zhongchou_success_bili']=$v['zhongchou_success_bili']*100;
		}
		$this->assign('page',$show);// 赋值分页输出
		$this->assign('list',$list);
		$this->assign('empty','暂无数据');
		$this->display();
    }
    //删除
    public function del(){
    	if(!empty($_GET['id'])){
    		$rs=M('Issue')->where('id='.$_GET['id'])->find();
        }else{
        	$this->display('Public:404');exit();
        }
        $list=M('Issue')->where('id='.$_GET['id'])->delete();
    	if($list){
    		$this->success('删除成功');
    	}else{
    		$this->error('删除失败');
    	}
    }
    //手动结束众筹
    public function zhongchouEnd(){
    	if(empty($_GET['id'])){
        	$this->display('Public:404');exit();
    	}
    	$list=M('Issue')->where('id='.$_GET['id'])->setField('status',3);
    	M('Issue')->where('id='.$_GET['id'])->setField('end_time',time());
    	if($list){
    		$this->success('操作成功');
    	}else{
    		$this->error('操作失败');
    	}
    }
    //手动开始众筹
    public function zhongchouStart(){
    	if(empty($_GET['id'])){
    		$this->display('Public:404');exit();
    	}
    	$list=M('Issue')->where('id='.$_GET['id'])->setField('status',0);
    	M('Issue')->where('id='.$_GET['id'])->setField('add_time',time());
    	M('Issue')->where('id='.$_GET['id'])->setField('end_time',time());
    	 
    	if($list){
    		$this->success('操作成功');
    	}else{
    		$this->error('操作失败');
    	}
    }
    //解冻众筹记录
    public function jiedongById(){
    	$id=I('get.id');
    	$log=M('Issue_log')->where('id='.$id)->find();
    	if($log['status']==1){
    		$this->error('该记录已处理');
    	}
    	$list[]=M('Issue_log')->where("id=$id")->setField('deal',0);
    	$list[]=M('Issue_log')->where("id=$id")->setField('add_time',time());
    	$list[]=M('Currency_user')->where("member_id={$log['uid']} and currency_id={$log['cid']}")->setInc('num',$log['deal']);
    	$list[]=M('Currency_user')->where("member_id={$log['uid']} and currency_id={$log['cid']}")->setDec('forzen_num',$log['deal']);
    	$list[]=M('Issue_log')->where("id=$id")->setField('status',1);
    	if($list){
    		$this->success('操作成功');
    	}else{
    		$this->error('操作失败');
    	}
    }
    //解冻众筹全部冻结
    public function jiedongByIid(){
    	$id=I('post.iid');
    	$log=M('Issue_log')->where('iid='.$id)->select();
    	foreach ($log as $k=>$v){
    		if($v['status']==1){
    			continue;
    		}
    		$list[]=M('Issue_log')->where("id={$v['id']}")->setField('deal',0);
    		$list[]=M('Issue_log')->where("id={$v['id']}")->setField('add_time',time());
    		$list[]=M('Currency_user')->where("member_id={$v['uid']} and currency_id={$v['cid']}")->setInc('num',$v['deal']);
    		$list[]=M('Currency_user')->where("member_id={$v['uid']} and currency_id={$v['cid']}")->setDec('forzen_num',$v['deal']);
    		$list[]=M('Issue_log')->where("id={$v['id']}")->setField('status',1);
    	}
    	if($list){
    		$this->success('操作成功');
    	}else{
    		$this->error('操作失败');
    	}
    }

    //开始解冻方法  修改所有未解冻账号时间为0，使解冻程序运行
    public function jiedong_start(){	
    	$id=I('post.iid');
    	$log=M('Issue_log')->where('num=deal and iid='.$id)->select();
    	//echo M('Issue_log')->_sql();dump($log);
    	if(!$log){
    		$data['status']=0;
    		$data['info']='无对应记录';
    		$this->ajaxReturn($data);
    	}
    	foreach ($log as $k=>$v){
    		$list=$this->getIssueRemoveForzenBiLiByIssueId($v['iid']);
    		$v['remove_forzen_bili'] = $list['remove_forzen_bili']/100;
    		$v['remove_forzen_cycle'] = $list['remove_forzen_cycle'];
    		$r=M('Issue_log')->where("id={$v['id']}")->setDec('deal',$v['num']*$v['remove_forzen_bili']);
    		$r=M('Issue_log')->where("id={$v['id']}")->setField('add_time',time());
    		$r=M('Currency_user')->where("member_id={$v['uid']} and currency_id={$v['cid']}")->setInc('num',$v['num']*$v['remove_forzen_bili']);
    		$r=M('Currency_user')->where("member_id={$v['uid']} and currency_id={$v['cid']}")->setDec('forzen_num',$v['num']*$v['remove_forzen_bili']);
    	}
    	if($r){
    		$data['status']=1;
    		$data['info']='操作成功';
    		$this->ajaxReturn($data);
    	}else{
    		$data['status']=0;
    		$data['info']='无记录';
    		$this->ajaxReturn($data);
    	}
    }
    /**
     * 根据认筹id查找解冻比例
     * @param int $id Issue Id
     * @return 解冻比例
     */
    private function getIssueRemoveForzenBiLiByIssueId($id){
    	$list =  M('Issue')->field('is_forzen,remove_forzen_bili')->where("id = $id")->find();
    	//echo M('Issue')->_sql();
    	//dump($list);
    	if($list['is_forzen']==0){
    		return $list;
    	}else{
    		return 0;
    	}
    }
    //众筹记录
    public function log(){
    	$iid=I('iid');
    	$name=I('name');
    	$uid=I('uid');
    	$email=I('email');
    	if(!empty($iid)){
    		$where[C("DB_PREFIX")."issue_log.iid"]=$iid;
    	}
    	if(!empty($uid)){
    		$where['yang_issue_log.uid']=$uid;
    	}
    	if(!empty($name)){
    		$uid=M('Member')->where("name like '%{$name}%'")->select();
			foreach($uid as $k=>$v){
				$arr[]=$uid[$k]['member_id'];
			}
    		$where[C("DB_PREFIX")."issue_log.uid"]=array('in',$arr);
    	}
    	if(!empty($email)){
    		$uid=M('Member')->where("email like '%{$email}%'")->select();
    		foreach($uid as $k=>$v){
    			$arr[]=$uid[$k]['member_id'];
    		}
    		$where['yang_issue_log.uid']=array('in',$arr);
    	}
    	$count      = M('Issue_log')->count();// 查询满足要求的总记录数
    	$Page       = new \Think\Page($count,25);// 实例化分页类 传入总记录数和每页显示的记录数(25)
    	//给分页传参数
    	setPageParameter($Page, array('iid'=>$iid,'uid'=>$uid,'name'=>$name,'email'=>$email));
    	
    	$show       = $Page->show();// 分页显示输出
    	$log=M('Issue_log')
    	->field(C("DB_PREFIX")."issue_log.*,".C("DB_PREFIX")."member.name,".C("DB_PREFIX")."issue.title,".C("DB_PREFIX")."issue_log.num*".C("DB_PREFIX")."issue_log.price as count")
    	->join("left join ".C("DB_PREFIX")."member on ".C("DB_PREFIX")."member.member_id=".C("DB_PREFIX")."issue_log.uid")
    	->join("left join ".C("DB_PREFIX")."issue on ".C("DB_PREFIX")."issue.id=".C("DB_PREFIX")."issue_log.iid")
    	->order('add_time desc')
    	->limit($Page->firstRow.','.$Page->listRows)
    	->where($where)->select();
        foreach ($log as $key=>$vo) {
            $log[$key]['buy_name'] = $vo['buy_currency_id']==0?"人民币":M('Currency')->where("currency_id='{$vo['buy_currency_id']}'")->find()['currency_name'];
        }


        $this->assign('log',$log);
    	$this->assign('page',$show);
    	$issue=M('Issue')->field('id,title')->select();
    	$this->assign('issue',$issue);
    	$this->assign('empty','暂无数据');
    	$this->display();
    }

	/**
	 * 众筹推荐奖励管理
	 */
	public function awards(){
		$id = I('id','','intval');
		//获取表单
		if(IS_POST){
			if(empty($_POST['zc_awards_currency_id'])){
				$this->error('请填写币种');
				return;
			}
			if(!isset($_POST['zc_awards_one_ratio'])){
				$this->error('请填写一级比例');
				return;
			}
			if(!isset($_POST['zc_awards_two_ratio'])){
				$this->error('请填写二级比例');
				return;
			}
			if(!isset($_POST['zc_awards_status'])){
				$this->error('请填写是否开启状态');
				return;
			}
			if($_POST['zc_awards_one_ratio']>100 || $_POST['zc_awards_two_ratio'] > 100){
				$this->error('比例不能大于100%');
				return;
			}
			$r =  M('Issue')->where("id=$id")->save($_POST);
			//处理数据动态插入
// 			foreach ($_POST as $key=>$vo) {
// 				$r[] = M('Issue')->where(array('key'=>$key))->setField('value',$vo);
// 			}
			//判断成功
			if($r){
				$this->success('保存成功');
			}else{
				$this->error('保存失败');
			}
		}
		else{
			//获取币种
			$currency = M('Currency')->field('currency_id,currency_name')->select();
			$list = M('Issue')
					->field('id,zc_awards_currency_id,zc_awards_one_ratio,zc_awards_two_ratio,zc_awards_status')
					->where("id =$id")
					->find();
			$this->assign('list',$list);
			$this->assign('currency',$currency);
			$this->display();
		}
	}

	public function awardsList(){
		$count      = M('Finance')->where("type = 12 ")->count();// 查询满足要求的总记录数
		$Page       = new \Think\Page($count,10);// 实例化分页类 传入总记录数和每页显示的记录数(25)
		$show       = $Page->show();// 分页显示输出
		$list=M('Finance')
			->order('add_time desc')
			->limit($Page->firstRow.','.$Page->listRows)
			->where("type = 12 ")->select();
		$this->assign('list',$list);
		$this->assign('page',$show);
		$this->assign('empty','暂无数据');
		$this->display();
	}
}

31:F:\git\coin\bisheng commerce\App\Admin\index.html
 

32:F:\git\coin\bisheng commerce\App\Admin\Model\index.html
 

33:F:\git\coin\bisheng commerce\App\Admin\Model\IssueModel.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午2:23
 */

namespace Admin\Model;
use Think\Model;

class IssueModel extends Model{

    protected $_validate = array(
//        array(验证字段1,验证规则,错误提示,[验证条件,附加规则,验证时间]),
//        array('agree','1','条款必须同意',1,'equal',1),//同意条款
    		
        array('title','require','众筹标题不能为空'),
        array('num','require','众筹发售量不能为空'),

        array('num_nosell','require','众筹保留不能为空'),
    	array('deal','require','众筹剩余量不能为空'),


        array('price','require','众筹价格不能为空'),
        array('limit','require','众筹每人限购不能为空'),
    		
    	array('remove_forzen_bili',array(0,100),'解冻比例必须在100%内',0,'between'),

        array('min_limit','require','众筹最低购买不能为空'),
        array('limit_count','require','众筹限购次数不能为空'),

        array('zhongchou_success_bili','require','众筹成功比例不能为空'),
    );

}

34:F:\git\coin\bisheng commerce\App\Admin\Model\MemberModel.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午2:23
 */

namespace Admin\Model;
use Think\Model;

class MemberModel extends Model{

    protected $_validate = array(
//        array(验证字段1,验证规则,错误提示,[验证条件,附加规则,验证时间]),
//        array('agree','1','条款必须同意',1,'equal',1),//同意条款
        array('email','email','email格式不正确',1,'',1), //验证邮箱
        array('pwd','require','登录密码不能为空',1,'',1),
        array('pwd','checkPwd','密码格式不正确',1,'function',1), //函数认证密码(同样要求)
        array('repwd','pwd','确认密码不正确',1,'confirm',1), //二次密码是否一样


        array('pwdtrade','require','交易密码不能为空',1,'',1),
        array('pwdtrade','checkPwd','交易密码不正确',1,'function',1), // 函数认证支付密码(同样要求)
        array('repwdtrade','pwdtrade','确认交易密码不正确',1,'confirm',1), // 二次密码是否一样

        //modify验证

        array('nick','require','昵称不能为空',1,'',2),
        array('name','require','真实姓名不能为空',1,'',2),
        array('idcard','require','身份证号码必须填写',1,'',2),
        array('phone','require','手机号码必须填写',1,'',2),
    );

    protected $_auto = array(
//       array(完成字段1,完成规则,[完成条件,附加规则]),
        array('pwd','md5',1,'function'), //加密登录密码
        array('pwdtrade','md5',1,'function'), // 加密支付密码
    );

    /**
     * 验证密码长度在6-20个字符之间
     * @param $pwd
     * @return bool
     */
    public function checkPwd($pwd){
        $pattern="/^[\\w-\\.]{6,20}$/";
        if(preg_match($pattern, $pwd)){
            return true;
        }else{
            return false;
        }
    }

    public function logCheckEmail($email){
        $where['email'] = $email;
        $info = $this->where($where)->find();
        if($info){
            return $info;
        }else{
            return false;
        }
    }

    public function logCheckMo($mo){
        $where['phone'] = $mo;
        $info = $this->where($where)->find();
        if($info){
            return $info;
        }else{
            return false;
        }
    }

}

35:F:\git\coin\bisheng commerce\App\Admin\Model\Message_allModel.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午2:23
 */

namespace Admin\Model;
use Think\Model;

class MessageModel extends Model{

    protected $_validate = array(
//        array(验证字段1,验证规则,错误提示,[验证条件,附加规则,验证时间]),
        array('title','require','标题不能为空',1,'',1),
        array('type','require','类型不能为空',1,'',1),
        array('content','require','内容不能为空',1,'',1),
    );
}

36:F:\git\coin\bisheng commerce\App\Admin\Model\WebsiteBankModel.class.php
<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 16-3-8
 * Time: 下午2:23
 */

namespace Admin\Model;
use Think\Model;

class WebsiteBankModel extends Model{

    protected $_validate = array(
//        array(验证字段1,验证规则,错误提示,[验证条件,附加规则,验证时间]),
//        array('agree','1','条款必须同意',1,'equal',1),//同意条款
    		
        array('bank_name','require','收款人不能为空'),
        array('bank_adddress','require','开户行不能为空'),

        array('bank_no','require','银行卡账号不能为空'),
    	//array('bank_no','number','请正确填写银行卡'),
    );

    protected $_auto = array(
//       array(完成字段1,完成规则,[完成条件,附加规则]),
        array('status',1), 
    );

}

37:F:\git\coin\bisheng commerce\App\Admin\View\Art\helpindex.html
   <include file="App/Admin/View/Public/left.html"/>
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">文章管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
            	<!--article_category_id传递文章类型id-->
                <form action="{:U('Art/helpindex')}" method="post" id="myform">
                    <table class="search-tab">
                        <tr>
                            <th width="120">选择分类:</th>
                            <td>

                               <select name="news_id" id="news_id">
                                  <option value="">全部</option>
                                  <volist name="category" id="vo">
                                    <option value="{$vo.id}" <eq name="vo.id" value="$inquire.news_id">selected="selected"</eq>> {$vo.name}</option>
          
                                  </volist>
                                </select>
                            </td>  
                            <th width="70">标题:</th>
                            <td><input class="common-text" placeholder="关键字" name="title" value="{$inquire.news_title}" id="news_title" type="text"></td>
                            <td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
            </div>
        </div>
        <div class="result-wrap">
           
                <div class="result-title">
                    <div class="result-list">
                    	<!--article_category_id传递文章类型id-->
                        <a href="{:U('Art/insert',array('article_category_id'=>6))}"><i class="icon-font"></i>新增文章</a>
                        <a href="{:U('Arttype/insert')}"><i class="icon-font"></i>新增帮助类别</a>
                    </div>
                </div>
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>ID</th>
                            <th>标题</th>
                            <th>分类</th>
                            <th>内容</th>
                            <th>标红</th>
                            <th>更新时间</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
  						<volist name='info' id='vo'>
                        <tr>
                            <td>{$vo.article_id}</td>
                            <td>{$vo.title}</td>
                            <td>{$vo.name}</td>
                            <td>{$vo.content}</td>
                            <td><eq name="vo.sign" value="1">是<else/>否</eq></td>
                            <td>{$vo.add_time|date='Y-m-d H:i:s',###}</td>
                            <td>{$vo.status}</td>
                            <td>												
                                <a class="link-update" href="{:U('Art/insert',array('article_id'=>$vo['article_id'],'article_category_id'=>$vo['parent_id']))}">修改</a>
                                &nbsp;&nbsp;
                                <a class="link-del" href="{:U('Art/delete', array('article_id'=>$vo['article_id']))}" onclick="return confirm('确认删除吗？')">删除</a>
                            </td>                        
                            </tr>
                        </volist>
                       
                    </table>
                    <div class="list-page"> <ul>{$page}</ul></div>
                </div>
          
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(9).show();
$(".sub-menu").eq(9).children("li").eq(2).addClass("on");

</script>

38:F:\git\coin\bisheng commerce\App\Admin\View\Art\index.html
   <include file="App/Admin/View/Public/left.html"/>
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">文章管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
            	<!--article_category_id传递文章类型id-->
                <form action="{:U('Art/index')}" method="post" id="myform">
                    <table class="search-tab">
                        <tr>
                            <th width="120">选择分类:</th>
                            <td>
                            {$category[0]['name']}
                            </td>      
                            <input type="hidden" id="article_category_id" name="article_category_id" value="{$Think.get.article_category_id}">
                            <th width="70">标题:</th>
                            <td><input class="common-text" placeholder="关键字" name="title" value="{$inquire.news_title}" id="news_title" type="text"></td>
                            <td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
            </div>
        </div>
        <div class="result-wrap">
           
                <div class="result-title">
                    <div class="result-list">
                    	<!--article_category_id传递文章类型id-->
                        <a href="{:U('Art/insert',array('article_category_id'=>$category[0]['id']))}"><i class="icon-font"></i>新增文章</a>
                    </div>
                </div>
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>ID</th>
                            <th>标题</th>
                            <th>分类</th>
                            <th>内容</th>
                            <th>标红</th>
                            <th>更新时间</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
  						<volist name='info' id='vo'>
                        <tr>
                            <td>{$vo.article_id}</td>
                            <td>{$vo.title}</td>
                            <td>{$vo.name}</td>
                            <td>{$vo.content}</td>
                            <td><eq name="vo.sign" value="1">是<else/>否</eq></td>
                            <td>{$vo.add_time|date='Y-m-d H:i:s',###}</td>
                            <td>{$vo.status}</td>
                            <td>												
                                <a class="link-update" href="{:U('Art/insert',array('article_id'=>$vo['article_id'],'article_category_id'=>$category[0]['id']))}">修改</a>
                                &nbsp;&nbsp;
                                <a class="link-del" href="{:U('Art/delete', array('article_id'=>$vo['article_id']))}" onclick="return confirm('确认删除吗？')">删除</a>
                            </td>                        
                            </tr>
                        </volist>
                       
                    </table>
                    <div class="list-page"> <ul>{$page}</ul></div>
                </div>
          
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(9).show();
$("#myform").ready(function(e) {
	var num = parseInt($("#article_category_id").val());
	switch(num){
		case 1:
			$(".sub-menu").eq(9).children("li").eq(0).addClass("on");
			break;
		case 2:
			$(".sub-menu").eq(9).children("li").eq(1).addClass("on");
			break;
		case 6:
			$(".sub-menu").eq(9).children("li").eq(2).addClass("on");
			break;
		case 7:
			$(".sub-menu").eq(9).children("li").eq(3).addClass("on");
			break;
		}
});
</script>

39:F:\git\coin\bisheng commerce\App\Admin\View\Art\insert.html
<include file="App/Admin/View/Public/left.html"/>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/kindeditor.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/lang/zh_CN.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/plugins/prettify.js"></script>
<script>
	function checkForm(){
		editor.sync();
		var name = document.getElementById('title').value;

		if(name != ""){
			document.getElementById('myform').submit();
		}else{
			alert('请填写标题');
		}
	}
</script>

<div class="main-wrap">
  <div class="crumb-wrap">
    <div class="crumb-list"><i class="icon-font"></i><a href=":U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><a class="crumb-name" href="javascript:void(0)" onclick="history.go(-1)">文章管理</a><span class="crumb-step">&gt;</span><span>新增文章</span></div>
  </div>
  <div class="result-wrap">
    <div class="result-content">
      <form action="{:U('Art/insert')}" method="post" id="myform" name="myform" enctype="multipart/form-data" >
        
        <table class="insert-tab" width="100%">
          <tbody>
            <tr>
              <th width="120"><i class="require-red">*</i>分类：</th>
              <td>
              <eq name="category[0]['parent_id']" value="6">
              	<select name="category_id" id="category_id" class="required" >
                  <volist name="category" id="vo">
                   <option value="{$vo.id}" <eq name="vo.id" value="$list.position_id">selected="selected"</eq>> {$vo.name}</option>
                  </volist>
                </select>           
                <else />
                {$category[0]['name']}
                </eq>
                </td>
            </tr>
            <input type="hidden" id="article_category_id" name="article_category_id" value="{$Think.get.article_category_id}">
            <tr>
              <th><i class="require-red">*</i>标题：</th>
              <td><input class="common-text required" id="title" name="title" size="50" value="{$list.title}" type="text"></td>
            </tr>
            <!--                          <tr>
                                <th>状态：</th>
                                <td>
                                <select name="status" id="status" class="required">
                                    <option value="1" selected="selected">显示</option>
                                    <option value="0">不显示</option>
                                </select>
                                </td>
                            </tr>-->
            <tr>
            <th>是否标红</th>
            <td>
            <label><input type="radio" name="sign" value="1"/> 是</label>
            <label><input type="radio" name="sign" value="0" checked="checked" /> 否</label>
            </td>
            </tr>
            
            <tr>
              <th>内容：</th>
              <input type="hidden" value="{$list.article_id}" name="article_id">
              <td><textarea id="content" name="content" cols="30" style="width:800px;height:300px;" rows="10">{$list.content}</textarea>
			<script>									
                    KindEditor.ready(function(K) {
                            window.editor = K.create('#content');	
                    });

            </script>
            </td>
            </tr>
            <tr>
              <th></th>
              <!--确定文章的类型-->
              
               <!--确定后台成功返回的url-->
               <eq name="category[0]['parent_id']" value="6">
               <!--<input type="hidden" name="article_category_id" value="{$article_category['id']}">-->
               <input type="hidden" name="url" value="{:U('Art/helpindex')}">
               <else />
               <input type="hidden" name="category_id" value="{$category[0]['id']}">
               <input type="hidden" name="url" value="{:U('Art/index',array('article_category_id'=>$category[0]['id']))}">
               </eq>
              <td><input class="btn btn-primary btn6 mr10" value="提交"  type="button" onclick="checkForm()" >
                <input class="btn btn6" onclick="history.go(-1)" value="返回" type="button"></td>
            </tr>
          </tbody>
        </table>
      </form>
    </div>
  </div>
</div>
<!--/main-->

</div>
</body></html>
<script>
$(".sub-menu").eq(9).show();
$("#myform").ready(function(e) {
	var num = parseInt($("#article_category_id").val());
	switch(num){
		case 1:
			$(".sub-menu").eq(9).children("li").eq(0).addClass("on");
			break;
		case 2:
			$(".sub-menu").eq(9).children("li").eq(3).addClass("on");
			break;
		case 7:
			$(".sub-menu").eq(9).children("li").eq(2).addClass("on");
			break;
		default:
			$(".sub-menu").eq(9).children("li").eq(1).addClass("on");
		}
});
</script>

40:F:\git\coin\bisheng commerce\App\Admin\View\Arttype\insert.html
<include file="App/Admin/View/Public/left.html"/>
<script>
	function checkForm(){
		var name = document.getElementById('name').value;
		var sort = document.getElementById('sort').value;
		if(name != ""){
			if(!isNaN(sort)){
			   document.getElementById('myform').submit();
			}else{
			   alert("排序请输入数字");
			}
		}else{
			alert('请填写分类名称');
		}
	}
</script>
<style>
.newtable {width:60%; float:left; border:#eee 1px  solid; text-align:center;}
.newtable  tr  td{line-height: 40px;  border:#eee 1px  solid;}



</style>
<div class="main-wrap">
  <div class="crumb-wrap" >
    <div class="crumb-list"><i class="icon-font"></i><a href="U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><a class="crumb-name" href="{:U('Arttype/index')}">文章分类管理</a><span class="crumb-step">&gt;</span><span>新增文章分类</span></div>
  </div>
  <div class="result-wrap" style="border:none;">
    <div class="result-content" style="float:left; width:40%;">
      <form action="{:U('Arttype/insert')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
        <table class="insert-tab"   >
          <tbody>
            
            <tr>
                <th><i class="require-red">*</i>分类名称：</th>
                <td><input class="common-text required" id="name" name="name" size="50" value="{$list.name}" type="text"></td>
            </tr>
            <tr>
                <th>关键字：</th>
                <td><input class="common-text required" id="keyword" name="keyword" size="50" value="{$list.keywords}" type="text"></td>
            </tr>       
            <tr>
              <th>排序(输入数字)：</th>
              <td><input class="common-text required" id="sort" name="sort" size="50" value="{$list.sort}" type="text"></td>
            </tr>
            <input type="hidden" name="fenlei_id" value="{$list.id}">
            <tr><i class="require-red">*</i>为必填，其他选填</tr>
            <tr>
              <th></th>
              <td><input class="btn btn-primary btn6 mr10" value="提交"  type="button" onclick="checkForm()" >
                <input class="btn btn6" onclick="history.go(-1)" value="返回" type="button"></td>
            </tr>
          </tbody>
        </table>
        </form>
        
    </div>    
        <table class="newtable" >
        <tr>
        <td>ID</td>
        <td>分类名：</td>
        <td>关键字：</td>
        <td>排序：</td>
        <td>操作</td>
        </tr>

                  <volist name="cat" id="vo">
                   	<tr>
                    <td>{$vo.id}</td>
                    <td>{$vo.name}</td>
                    <td>{$vo.keywords}</td>
                    <td>{$vo.sort}</td>
                    <td> 
                    	<a class="link-update" href="{:U('Arttype/insert',array('id'=>$vo['id']))}">修改</a>
                         &nbsp;&nbsp;
                        <a class="link-del" href="{:U('Arttype/delete', array('id'=>$vo['id']))}" onclick="return confirm('确认删除吗？')">删除</a></td>
                    </tr>
                  </volist>

     
     </table>
     
     
    
  </div>
</div>
<!--/main-->

</div>
</body></html>
<script>
$(".sub-menu").eq(9).show();
$(".sub-menu").eq(9).children("li").eq(1).addClass("on");
</script>

41:F:\git\coin\bisheng commerce\App\Admin\View\Bonus\bonuslist.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">分红列表</span></div>
        </div>
        <div class="search-wrap">
           
        </div>
        <div class="result-wrap">

            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>用户</th>
                        <th>分红金额</th>
                        <th>分红币种</th>
						<th>分红时间</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['member_id']|getMemberNameByMemberid =###}</td>
							<td>{$vo['money']|default=0}</td>
                            <td>{$vo.currency_id|getCurrencynameByCurrency=###}</td>
							 <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                        </tr>
                    </volist>
                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(4).show();
$(".sub-menu").eq(4).children("li").eq(1).addClass("on");
</script>

42:F:\git\coin\bisheng commerce\App\Admin\View\Bonus\index.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">添加分红奖励</span></div>
    </div>

    <div class="result-wrap">
    <div style="float:left; width:30%; margin-right:20px;">
             <div class="config-title">

				<h1><i class="icon-font">&#xe00a;</i>添加分红</h1>
			</div>
        <form action="{:U('Bonus/addBonus')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                        
                        
                        <tr>
                            <th style="width:35%;"><i class="require-red">*</i>分红金额：</th>
                            <td><input name="num"  type="text"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                        
                        <tr>
                            <th><i class="require-red">*</i>分红运算基数：</th>
							 <td>
								<select name="currency_id" id="category">
								<foreach name="currency" item="vo">
								<option  value="{$vo.currency_id}">{$vo.currency_name}</option>
								</foreach>
								</select>
							</td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>用户得到币种：</th>
							 <td>
								<select name="set_currency_id" id="category">
								<option value="0">人民币</option>
								<foreach name="currency" item="vo">
								<option  value="{$vo.currency_id}">{$vo.currency_name}</option>
								</foreach>
								</select>
							</td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>消息提醒：</th>
                            <td><input name="text" type="text"></td>
                        </tr>
                       
                            <th></th>
                            <td>
                                <input type="button" onclick="subform()" value="提交" class="btn btn-primary btn6 mr10">
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
    <div style="float:left; width:65%;">
	 <div class="config-title">
         <h1><i class="icon-font">&#xe00a;</i>分红管理</h1>
     </div>
	<table class="result-tab" width="100%">
                    <tr>
                        <th>分红手续费币种</th>
                        <th>分红手续费总数</th>
						<th>已分手续费</th>
                        <th>剩余分红手续费</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                           <td>{$vo.currency_id|getCurrencynameByCurrency=###}</td>
                            <td>{$vo['sumMoney']|default=0}</td>
							<td>{$vo['money']|default=0}</td>
                           <td><if condition="$vo['sumMoney'] - $vo['money'] lt 0" > 0<else/> {$vo['sumMoney'] - $vo['money']}</if>  </td>
                        </tr>
                    </volist>
                </table>
    </div>

	
		<div style="clear:both;"></div>
    </div>
</div>
<script>
ckemail = 0;

function subform(){
	$('#myform').submit();
	
}
</script>

<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(4).show();
$(".sub-menu").eq(4).children("li").eq(0).addClass("on");
</script>

43:F:\git\coin\bisheng commerce\App\Admin\View\Config\customerservice.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span></div>
        </div>
        <div class="result-wrap">
            <form action="{:U('Config/updateCofig')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
                <div class="config-items">
                    <div class="config-title">
                        <h1><i class="icon-font">&#xe00a;</i>网站客服设置</h1>
                    </div>
                    <div class="result-content">
                        <table width="100%" class="insert-tab">
                            <tbody>
                                 <tr>
                                    <th><i class="require-red">*</i>客服电话：</th>
                                    <td><input type="text" id="" value="{$config.tel}" size="85" name="tel" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>官方微博：</th>
                                    <td><input type="text" id="" value="{$config.weibo}" size="85" name="weibo" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>微信二维码图片上传：</th>
                                    <td><input type="file" id="" value="{$config.weixin}" size="85" name="weixin" class="common-text"><input type="hidden" id="" value="{$config.weixin}" size="85" name="weixin" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>客服QQ1：</th>
                                    <td><input type="text" id="" value="{$config.qq1}" size="85" name="qq1" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>客服QQ2：</th>
                                    <td><input type="text" id="" value="{$config.qq2}" size="85" name="qq2" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>客服QQ3：</th>
                                    <td><input type="text" id="" value="{$config.qq3}" size="85" name="qq3" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>QQ群1：</th>
                                    <td><input type="text" id="" value="{$config.qqqun1}" size="85" name="qqqun1" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>QQ群2：</th>
                                    <td><input type="text" id="" value="{$config.qqqun2}" size="85" name="qqqun2" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>QQ群3：</th>
                                    <td><input type="text" id="" value="{$config.qqqun3}" size="85" name="qqqun3" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>客服邮箱：</th>
                                    <td><input type="text" id="" value="{$config.email}" size="85" name="email" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>业务合作邮箱：</th>
                                    <td><input type="text" id="" value="{$config.business_email}" size="85" name="business_email" class="common-text"></td>
                                </tr>
                              	 <tr >
                                    <th><i class="require-red"></i>QQ群链接代码：</th>
                                    <td ><textarea id="" value="{$config.qqqun_url}" name="qqqun_url" class="common-text" style="width:610px;height:100px;">{$config.qqqun_url}</textarea></td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td>
                                        <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                        <input type="button" value="返回" onclick="history.go(-1)" class="btn btn6">
                                    </td>
                                </tr>
                            </tbody></table>
                    </div>
                </div>
                
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(0).show();
$(".sub-menu").eq(0).children("li").eq(3).addClass("on");
</script>

44:F:\git\coin\bisheng commerce\App\Admin\View\Config\finance.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span></div>
        </div>
        <div class="result-wrap">
            <form action="{:U('Config/updateCofig')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
                <div class="config-items">
                    <div class="config-title">
                        <h1><i class="icon-font">&#xe00a;</i>网站财务设置</h1>
                    </div>
                    <div class="result-content">
                        <table width="100%" class="insert-tab">
                            <tbody>
                              <tr>
                                    <th><i class="require-red">*</i>交易时间段：开始时间</th>
                                    <td>时：<input type="text" id="" value="{$config.jiaoyi_start_hour}" size="30" name="jiaoyi_start_hour" class="common-text">&nbsp;&nbsp;&nbsp;分：<input type="text" id="" value="{$config.jiaoyi_start_minute}" size="30" name="jiaoyi_start_minute" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>交易时间段：结束时间</th>
                                    <td>时：<input type="text" id="" value="{$config.jiaoyi_over_hour}" size="30" name="jiaoyi_over_hour" class="common-text">&nbsp;&nbsp;&nbsp;分：<input type="text" id="" value="{$config.jiaoyi_over_minute}" size="30" name="jiaoyi_over_minute" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>人工充值最低限额：</th>
                                    <td><input type="text" id="" value="{$config.pay_min_money}" size="85" name="pay_min_money" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>人工充值最高限额：</th>
                                    <td><input type="text" id="" value="{$config.pay_max_money}" size="85" name="pay_max_money" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>登录超时退出（分钟）：</th>
                                    <td><input type="num" id="" value="{$config.time_limit}" size="85" name="time_limit" class="common-text">为0则此项无配置</td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>人工充值手续费：</th>
                                    <td><input type="text" id="" value="{$config.pay_fee}" size="85" name="pay_fee" class="common-text">元&nbsp;&nbsp;&nbsp;固定费用，无请填0</td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>人工提现手续费：</th>
                                    <td><input type="text" id="" value="{$config.fee}" size="85" name="fee" class="common-text">%&nbsp;&nbsp;&nbsp;比例费用，无请填0</td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>提币手续费：</th>
                                    <td><input type="text" id="" value="{$config.tcoin_fee}" size="85" name="tcoin_fee" class="common-text">%&nbsp;&nbsp;&nbsp;比例费用，无请填0</td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>网站总交易额增加：</th>
                                    <td><input type="text" id="" value="{$config.transaction_false}" size="85" name="transaction_false" class="common-text">用于首页显示</td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>解冻比例：</th>
                                    <td><input type="text" id="" value="{$config.jiedong_bili}" size="85" name="jiedong_bili" class="common-text">%&nbsp;&nbsp;&nbsp;每日按照设置比例解冻</td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td>
                                        <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                        <input type="button" value="返回" onclick="history.go(-1)" class="btn btn6">
                                    </td>
                                </tr>
                            </tbody></table>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(0).show();
$(".sub-menu").eq(0).children("li").eq(2).addClass("on");
</script>

45:F:\git\coin\bisheng commerce\App\Admin\View\Config\index.html

<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<div class="main-wrap">
	<div class="crumb-wrap">
		<div class="crumb-list">
			<i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span>
		</div>
	</div>
	<div class="result-wrap">
		<form action="{:U('Config/updateCofig')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
			<div class="config-items">
				<div class="config-title">
					<h1>
						<i class="icon-font">&#xe00a;</i>网站信息设置
					</h1>
				</div>
				<div class="result-content">
					<table width="100%" class="insert-tab">
						<tbody>
							<tr>
								<th width="15%"><i class="require-red">*</i>网站LOGO：</th>
								<td><img style="width: 300px;height: 150px;border-radius: 15px;border: 1px solid;" src="{$config.logo}"><input type="hidden"
									name="logo" value="{$config.logo}" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站LOGO上传：</th>
								<td><input type="file" name="logo" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站网址：</th>
								<td><input type="text" id="" value="{$config.localhost}"
									size="85" name="localhost" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站标题：</th>
								<td><input type="text" id="" value="{$config.title}"
									size="85" name="title" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站名称：</th>
								<td><input type="text" id="" value="{$config.name}"
									size="85" name="name" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站关键字：</th>
								<td><input type="text" id="" value="{$config.keywords}"
									size="85" name="keywords" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站虚拟币英文标识：</th>
								<td><input type="text" id="" value="{$config.xnb}"
									size="85" name="xnb" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站虚拟币代称：</th>
								<td><input type="text" id="" value="{$config.xnb_name}"
									size="85" name="xnb_name" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>虚拟币对人民币兑换：</th>
								<td><input type="text" id="" value="{$config.bili}"
									size="85" name="bili" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>网站描述：</th>
								<td><input type="text" id="" value="{$config.desc}"
									size="85" name="desc" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>版权信息：</th>
								<td><input type="text" id="" value="{$config.copyright}"
									size="85" name="copyright" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>备案信息：</th>
								<td><input type="text" id="" value="{$config.record}"
									size="85" name="record" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>地址：</th>
								<td><input type="text" id="" value="{$config.address}"
									size="85" name="address" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>新币申请表上传：</th>
								<td><input type="file" name="biaoge_url" class="common-text"></td>
							</tr>
							<tr>
								<th></th>
								<td><input type="submit" value="提交"
									class="btn btn-primary btn6 mr10"> <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</form>
	</div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(0).show();
$(".sub-menu").eq(0).children("li").eq(0).addClass("on");
</script>

46:F:\git\coin\bisheng commerce\App\Admin\View\Config\information.html
<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/kindeditor/kindeditor.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/kindeditor/lang/zh_CN.js"></script>
<script type="text/javascript" charset="utf-8"
	src="__PUBLIC__/kindeditor/plugins/prettify.js"></script>

<div class="main-wrap">
  <div class="crumb-wrap">
    <div class="crumb-list"> <i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span> </div>
  </div>
  <script>
			function checkForm(){
				editor.sync();
				editor1.sync();
				editor2.sync();
				editor3.sync();
				editor4.sync();
				editor7.sync();
				editor8.sync();
				editor9.sync();
				editor10.sync();
				document.getElementById('myform').submit();
		}
</script>
  <style>
.insert-tab td {
	padding: 10px;
}
</style>
  <div class="result-wrap">
    <form action="{:U('Config/updateCofig')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
      <div class="config-items">
        <div class="config-title">
          <h1> <i class="icon-font">&#xe00a;</i>网站信息设置 </h1>
        </div>
        <div class="result-content">
          <table width="100%" class="insert-tab">
            <tbody>
              <tr>
                <th><i class="require-red"></i>友情提示：</th>
                <td><textarea id="content" value="" name="friendship_tips"
										class="common-text" style="width: 610px; height: 100px;">{$config.friendship_tips}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor  = K.create('#content');
												
									});
          					     </script>
              <tr>
                <th><i class="require-red"></i>风险提示：</th>
                <td><textarea id="content1" value="" name="risk_warning"
										class="common-text" style="width: 610px; height: 100px;">{$config.risk_warning}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor1 = K.create('#content1');	
									});
          					     </script>
              <tr>
                <th><i class="require-red"></i>提现提示：</th>
                <td><textarea id="content2" value=""
										name="withdraw_warning" class="common-text"
										style="width: 610px; height: 100px;">{$config.withdraw_warning}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor2 = K.create('#content2');	
									});
          					   </script>
              <tr>
                <th><i class="require-red"></i>邀请规则：</th>
                <td><textarea id="content3" value="" name="invite_rule"
										class="common-text" style="width: 610px; height: 100px;">{$config.invite_rule}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor3 = K.create('#content3');	
									});
          					   </script>
              <tr>
                <th><i class="require-red"></i>交易规则：</th>
                <td><textarea id="content4" value="" name="VAP_rule"
										class="common-text" style="width: 610px; height: 100px;">{$config.VAP_rule}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor4 = K.create('#content4');	
									});
                          </script>
              <tr>
                <th><i class="require-red"></i>免责声明：</th>
                <td><textarea id="content7" value="" name="disclaimer"
										class="common-text" style="width: 610px; height: 100px;">{$config.disclaimer}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor7 = K.create('#content7');	
									});
          					   </script>
              <tr>
                <th><i class="require-red"></i>服务条款：</th>
                <td ><textarea id="content8" value="" name="FWTK" class="common-text" style="width:610px;height:100px;">{$config.FWTK}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor8 = K.create('#content8');	
									});
          					   </script>
              <tr>
                <th><i class="require-red"></i>新币上线申请：</th>
                <td ><textarea id="content9" value="" name="new_coin_up" class="common-text" style="width:610px;height:100px;">{$config.new_coin_up}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor9 = K.create('#content9');	
									});
          					   </script>      
			  <tr>
                <th><i class="require-red"></i>注册风险警示：</th>
                <td ><textarea id="content10" value="" name="reg_risk_warning" class="common-text" style="width:610px;height:100px;">{$config.reg_risk_warning}</textarea></td>
              </tr>
              <script>									
									KindEditor.ready(function(K) {
											window.editor10 = K.create('#content10');	
									});
								</script>   							   
            <th></th>
              <td><input type="button" value="提交" onclick="checkForm()"
									class="btn btn-primary btn6 mr10">
                <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
            </tr>
            </tbody>
            
          </table>
        </div>
      </div>
    </form>
  </div>
</div>
<!--/main-->
</div>
</body></html><script>
$(".sub-menu").eq(0).show();
$(".sub-menu").eq(0).children("li").eq(1).addClass("on");
</script>

47:F:\git\coin\bisheng commerce\App\Admin\View\Config\shortmessage.html

<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<div class="main-wrap">
	<div class="crumb-wrap">
		<div class="crumb-list">
			<i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span>
		</div>
	</div>
	<div class="result-wrap">
		<form action="{:U('Config/updateCofig')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
			<div class="config-items">
				<div class="config-title">
					<h1>
						<i class="icon-font">&#xe00a;</i>网站短信设置
					</h1>
				</div>
				<div class="result-content">
					<table width="100%" class="insert-tab">
						<tbody>
							<tr>
								<th><i class="require-red">*</i>短信接口用户名：</th>
								<td><input type="text" id=""
									value="{$config.CODE_USER_NAME}" size="85"
									name="CODE_USER_NAME" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>短信接口密码：</th>
								<td><input type="text" id=""
									value="{$config.CODE_USER_PASS}" size="85"
									name="CODE_USER_PASS" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>短信接口发送标题：</th>
								<td><input type="text" id="" value="{$config.CODE_NAME}"
									size="85" name="CODE_NAME" class="common-text"></td>
							</tr>
                              <tr>
								<th><i class="require-red">*</i>购买短信地址：</th>
								<td><a href="http://www.smsbao.com/reg?r=10217" style="font-size:24px">点击进入</a></td>
							</tr>
							<tr>
								<td colspan="2"><div class="config-title">
										<h1>
											<i class="icon-font">&#xe00a;</i>网站邮箱设置
										</h1>
									</div></td>
							</tr>

							<tr>
								<th><i class="require-red">*</i>您的企业邮局域名：</th>
								<td><input type="text" id="" value="{$config.EMAIL_HOST}"
									size="85" name="EMAIL_HOST" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>邮局用户名(请填写完整的email地址)：</th>
								<td><input type="text" id=""
									value="{$config.EMAIL_USERNAME}" size="85"
									name="EMAIL_USERNAME" class="common-text"></td>
							</tr>

							<tr>
								<th><i class="require-red">*</i>邮局密码：</th>
								<td><input type="text" id=""
									value="{$config.EMAIL_PASSWORD}" size="85"
									name="EMAIL_PASSWORD" class="common-text"></td>
							</tr>
                          
							<tr>
								<th></th>
								<td><input type="submit" value="提交"
									class="btn btn-primary btn6 mr10"> <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</form>
	</div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
	$(".sub-menu").eq(0).show();
	$(".sub-menu").eq(0).children("li").eq(4).addClass("on");
</script>

48:F:\git\coin\bisheng commerce\App\Admin\View\Currency\add.html
    <include file="App/Admin/View/Public/left.html"/>
     <script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/kindeditor.js"></script>
	<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/lang/zh_CN.js"></script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/plugins/prettify.js"></script>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">币种设置</span></div>
        </div>
        <div class="result-wrap">
            <form action="{:U('Currency/add')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
                <div class="config-items">
                    <div class="config-title">
                        <h1><i class="icon-font">&#xe00a;</i>币种详细信息设置</h1>
                    </div>
                    <div class="result-content">
                        <table width="100%" class="insert-tab">
                            <tbody>
                            <tr>
                                <th width="15%"><i class="require-red">*</i>货币LOGO</th>
                                <td><img  style="height:200px;"src="{$list.currency_logo}"><input type="hidden" name="currency_logo" value="{$list.currency_logo}" class="common-text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>货币LOGO上传</th>
                                <td><input type="file" name="Filedata" class="common-text"></td>
                            </tr>
                                <tr>
                                    <th><i class="require-red">*</i>货币名称：</th>
                                    <td><input type="text" id="" value="{$list.currency_name}" size="85" name="currency_name" class="common-text"><input type="hidden" id="" value="{$list.currency_id}" size="85" name="currency_id" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>英文标识</th>
                                    <td><input type="text" id="" value="{$list.currency_mark}" size="85" name="currency_mark" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>显示排序</th>
                                    <td><input type="text" id="" value="{$list.sort}" size="85" name="sort" class="common-text"><i class="require-red">（在前端显示的排序，数值越小，排序越靠前）</i></td>
                                </tr>
                               <tr>
                                    <th><i class="require-red">*</i>最大(单次提币额度)</th>
                                    <td><input type="text" id="" value="{$list.currency_all_tibi}" size="85" name="currency_all_tibi" class="common-text"></td>
                                </tr>
								
								<tr>
                                    <th><i class="require-red">*</i>发行总量</th>
                                    <td><input type="text" id="" value="{$list.currency_all_num}" size="85" name="currency_all_num" class="common-text"><i class="require-red">（与最新价格乘积为总市值）</i></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>买入手续费</th>
                                    <td><input type="text" id="" value="{$list.currency_buy_fee}" size="85" name="currency_buy_fee" class="common-text">%</td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>卖出手续费</th>
                                    <td><input type="text" id="" value="{$list.currency_sell_fee}" size="85" name="currency_sell_fee" class="common-text">%</td>
                                </tr>
						     	 <tr>
                                    <th><i class="require-red">*</i>限制位数</th>
                                    <td><input type="text" id="" value="{$list.currency_digit_num}" size="85" name="currency_digit_num" class="common-text"></td>
                                </tr>
								<tr>
                                    <th><i class="require-red">*</i>链接地址</th>
                                    <td><input type="text" id="" value="{$list.currency_url}" size="85" name="currency_url" class="common-text"></td>
                                </tr>
								<tr>
                                    <th><i class="require-red">*</i>用户名</th>
                                    <td><input type="text" id="" value="{$list.rpc_user}" size="85" name="rpc_user" class="common-text"></td>
                                </tr>
								<tr>
                                    <th><i class="require-red">*</i>密码</th>
                                    <td><input type="text" id="" value="{$list.rpc_pwd}" size="85" name="rpc_pwd" class="common-text"></td>
                                </tr>
								<tr>
                                    <th><i class="require-red">*</i>地址</th>
                                    <td><input type="text" id="" value="{$list.rpc_url}" size="85" name="rpc_url" class="common-text"></td>
                                </tr>
								<tr>
                                    <th><i class="require-red">*</i>端口号</th>
                                    <td><input type="text" id="" value="{$list.port_number}" size="85" name="port_number" class="common-text"></td>
                                </tr>

									<tr>
                                    <th><i class="require-red">*</i>钱包密钥</th>
                                    <td><input type="text" id="" value="{$list.qianbao_key}" size="85" name="qianbao_key" class="common-text"><i class="require-red">*密钥妥善保存，一旦丢失，后果严重且找不回</i></td>
									
                                </tr>
								

								<tr>
                                    <th><i class="require-red">*</i>上线开关</th>
                                    <td>关闭上线：<input type="radio" name="is_line" value="0" <eq name="list.is_line" value="0">checked="checked"</eq> />
										开启上线：<input type="radio" name="is_line" value="1"  <eq name="list.is_line" value="1">checked="checked"</eq> />
									
									</td>
                                </tr>

                             	<tr>
                                    <th><i class="require-red">*</i>交易开关</th>
                                    <td>开启交易：<input type="radio" name="is_lock" value="0" <eq name="list.is_lock" value="0">checked="checked"</eq> />
										关闭交易：<input type="radio" name="is_lock" value="1"  <eq name="list.is_lock" value="1">checked="checked"</eq> />
									
									</td>
                                </tr>
									<tr>
                                    <th><i class="require-red">*</i>买入币种</th>
                                    <td><select name="trade_currency_id">
										 <option value="0">人民币</option>
										 <volist name="currency_currency" id="vo">
										 	 <option value="{$vo.currency_id}" <eq name="list.trade_currency_id" value="$vo.currency_id">selected="selected"</eq>>{$vo.currency_name}</option>
										 </volist>
										</select>
									</td>
                                </tr>
                               	<tr>
                                    <th><i class="require-red">*</i>货币详情链接</th>
                                    <td>
                                    	<input type="text" id="" value="{$list.detail_url}" size="85" name="detail_url" class="common-text">
									</td>
                                </tr>
                                <!--  <tr>
                                    <th><i class="require-red">*</i>币种说明</th>
                                    <td>	
                                    <textarea id="content3" value="" name="currency_content" class="common-text" style="width:610px;height:100px;">					{$list.currency_content}
                                    </textarea>							
									</td>
                                </tr>
                                 <tr>
                               		 <th><i class="require-red">*</i>货币详情图片上传</th>
                               		 <td><input type="file" name="pic" class="common-text"></td>
                           		 </tr>
                                 <volist name='pic' id='vo'>
                                 <tr>
                               		 <th><i class="require-red">*</i>货币详情图片展示<br>(<a href="{:U('Currency/delCurrencyPic',array('id'=>$vo['id']))}">点此处删除此详情图片</a>)</th>
                               		 <td><img src='{$vo.pic}' style="height:200px;"></td>
                           		 </tr>
                                 </volist>-->
                                <tr>
                                    <th></th>
                                    <td>
                                        <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                        <a href="{:U('Currency/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                                    </td>
                                </tr>
                            </tbody></table>
                    </div>
                </div>
                
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(2).show();
$(".sub-menu").eq(2).children("li").eq(1).addClass("on");
</script>
<script>									
	KindEditor.ready(function(K) {
		window.editor1 = K.create('#content3');	
	});
</script>

49:F:\git\coin\bisheng commerce\App\Admin\View\Currency\chongzhi_index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">充币记录</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Currency/tibi_index')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">会员账号:</th>
                            <td><input class="common-text" placeholder="关键字" name="email" type="text"></td>
							     <td><select name="cuid">
								 <volist name="curr" id='vo'>
								 	<option value="{$vo.currency_id}" <eq name="id" value="$vo['currency_id']">selected='selected'</eq>>{$vo.currency_name}</option>
								 </volist>
								 
								 
								 </select></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                      
                        <th>会员邮箱</th>
						<th>币种名称</th>
						<th>转入钱包地址</th>
                        <th>转出数量</th>
                        <th>实际数量</th>
                        <th>操作时间</th>
                     
                        <th>状态</th>
              
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                         
                            <td>{$vo['email']}</td>
							<td>{$vo['currency_name']}</td>
							<td>{$vo['url']}</td>
                            <td>{$vo['num']}</td>
                            <td>{$vo['actual']}</td>
							<td>{$vo['add_time']|date='Y-m-d H:i:s',###}</td>
                         
						
                            <td><if condition="$vo['status'] eq 2">
									充值中...
								</if>
								<if condition="$vo['status'] eq 3">
									充值完成
								</if>
								
								</td>
                          
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(8).show();
$(".sub-menu").eq(8).children("li").eq(1).addClass("on");
</script>

50:F:\git\coin\bisheng commerce\App\Admin\View\Currency\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">币种管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
            </div>
        </div>
        <div class="result-wrap">
          
                <div class="result-title">
                    <div class="result-list">
                        <a href="{:U('Currency/add')}"><i class="icon-font"></i>新增币种</a>
                    </div>
                </div>
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                        	<th>排序</th>
                            <th>货币LOGO</th>
                            <th>上线状态</th>
                            <th>交易状态</th>
                            <th>货币名称</th>
                            <th>英文标识</th>
							<th>钱包余额</th>
                            <th>买入手续费</th>
                            <th>卖出手续费</th>
                            <th>最新价</th>
                            <th>涨停价格</th>
                            <th>跌停价格</th>
                            <th>修改时间</th>
                            <th>操作</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr> 
                        	<td>{$vo.sort}</td>
                            <td><notempty name="vo.currency_logo"><img  style="height:100px;"src='{$vo.currency_logo}' /><else/>暂无图片数据</notempty></td>
                            <td><eq name='vo.is_line' value='0'>未上线<else/>已上线</eq></td>
                            <td><eq name='vo.is_lock' value='0'>已开启<else/>未开启</eq></td>
                            <td>{$vo.currency_name}</td>
                            <td>{$vo.currency_mark}</td>
							<td>{$vo.qianbao_balance}</td>
                            <td>{$vo.currency_buy_fee}%</td>
                            <td>{$vo.currency_sell_fee}%</td>
                            <td>{$vo['new_price']|default="0.000"}</td>
                            <td>{$vo['price_up']|default="0.000"}</td>
                            <td>{$vo['price_down']|default="0.000"}</td>
                            <td>{$vo.add_time|date="Y-m-d",###}</td>
                            <td>
                                <a class="link-update" href="{:U('Trade/trade',array('currency_id'=>$vo['currency_id']))}">查看交易记录</a></br> <a class="link-limit" href="javascript:void(0);" onclick="limit({$vo['currency_id']},{$vo['price_up']},{$vo['price_down']})">设置交易限额</a><br>
                                <a class="link-update" href="{:U('Trade/orders',array('currency_id'=>$vo['currency_id']))}">查看委托记录</a><br>
                                <a class="link-del" href="{:U('Currency/set_member_currencyForQianbao',array('cuid'=>$vo['currency_id']))}">向会员钱包转账</a><br>
                                <a class="link-update" href="{:U('Currency/add',array('currency_id'=>$vo['currency_id']))}">修改</a><br>
                                <a class="link-del" href="{:U('Currency/del',array('currency_id'=>$vo['currency_id']))}">删除</a><br>
								 
                               
                            </td>
                        </tr>
                        </volist>
                    </table>
                </div>
         
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(8).show();
$(".sub-menu").eq(8).children("li").eq(0).addClass("on");

function limit(id,price_up,price_down){
	var lid = id;
	var price_up = price_up;
	var price_down = price_down;
	layer.open({
	  title: '设置交易限额',
	  type: 1,
	  skin: 'layui-layer-demo', //样式类名
	  closeBtn: 1, //不显示关闭按钮
	  shift: 2,
	  area: ['300px', '170px'], 
	  shadeClose: true, //开启遮罩关闭
	  content: '<div style="margin-top:15px;text-align:center;"><span>设置交易上限</span><input type="text" name="price_up" value="'+price_up+'" id="price_up"/></div><div style="margin-top:15px;text-align:center;"><span>设置交易下限</span><input type="text" value='+price_down+' name="price_down" id="price_down"/></div><div style="text-align:center;margin-top:15px;"><input type="button" value="确定" onclick="setlimit('+lid+');" style="padding:3px 10px;" /></div>'
	});

};
function setlimit(id){
	$.post("{:U('Currency/savePrice')}",{id:id,price_up:$("#price_up").val(),price_down:$("#price_down").val()},function(data){
		 if(data<0){
			layer.msg(data.info);
		 }else{
			layer.msg(data.info);
			setTimeout("location.reload()",2000);
		 }
	});
}
</script>

51:F:\git\coin\bisheng commerce\App\Admin\View\Currency\set_member_currencyForQianbao.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="/think/admin">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">钱包转账</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Currency/set_member_currencyForQianbao')}" method="post" id="myform" name="myform">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>{$currency.currency_name}</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                    	<notempty name="currency">
						<input type="hidden" name="cuid" value="{$currency.currency_id}">
						</notempty>
						  <tr>
                            <th><i class="require-red"></i>钱包余额：</th>
                            <td><span>{$currency.balance}</span></td>
                        </tr>
                        <tr>
                            <th><i class="require-red"></i>用户名：</th>
                            <td><input name="name" type="text" ></td>
                        </tr>
						 <tr>
                            <th><i class="require-red"></i>数量：</th>
                            <td><input name="num" type="text" ></td>
                        </tr>
						
                         	 <tr>
                            <th><i class="require-red"></i>管理员密码：</th>
                            <td><input name="password" type="password" /></td>
                        </tr>
					
                        <tr>
                            <th></th>
                            <td>
                                <input type="submit"  value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Link/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
						
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>


<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(1).show();
$(".sub-menu").eq(1).children("li").eq(1).addClass("on");
</script>

52:F:\git\coin\bisheng commerce\App\Admin\View\Currency\tibi_index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">提币记录</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Currency/tibi_index')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">会员账号:</th>
                            <td><input class="common-text" placeholder="关键字" name="email" type="text"></td>
							     <td><select name="cuid">
								 <volist name="curr" id='vo'>
								 	<option value="{$vo.currency_id}" <eq name="id" value="$vo['currency_id']">selected='selected'</eq>>{$vo.currency_name}</option>
								 </volist>
								 
								 
								 </select></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                      
                        <th>会员邮箱</th>
						<th>币种名称</th>
						<th>转入钱包地址</th>
                        <th>转出数量</th>
                        <th>实际数量</th>
                        <th>操作时间</th>
                     
                        <th>状态</th>
              
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                         
                            <td>{$vo['email']}</td>
							<td>{$vo['currency_name']}</td>
							<td>{$vo['url']}</td>
                            <td>{$vo['num']}</td>
                            <td>{$vo['actual']}</td>
							<td>{$vo['add_time']|date='Y-m-d H:i:s',###}</td>
                         
						
                            <td><if condition="$vo['status'] eq 0">
									等待转出...
								</if>
								<if condition="$vo['status'] eq 1">
									已完成
								</if>
								
								</td>
                          
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(8).show();
$(".sub-menu").eq(8).children("li").eq(2).addClass("on");
</script>

53:F:\git\coin\bisheng commerce\App\Admin\View\CurrencyUser\MemberQianbaoChongzhiUrl.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员钱包充值地址列表</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('CurrencyUser/MemberQianbaoChongzhiUrl')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">会员账号:</th>
                            <td><input class="common-text" placeholder="关键字" name="email" type="text"></td>
							     <td><select name="cuid">
								  	<option value="">全部</option>
								 <volist name="curr" id='vo'>
								
								 	<option value="{$vo.currency_id}" <eq name="id" value="$vo['currency_id']">selected='selected'</eq>>{$vo.currency_name}</option>
								 </volist>
								 
								 
								 </select></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                      
                        <th>会员邮箱</th>
						<th>币种名称</th>
						<th>充值钱包地址</th>
                     
              
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                         
                            <td>{$vo['email']}</td>
							<td>{$vo['currency_name']}</td>
							<td>{$vo['chongzhi_url']}</td>
                        
                          
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(8).show();
$(".sub-menu").eq(8).children("li").eq(3).addClass("on");
</script>

54:F:\git\coin\bisheng commerce\App\Admin\View\CurrencyUser\MemberQianbaoTibiUrl.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员钱包提币地址列表</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('CurrencyUser/MemberQianbaoTibiUrl')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">会员账号:</th>
                            <td><input class="common-text" placeholder="关键字" name="email" type="text"></td>
							     <td><select name="cuid">
								  	<option value="">全部</option>
								 <volist name="curr" id='vo'>
								
								 	<option value="{$vo.currency_id}" <eq name="id" value="$vo['currency_id']">selected='selected'</eq>>{$vo.currency_name}</option>
								 </volist>
								 
								 
								 </select></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                      
                        <th>会员邮箱</th>
						<th>币种名称</th>
						<th>提币钱包地址</th>
                     
              
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                         
                            <td>{$vo['email']}</td>
							<td>{$vo['currency_name']}</td>
							<td>{$vo['qianbao_url']}</td>
                        
                          
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(8).show();
$(".sub-menu").eq(8).children("li").eq(4).addClass("on");
</script>

55:F:\git\coin\bisheng commerce\App\Admin\View\Dividend\index.html

<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<div class="main-wrap">
	<div class="crumb-wrap">
		<div class="crumb-list">
			<i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span>
		</div>
	</div>
	<div class="result-wrap">
		<form action="{:U('Dividend/updateCofig')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
			<div class="config-items">
				<div class="config-title">
					<h1>
						<i class="icon-font">&#xe00a;</i>网站信息设置
					</h1>
				</div>
				<div class="result-content">
					<table width="100%" class="insert-tab">
						<tbody>
							<tr>
								<th><i class="require-red">*</i>分红股名称：
								</th>
								<td>
									<select name="dividend_id">
										<option value="0">无分红</option>
										<volist name="currency" id="vo">
											<option value="{$vo['currency_id']}" <eq name="config.dividend_id" value="$vo.currency_id">selected</eq>>{$vo['currency_name']}</option>
										</volist>
									</select>
									<span style="color:red;">分红股设置的币种是用户达到条件获得分红的币种,如不需要分红奖励设置分红股名称为无分红</span>
								</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>最少发行量：</th>
								<td><input type="text" id="" value="{$config.num1}"
									size="85" name="num1" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>{$config.num1}---发行量(万)：<br/>
									<i class="require-red">*</i>达到分红条件交易金额：<br/>
									<i class="require-red">*</i>每日做多获得奖励数：<br/>
									<i class="require-red">*</i>达到条件获得分红股数量（个）
								</th>
								<td><input type="text" id="" value="{$config.num2}"
									size="85" name="num2" class="common-text"><br/>
									<input type="text" id="" value="{$config.money1}"
									size="85" name="money1" class="common-text"><br/>
									<input type="text" id="" value="{$config.max1}"
									size="85" name="max1" class="common-text"><span style="color:red;">如果用户当日获得币数大于最大获得数量业绩也不会增加</span>
									<br/>
									<input type="text" id="" value="{$config.get1}"
									size="85" name="get1" class="common-text">
								</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>{$config.num2}(万)---发行量(万)：<br/>
									<i class="require-red">*</i>达到分红条件交易金额：<br/>
									<i class="require-red">*</i>每日做多获得奖励数：<br/>
									<i class="require-red">*</i>达到条件获得分红股数量（个）
								</th>
								<td><input type="text" id="" value="{$config.num3}"
									size="85" name="num3" class="common-text"><br/>
									<input type="text" id="" value="{$config.money2}"
									size="85" name="money2" class="common-text"><br/>
									<input type="text" id="" value="{$config.max2}"
									size="85" name="max2" class="common-text"><br/>
									<input type="text" id="" value="{$config.get2}"
									size="85" name="get2" class="common-text">
								</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>{$config.num3}(万)---发行量(万)：<br/>
									<i class="require-red">*</i>达到分红条件交易金额：<br/>
									<i class="require-red">*</i>每日做多获得奖励数：<br/>
									<i class="require-red">*</i>达到条件获得分红股数量（个）
								</th>
								<td><input type="text" id="" value="{$config.num4}"
									size="85" name="num4" class="common-text">
									<span style="color:red;">如果发行量超过系统设置发行量不会获得任何分红</span>
									<br/>
									<input type="text" id="" value="{$config.money3}"
									size="85" name="money3" class="common-text"><br/>
									<input type="text" id="" value="{$config.max3}"
									size="85" name="max3" class="common-text"><br/>
									<input type="text" id="" value="{$config.get3}"
									size="85" name="get3" class="common-text">
								</td>
							</tr>
							<tr>
								<th></th>
								<td><input type="submit" value="提交"
									class="btn btn-primary btn6 mr10"> <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</form>
	</div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(4).show();
$(".sub-menu").eq(4).children("li").eq(2).addClass("on");
</script>

56:F:\git\coin\bisheng commerce\App\Admin\View\Download\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <style>
	 .result-wrap{ font-size:14px;}
     .wid1{ width:180px;}
	 .wid2{ width:270px !important;}
	 .tablesty tr{ height:30px; line-height:30px;}
	 .ceshi{clear:both; padding-left:14px;}
    </style>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">下载管理</span></div>
        </div>
        <div class="result-wrap">
            <div class="result-content">
               	<span class="crumb-name">下载管理</span><br><br><br>
                <form action="{:U('Download/biaogeDownload')}" method="post" enctype="multipart/form-data">
                  <table class="tablesty">
                    <tbody>
                      <tr>
                        <td class="wid1">新币上线申请表上传：</td>
                        <td class="wid2">
                          <input style=" width:190px !important; float:left;" type='file' name='biaoge'>
                          <input class="btn-primary" style="width:40px !important; float:left;" type="submit" value="提交"></td>
                        <td class="wid1 ceshi"><a href='{$config.biaoge_url}'>测试</a></td>
                      </tr>
                    </tbody>
                  </table>
                
                </form>
               <br> <hr><br>
                <form action="{:U('Download/qianbaoDownload')}" method="post" enctype="multipart/form-data">
                  <table class="tablesty">
                    <tbody>
                      <volist name='list' id='vo'>
                      <tr>
                        <td class="wid1">{$vo.currency_name}钱包上传：</td>
                        <td class="wid2"><input type='file' name='{$vo.currency_id}'> </td>
                        <td class="wid1"><a href='{$vo.qianbao_url}'>测试钱包</a></td>
                      </tr>
                      </volist>
                      <tr>
                        <td><input class="btn-primary" style=" width:60px;" type="submit" value="提交"></td>
                      </tr>
                    </tbody>
                  </table>
                
                </form>
                <br> <hr><br>
                <form action="{:U('Download/guanwangUrl')}" method="post" enctype="multipart/form-data">
                  <table class="tablesty">
                    <tbody>
                      <volist name='list' id='vo'>
                      <tr>
                        <td class="wid1">{$vo.currency_name}官方网站： </td>
                        <td class="wid1"><input type="text" name="guanwang_url[{$vo.currency_id}]" value="{$vo.guanwang_url}"  style="width:300px;"/></td>
                        <input type="hidden" name="currency_id[]" value="{$vo.currency_id}" />
                      </tr>
                      </volist>
                      <tr>
                        <td><input class="btn-primary" style=" width:60px;" type="submit" value="提交"></td>
                      </tr>
                    </tbody>
                  </table>
                
                </form>
                 <br> <hr><br>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(8).show();
$(".sub-menu").eq(8).children("li").eq(5).addClass("on");
</script>

57:F:\git\coin\bisheng commerce\App\Admin\View\Examine\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="/jscss/admin">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">审核管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Examine/index')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">用户ID:</th>
                            <td><input class="common-text" placeholder="关键字" name="u_id" type="text"></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>ID</th>
                        <th>会员ID</th>
						<th>证件号码</th>
                        <th>身份证正面</th>
                        <th>身份证反面</th>
                        <th>手持身份证</th>
                        <th>申请时间</th>
						<th>审核通过时间</th>
                        <th>状态</th>
						<th>审核人员</th>
                        <th>操作</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['id']}</td>
                            <td>{$vo['u_id']}</td>
							<td>{$vo['idcard']}</td>
                            <td><img height="70px;" width="150px;" src="{$vo['idcardpositive']}" /></td>
                            <td><img height="70px;" width="150px;" src="{$vo['idcardside']}" /></td>
                            <td><img height="70px;" width="150px;" src="{$vo['idcardhold']}" /></td>
                            <td>{$vo['add_time']|date='Y-m-d H:i:s',###}</td>
							<td>{$vo['examine_time']?$vo['examine_time']|date='Y-m-d H:i:s',###:"未审核"}</td>
                            <td><if condition="$vo['status'] eq 0">
									<span>审核中</span>
								</if>
								<if condition="$vo['status'] eq 1">
								<span style="color:#00FF00">审核通过</span>
								</if>
								<if condition="$vo['status'] eq 2">
									<span style="color:#FF0000">审核未通过</span>
								</if>
								</td>
								<td>{$vo['examine_name']}</td>
                            <td>	
                                <a class="link-update" href="{:U('Examine/saveExamine',array('id'=>$vo['id']))}">查看</a>
                       </td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(3).addClass("on");
</script>

58:F:\git\coin\bisheng commerce\App\Admin\View\Examine\saveExamine.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="/think/admin">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">审核</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Examine/saveExamine')}" method="post" >
            <div class="config-items">
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
						
                        <tr>
                            <th width="15%">用户Id：</th>
                            <td>{$list['u_id']}</td>
                        </tr>				
						<tr>
                             <th>身份证号：</th>
            				 <td>{$list['idcard']}</td>
                        </tr> 
                           
                            
                        <tr>
                            <th>身份证正面图片：</th>
                            <td><img src="{$list['idcardpositive']}" /></td>
                        </tr>
                        <tr>
                            <th>身份证反面：</th>
                            <td><img src="{$list['idcardside']}" /></td>
                        </tr>
                        <tr>
                            <th>手持身份证：</th>
                            <td><img src="{$list['idcardhold']}" /></td>
                        </tr>
							 <tr>
                                <th>申请时间：</th>
                                <td>{$list['add_time']|date='Y-m-d H:i:s',###}</td>
                            </tr>
                        <tr>
						</tr>
						<if condition="$list['status'] neq 0 ">
						<tr>
                                <th>审核结果时间：</th>
                                <td>{$list['examine_time']?$list['examine_time']|date='Y-m-d H:i:s',###:"未审核"}</td>
                            </tr>
                        <tr>
						</if>
						</tr>
							 <tr>
                                <th>审核人员：</th>
                                <td>{$list['examine_name']}</td>
                            </tr>
                        <tr>
						 <tr>
                                <th>状态</th>
                                <td>
								<if condition="$list['status'] eq 0 ">
									<input type="radio" value="0"  name="status" checked="checked" />审核中
									<input type="radio" value="1"  name="status" /><span style="color:#00FF00">审核通过</span>
									<input type="radio" value="2"  name="status" /><span style="color:#FF0000">审核未通过</span>
									<elseif condition="$list['status'] eq 1"/> 
									<input type="radio" value="1"  name="status" checked="checked"  /><span style="color:#00FF00">审核通过</span>
									<else/>
									<input type="radio" value="2"  name="status" checked="checked" /><span style="color:#FF0000">审核未通过</span>
								</if>
								</td>				
                            </tr>
                            <th></th>
							<input type="hidden"  name="id" value="{$list['id']}"/>
                            <td>
								<if condition="$list['status'] eq 0">
									<input type="submit" value="提交" class="btn btn-primary btn6 mr10">
								</if>
                                <a href="{:U('Examine/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>

<!--/main-->
</div>
</body>
</html>

59:F:\git\coin\bisheng commerce\App\Admin\View\Fileconfigoperation\saveDb.html

<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<style>
.tab1 th{ width:225px;}
</style>
<div class="main-wrap">
	<div class="crumb-wrap">
		<div class="crumb-list">
			<i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span>
		</div>
	</div>
	<div class="result-wrap">
		<form action="{:U('Fileconfigoperation/saveDbPrefix')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
			<div class="config-items">
				<div class="config-title">
					<h1>
						<i class="icon-font">&#xe00a;</i>数据库表前缀配置管理
					</h1>
				</div>
				<div class="result-content">
					<table width="100%" class="insert-tab">
						<tbody>
							<tr>
								<th><i class="require-red">*</i>数据库类型：</th>
								<td>mysql</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>现数据库表前缀：</th>
								<td>{:C('DB_PREFIX')}</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>数据表前缀：</th>
								<td><input type="text" id="" value="" size="85"
									name="DB_PREFIX" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>注意：</th>
								<td><span style="font-size: 15px;color: red;">数据库配置请谨慎修改,修改后自动更改为最新口令(自动修改MySql数据库表前缀)</span></td>
							</tr>
							<tr>
								<th></th>
								<td><input type="submit" onclick="return confirm('您确定当前操作？')"  value="提交"
									class="btn btn-primary btn6 mr10"> <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</form>
		<form action="{:U('Fileconfigoperation/saveDbPwd')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
			<div class="config-items">
				<div class="config-title">
					<h1>
						<i class="icon-font">&#xe00a;</i>数据密码管理
					</h1>
				</div>
				<div class="result-content">
					<table width="100%" class="insert-tab tab1">
						<tbody>
							<tr>
								<th><i class="require-red">*</i>数据库类型：</th>
								<td>mysql</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>数据库账号：</th>
								<td>{:C('DB_USER')}</td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>数据库密码：</th>
								<td><input type="password" id="" value="" size="85"
									name="DB_PWD" class="common-text"></td>
							</tr>
							
							<tr>
								<th><i class="require-red">*</i>注意：</th>
								<td><span style="font-size: 15px;color: red;">数据库配置请谨慎修改,修改后自动更改为最新口令(先在后台配置,在手动修改MySql数据库密码)</span></td>
							</tr>
							<tr>
								<th></th>
								<td><input type="submit"  onclick="return confirm('您确定当前操作？')" value="提交"
									class="btn btn-primary btn6 mr10"> <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</form>
	</div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(0).show();
$(".sub-menu").eq(0).children("li").eq(6).addClass("on");
</script>

60:F:\git\coin\bisheng commerce\App\Admin\View\Fileconfigoperation\saveEntrance.html

<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<div class="main-wrap">
	<div class="crumb-wrap">
		<div class="crumb-list">
			<i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">系统设置</span>
		</div>
	</div>
	<div class="result-wrap">
		<form action="{:U('Fileconfigoperation/saveEntrance')}" method="post" id="myform"
			name="myform" enctype="multipart/form-data">
			<div class="config-items">
				<div class="config-title">
					<h1>
						<i class="icon-font">&#xe00a;</i>后台入口配置管理
					</h1>
				</div>
				<div class="result-content">
					<table width="100%" class="insert-tab">
						<tbody>
							<tr>
								<th><i class="require-red">*</i>后台入口设置：</th>
								<td><input type="text" id="" value="" size="85"
									name="URL_MODULE_MAP" class="common-text"></td>
							</tr>
							<tr>
								<th><i class="require-red">*</i>注意：</th>
								<td><span style="font-size: 15px;color: red;">后台地址请谨慎修改,修改后自动更改为最新入口路径</span></td>
							</tr>
							<tr>
								<th></th>
								<td><input type="submit" onclick="return confirm('您确定当前操作？')"  value="提交"
									class="btn btn-primary btn6 mr10"> <input type="button"
									value="返回" onclick="history.go(-1)" class="btn btn6"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</form>
	</div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(0).show();
$(".sub-menu").eq(0).children("li").eq(5).addClass("on");
</script>

61:F:\git\coin\bisheng commerce\App\Admin\View\Finance\count.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">财务明细</span></div>
        </div>
        <div class="search-wrap">
        </div>
        <div class="result-wrap">
             <table class="result-tab" width="100%">
                <tr>
                    <td>人工充值人民币总额</td>
                    <td>{$pay|default='0.00'}</td>
                    <td>管理员充值人民币总额</td>
                    <td>{$pay_admin|default='0.00'}</td>
                </tr>
                <tr>
                    <td>提现成功总额</td>
                    <td>{$draw|default='0.00'}</td>
                    <td>会员持有人民币总额</td>
                    <td>{$rmb|default='0.00'}</td>
                </tr>
                <volist name="currency_user" id="vo">
                <tr>
                    <td>会员持{$vo.name|default='数字币'}币可用总额</td>
                    <td>{$vo.num|default='0.00'}</td>
                    <td>会员持{$vo.name|default='数字币'}币冻结总额</td>
                    <td>{$vo.forzen_num|default='0.00'}</td>
                </tr>
                </volist>
            </table>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(2).addClass("on");
</script>

62:F:\git\coin\bisheng commerce\App\Admin\View\Finance\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">财务日志</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/index')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="type_id" id="">
											<option value="0">全部</option>
											<volist name='type' id='vo'>
											<option value="{$vo.id}">{$vo.name}</option>
											</volist>
										</select>
									</td>
									<th width="70">用户:</th>
									<td><input class="common-text" placeholder="用户" name="name" value="{$get.name}" id="" type="text"></td>
                                    <th width="70">用户ID:</th>
									<td><input class="common-text" placeholder="用户ID" name="member_id" value="{$get.name}" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
                                 </tr>
                                 <tr>   
                                    <th><i class="require-red">*</i>开始时间：</th>
                                    <td>
                            
                                    <div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="add_time" class="ui_timepicker" id="aaaaa1" placeholder="选择日期时间" value="{$list.add_time|date='Y-m-d H:i:s',###}"  />
                                                </div></div></td>
                                  <script type="text/javascript">
                                    $(function () {
                                        $("#aaaaa1").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                            $("#aaaaa2").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                   
                                    })
                                </script>
                                    <th><i class="require-red">*</i>截止时间：</th>
                                    <td><div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="end_time" class="ui_timepicker" id="aaaaa2" placeholder="选择日期时间" value="{$list.end_time|date='Y-m-d H:i:s',###}" / >
                                                </div></div></td>
									<td><input class="btn btn-primary btn2" name="sub" value="下载表格" type="button" onclick="download()"></td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>日志编号</th>
                            <th>所属</th>
                            <th>财务类型</th>
                            <th>内容</th>
                            <th>金额</th>
                            <th>币种</th>
							<th>收入/支出</th>
                            <th>时间</th>
                            <th>操作</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.finance_id}</td>
                            <td>{$vo.username}</td>
                            <td>{$vo.typename}</td>
                            <td>{$vo.content}</td>
                            <td>{$vo.money}</td>
                            <td>{$vo.currency_name}</td>
							<td><eq name='vo.money_type' value='1'>收入<else/>支出</eq></td>
                            <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                            <td>
							</td>
                        </tr>
                        </volist>
                    </table>
					<div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(2).addClass("on");
</script>
<script>
function download(){
	var add_time=$('#aaaaa1').val();
	var end_time=$('#aaaaa2').val();
	var url="{:U('Finance/derivedExcel')}";
	window.location.href=url+"?add_time="+add_time+"&&end_time="+end_time;
}
</script>

63:F:\git\coin\bisheng commerce\App\Admin\View\Flash\add.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href=":U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">VIP设置</span></div>
        </div>
        <div class="result-wrap">
            <form action="{:U('Flash/add')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
                <div class="config-items">
                    <div class="config-title">
                        <h1><i class="icon-font">&#xe00a;</i>VIP详细信息设置</h1>
                    </div>
                    <div class="result-content">
                        <table width="100%" class="insert-tab">
                            <tbody>
                            <tr>
                                <th width="15%"><i class="require-red">*</i>幻灯图片：</th>
                                <td><img style="width:400px;" src="{$flash.pic}"><input type="hidden" name="pic" value="{$flash.pic}" class="common-text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>幻灯图片上传：</th>
                                <td><input type="file" name="Filedata" class="common-text"></td>
                            </tr>
                            <tr>
                                    <th><i class="require-red">*</i>图片标题：</th>
                                    <td><input type="text" id="" value="{$flash.title}" size="85" name="title" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>排序：</th>
                                    <td><input type="text" id="" value="{$flash.sort}" size="85" name="sort" class="common-text"><input type="hidden" id="" value="{$flash.flash_id}" size="85" name="flash_id" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>跳转地址：</th>
                                    <td><input type="text" id="" value="{$flash.jump_url}" size="85" name="jump_url" class="common-text"></td>
                                </tr>
                                
                             
                                <tr>
                                    <th></th>
                                    <td>
                                        <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                        <a href="{:U('Flash/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                                    </td>
                                </tr>
                            </tbody></table>
                    </div>
                </div>
                
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(2).show();
$(".sub-menu").eq(2).children("li").eq(0).addClass("on");
</script>

64:F:\git\coin\bisheng commerce\App\Admin\View\Flash\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href=":U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">幻灯管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
            </div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-title">
                    <div class="result-list">
                        <a href="{:U('Flash/add')}"><i class="icon-font"></i>新增幻灯</a>
                    </div>
                </div>
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>图片</th>
                            <th>网址</th>
                            <th>标题</th>
                            <th>排序</th>
                            <th>更新时间</th>
                            <th>操作</th>
                        </tr>
                        <volist name="flash" id="vo" empty="$empty">
                        <tr>
                            <td><notempty name="vo.pic"><img style=" width:400px; padding-left:120px;" src='{$vo.pic}' /><else/>暂无图片数据</notempty></td>
                            <td>{$vo.jump_url}</td>
                            <td>{$vo.title}</td>
                            <td>{$vo.sort}</td>
                            <td>{$vo.add_time|date="Y-m-d",###}</td>
                            <td>
                                <a class="link-update" href="{:U('Flash/add',array('flash_id'=>$vo['flash_id']))}">修改</a>
                                <a class="link-del" href="{:U('Flash/del',array('flash_id'=>$vo['flash_id']))}">删除</a>
                            </td>
                        </tr>
                        </volist>
                    </table>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(2).show();
$(".sub-menu").eq(2).children("li").eq(0).addClass("on");
</script>

65:F:\git\coin\bisheng commerce\App\Admin\View\Index\index.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->

<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i>首页</div>
    </div>
    <div class="result-wrap">
        <div class="result-title">
            <h1>快捷操作</h1>
        </div>
        <div class="result-content">
            <div class="short-wrap">
                <li>当前登录管理员：{$admin_user.name|default='admin'}</li>
            </div>
        </div>
    </div>
    <!--<div class="result-wrap">-->
        <!--<div class="result-title">-->
            <!--<h1>当前币种信息</h1>-->
        <!--</div>-->
        <!--<div class="result-content">-->
            <!--<table class="result-tab" width="100%">-->
                <!--<tr>-->
                    <!--<th>货币LOGO</th>-->
                    <!--<th>货币名称</th>-->
                    <!--<th>英文标识</th>-->
                    <!--<th>总市值</th>-->
                    <!--<th>钱包余额</th>-->
                    <!--<th>最新价格</th>-->
                    <!--<th>昨日价格</th>-->
                    <!--<th>24H交易量</th>-->
                    <!--<th>全站交易量</th>-->
                    <!--<th>操作</th>-->
                <!--</tr>-->
                <!--<volist name="list" id="vo" empty="$empty">-->
                    <!--<tr>-->
                        <!--<td><notempty name="vo.currency_logo"><img  style="height:40px;"src='{$vo.currency_logo}' /><else/>暂无图片数据</notempty></td>-->
                        <!--<td>{$vo.currency_name|default='暂无'}</td>-->
                        <!--<td>{$vo.currency_mark|default='暂无'}</td>-->
                        <!--<td>￥{$vo.currency_all_money|default='0.00'}</td>-->
                        <!--<td>{$vo.balance|default='0.00'}</td>-->
                        <!--<td>{$vo.new_price|default='0.00'}</td>-->
                        <!--<td>{$vo.old_price|default='0.00'}</td>-->
                        <!--<td>{$vo.24H_done_num|default='0.00'}</td>-->
                        <!--<td>{$vo.all_done_num|default='0.00'}</td>-->
                        <!--<td>-->
                            <!--<a class="link-update" href="{:U('Currency/add',array('currency_id'=>$vo['currency_id']))}">查看币种信息</a><br>-->
                            <!--<a class="link-update" href="{:U('Trade/trade',array('currency_id'=>$vo['currency_id']))}">查看交易记录</a><br>-->
                            <!--<a class="link-update" href="{:U('Trade/orders',array('currency_id'=>$vo['currency_id']))}">查看委托记录</a>-->
                        <!--</td>-->
                    <!--</tr>-->
                <!--</volist>-->
            <!--</table>-->
        <!--</div>-->
    <!--</div>-->
    <!--<div class="result-wrap">-->
        <!--<div class="result-title">-->
            <!--<h1>全站统计信息</h1>-->
        <!--</div>-->
        <!--<div class="result-content">-->
            <!--<table class="result-tab" width="100%">-->
                <!--<tr>-->
                    <!--<td>网站总收入</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                    <!--<td>网站总支出</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                <!--</tr>-->
                <!--<tr>-->
                    <!--<td>会员总人数</td>-->
                    <!--<td>{$member|default='0'}人</td>-->
                    <!--<td>众筹总数量</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                <!--</tr>-->
                <!--<tr>-->
                    <!--<td>人民币收入</td>-->
                    <!--<td>￥{$a|default='0'}</td>-->
                    <!--<td>人民币支出</td>-->
                    <!--<td>￥{$a|default='0'}</td>-->
                <!--</tr>-->
                <!--<tr>-->
                    <!--<td>{$config.xnb}收入</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                    <!--<td>{$config.xnb}支出</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                <!--</tr>-->
                <!--<tr>-->
                    <!--<td>充值数量</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                    <!--<td>提现数量</td>-->
                    <!--<td>{$a|default='0'}</td>-->
                <!--</tr>-->
            <!--</table>-->
        <!--</div>-->
    <!--</div>-->
    <div class="result-wrap">
        <div class="result-title">
            <h1>服务器信息</h1>
        </div>
        <div class="result-content">
            <table class="result-tab" width="100%">
                <tr>
                    <td width="20%">系统版本</td>
                    <td width="20%">{:php_uname('r')}</td>
                    <td width="20%">服务器操作系统</td>
                    <td width="40%">{:php_uname('s')}</td>
                </tr>
                <tr>
                    <td>运行环境</td>
                    <td>{:php_sapi_name()}</td>
                    <td>PHP版本</td>
                    <td>{:PHP_VERSION}</td>
                </tr>
                <tr>
                    <td>MySql版本</td>
                    <td>{:mysqlnd}</td>
                    <td>服务器IP</td>
                    <td>{:GetHostByName($_SERVER['SERVER_NAME'])}</td>
                </tr>
                <tr>
                    <td>你的IP</td>
                    <td>{:$_SERVER['REMOTE_ADDR']}</td>
                    <td>服务器端口</td>
                    <td>{:$_SERVER['SERVER_PORT']}</td>
                </tr>
                <tr>
                    <td>绝对路径</td>
                    <td>{:$_SERVER['DOCUMENT_ROOT']}</td>
                    <td>网站域名</td>
                    <td>{:$_SERVER['SERVER_NAME']}</td>
                </tr>
                <tr>
                    <td>清理缓存</td>
                    <td><input type="button" id="button" value="清理缓存"/></td>
                    <input type="hidden" id="type" value="Runtime-Cache"/>
                    <td>网站开发</td>
                    <td><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=275043418&site=qq&menu=yes"><img border="0" src="__PUBLIC__/Admin/images/QQ.png" alt="点击这里给我发消息" title="点击这里给我发消息"/></a></td>
                </tr>
                <tr>
                    <td>官网地址</td>
                    <td>{:$_SERVER['SERVER_NAME']}</td>
                    <td>版权所有</td>
                    <td>{:$config['copyright']}</td>
                </tr>
            </table>
        </div>
    </div>
    <script>
        $(function(){
            $('#button').click(function(){
                if(confirm("确认要清除缓存？")){
                    var $type=$('#type').val();
                    $.post("{:U('Index/cache')}",{type:$type},function(data){
                        alert("缓存清理成功");
                    });
                }else{
                    return false;
                }});
        });
    </script>
</div>
<!--/main-->
</div>
</body>
</html>

66:F:\git\coin\bisheng commerce\App\Admin\View\Index\infoStatistics.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">全站统计信息</span></div>
    </div>
    <div class="result-wrap">
        <div class="result-content">
        </div>
    </div>
    <div class="result-wrap">
        <div class="result-title">
            <h1>全站统计信息</h1>
        </div>
        <div class="result-content">
            <table class="result-tab" width="100%">
                <tr>
                    <td>会员总人数</td>
                    <td>{$member|default='0'}人</td>
                    <td>众筹总数量</td>
                    <td>{$issue_count['count']|default='0'}</td>
                </tr>
                <tr>
                    <td>人民币收入</td>
                    <td>￥{$pay_money_count|default='0'|floatval=###}</td>
                    <td>人民币支出</td>
                    <td>￥{$withdraw_money_count|default='0'|floatval=###}</td>
                </tr>
                <tr>
                    <td>充值单数</td>
                    <td>{$pay_count|default='0'}单</td>
                    <td>提现单数</td>
                    <td>{$withdraw_count|default='0'}单</td>
                </tr>
            </table>
            <div class="result-title">
                <h1>全站币种统计</h1>
            </div>
            <table class="result-tab" width="70%" style="text-align: center;margin-left: 130px;">
                <tr>
                    <td>币种名</td>
                    <td>可用</td>
                    <td>冻结</td>
                    <td>总数</td>
                </tr>
                <volist name="currency_u_info" id="vo">
                    <tr>
                        <td>{$vo['currency_name']}</td>
                        <td>{$vo['num']|floatval=###}</td>
                        <td>{$vo['forzen_num']|floatval=###}</td>
                        <td>{$vo['num']+$vo['forzen_num']|floatval=###}</td>
                    </tr>
                </volist>

            </table>
        </div>
    </div>
    <script>
        $(function(){
            $('#button').click(function(){
                if(confirm("确认要清除缓存？")){
                    var $type=$('#type').val();
                    $.post("{:U('Index/cache')}",{type:$type},function(data){
                        alert("缓存清理成功");
                    });
                }else{
                    return false;
                }});
        });
    </script>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(2).show();
$(".sub-menu").eq(2).children("li").eq(2).addClass("on");
</script>

67:F:\git\coin\bisheng commerce\App\Admin\View\index.html
 

68:F:\git\coin\bisheng commerce\App\Admin\View\Link\add.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">添加链接</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Link/add_link')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>添加链接</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                    	<notempty name="list">
						
						</notempty>
                        <tr>
                            <th><i class="require-red"></i>链接名称：</th>
                            <td><input name="name" type="text" value="{$list['name']}"></td>
                        </tr>
						 <tr>
                            <th><i class="require-red"></i>链接地址：</th>
                            <td><input name="url" type="text" value="{$list['url']}"></td>
                        </tr>
						
                         <tr>
                            <th><i class="require-red"></i>链接状态：</th>
                            <td><input name="status" type="radio"  value="1" <eq name="list.status" value = '1'>checked="checked"</eq> >启用
								<input name="status" type="radio" value="0" <eq name="list.status" value = '0'>checked="checked"</eq>  >禁用
							</td>
                        </tr>
						        <notempty name="list">
						  <tr>
                            <th><i class="require-red"></i>添加时间：</th>
                            <td>{$list.add_time|date="Y-m-d H:i:s",###}
							</td>
                        </tr>

            	 	   <input type="hidden" name="id" value="{$list['id']}" />
							</notempty>
                        <tr>
                            <th></th>
                            <td>
                                <input type="submit"  value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Link/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
						
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>


<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(2).show();
$(".sub-menu").eq(2).children("li").eq(2).addClass("on");
</script>

69:F:\git\coin\bisheng commerce\App\Admin\View\Link\index.html
     <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">友情链接</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                    <a href="{:U('Link/add')}"><i class="icon-font"></i>新增链接</a>
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>ID</th>
                        <th>链接名称</th>
						<th>链接地址</th>
                       
						<th>添加时间</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['id']}</td>
                            <td>{$vo['name']}</td>
							<td>{$vo['url']}</td>
                            
                       
							<td>{$vo['add_time']|date='Y-m-d H:i:s',###}</td>
                            <td><if condition="$vo['status'] eq 1">
									启用
								</if>
								<if condition="$vo['status'] eq 0">
									禁用
								</if>
							
								</td>
                            <td>
                                <a class="link-update" href="{:U('Link/add',array('id'=>$vo['id']))}">修改</a>
                                <a class="link-del" href="{:U('Link/del',array('id'=>$vo['id']))}" onclick="return confirm('确确认删除吗？')">删除</a>
                            </td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(2).show();
$(".sub-menu").eq(2).children("li").eq(1).addClass("on");
</script>

70:F:\git\coin\bisheng commerce\App\Admin\View\Login\login.html
<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>网站后台管理</title>
    <link href="__PUBLIC__/Admin/css/admin_login.css" rel="stylesheet" type="text/css" />
<style>
body{background-image:url(/public/admin/images/adminbg.jpg);background-size:cover;background-repeat: repeat;}
</style>
</head>
<body>
<div class="admin_login_wrap">
    <h1>后台登录</h1>
    <div class="adming_login_border">
        <div class="admin_input">
            <form action="{:U('Login/checkLogin')}" method="post">
                <ul class="admin_items">
                    <li>
                        <label for="user">用户名：</label>
                        <input type="text" name="username" value="admin" id="user" size="40" class="admin_input_style" />
                    </li>
                    <li>
                        <label for="pwd">密码：</label>
                        <input type="password" name="pwd" value="123456" id="pwd" size="40" class="admin_input_style" />
                    </li>
                    <li>
                        <input type="submit" tabindex="3" value="提交" class="btn btn-primary" />
                    </li>
                </ul>
            </form>
        </div>
    </div>
    
</div>
</body>
</html>

71:F:\git\coin\bisheng commerce\App\Admin\View\Manage\addAdmin.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">管理员管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Manage/addAdmin')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>管理员信息设置</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>管理员名称：</th>
                            <td><input name="username" id="" value="{$list.username}" type="text">
                            	<input name="admin_id" id="" value="{$list.admin_id}" type="hidden"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                      	<tr>
                            <th width="15%"><i class="require-red">*</i>管理员密码：</th>
                            <td><input name="pwd_show" id="" value="{$list.pwd_show}" type="text" readonly><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>管理员密码修改：</th>
                            <td><input name="password" id="" value="" type="password"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span>（为空则不修改）</td>
                        </tr>
                        <tr>
                            <th></th>
                            <td>
                                <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Manage/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>

<!--/main-->
</div>
</body>
</html>

72:F:\git\coin\bisheng commerce\App\Admin\View\Manage\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">管理员管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Manage/index')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">管理员:</th>
                            <td><input class="common-text" placeholder="管理员" name="username" type="text"></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                    <a href="{:U('Manage/addAdmin')}"><i class="icon-font"></i>新增管理员</a>
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>ID</th>
                        <th>管理员名称</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['admin_id']}</td>
                            <td>{$vo['username']}<eq name="vo.nav" value="">&nbsp;（此账号尚未分配权限）</eq></td>
                            <td><eq name='vo.status' value='0'>可用<else/>停用</eq></td>
                            <td>
                                <a class="link-update" href="{:U('Manage/addAdmin',array('admin_id'=>$vo['admin_id']))}">修改信息</a>
                                <a class="link-update" href="{:U('Manage/showNav',array('admin_id'=>$vo['admin_id']))}">修改权限</a>
                                <eq name='vo.admin_id' value='1'><else/><a class="link-del" href="{:U('Manage/delMember',array('admin_id'=>$vo['admin_id']))}" onclick="return confirm('确认删除吗？')">删除</a></eq>
                            </td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(10).show();
$(".sub-menu").eq(10).children("li").eq(0).addClass("on");
</script>

73:F:\git\coin\bisheng commerce\App\Admin\View\Manage\pwdUpdate.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">管理员管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Manage/pwdUpdate')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>管理员信息设置</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>管理员名称：</th>
                            <td>
                                {$list.username}
                            </td>
                        </tr>
                      	<tr>
                            <th width="15%"><i class="require-red">*</i>原始密码：</th>
                            <td><input name="old_pwd" id="" value="" type="password" ><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>新密码：</th>
                            <td><input name="password" id="" value="" type="password"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                        <tr>
                            <th></th>
                            <td>
                                <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Manage/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>

<!--/main-->
</div>
</body>
</html>

74:F:\git\coin\bisheng commerce\App\Admin\View\Manage\showNav.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
  <div class="crumb-wrap">
    <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">权限管理</span></div>
  </div>
  <div class="search-wrap">
      <div class="config-title">
          <h1>&nbsp;&nbsp;&nbsp;<i class="icon-font">&#xe00a;</i>管理员信息设置</h1>
      </div>
  </div>
  <div class="result-wrap">
    <form action="{:U('Manage/saveNav')}" method="post">
      <div class="config-items">
        <div class="result-content">
          权限列表：
          <table width="100%" class="result-tab">
            <input type="hidden" value="{$id}" name="admin_id" />
            <tbody>
              <tr>
              <volist name='nav' id='vo' key='key'>
              
                  <td><input name="nav[]" type="checkbox" value="{$vo.nav_id}" class="xuanzhong" <eq name="vo.status" value="1">checked="checked"</eq> />{$vo.nav_name}
                  </td>
              <if condition="$key%4==0">
            	</tr><tr>
           	  </if>
              </volist>
              </tr>
                <tr><td colspan="4" style="text-align:center;">
                <input type="button" value="全选" onclick="quanxuan()">
                <input type="button" value="全不选" onclick="buxuan()">
                <input type="submit" value="确认"></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </form>
  </div>
</div>
<script>
	function quanxuan(){
		$(".xuanzhong").prop("checked",true);
	}
	function buxuan(){
		$(".xuanzhong").prop("checked",false);
	}
</script>
<!--/main-->
</div>
</body></html>

75:F:\git\coin\bisheng commerce\App\Admin\View\Member\addMember.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Member/addMember')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>会员用户添加</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>电子邮件：</th>
                            <td><input name="email" id="email" type="text"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>登录密码：</th>
                            <td><input id="pwd" name="pwd" type="password"></td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>重复密码：</th>
                            <td><input id="repwd" name="repwd" type="password"></td>
                        </tr>
                        <tr>
                            <th><i class="require-red"></i>邀请码：</th>
                            <td><input name="pid" type="text"></td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>交易密码：</th>
                            <td><input id="pwdtrade" name="pwdtrade" type="password"></td>
                        </tr>

                        <tr>
                            <th><i class="require-red">*</i>重复交易密码：</th>
                            <td><input id="repwdtrade" name="repwdtrade" type="password"></td>
                        </tr>
                        <tr>
                            <th></th>
                            <td>
                                <input type="button" onclick="subform()" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Member/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
ckemail = 0;
$('#email').blur(function(){
	var path_Email = "{:U('Member/ajaxCheckEmail')}";
	$.ajax({
		type:"get",
		dataType:"json",
		data:{email:$('#email').val()},
		url:path_Email,
		success:function(d){
				if(d['status']==0){
					$('#showBug').html(d['msg']);
					$('#email').focus();
					return false;
				}else{
					$('#showBug').html(d['msg']);
					return ckemail = 1 ;
				}
			},
		});
});
function subform(){
	if(ckemail==1){
		$('#myform').submit();
	}else{
		$('#email').focus();
	}
}
</script>

<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(1).addClass("on");
</script>

76:F:\git\coin\bisheng commerce\App\Admin\View\Member\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Member/index')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <td width="70">会员账号:</td>
                            <td><input class="common-text" placeholder="关键字" name="email" type="text"></td>
                              <td width="70">会员ID:</td>
                            <td><input class="common-text" placeholder="ID" name="member_id" type="text"></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                    <a href="{:U('Member/addMember')}"><i class="icon-font"></i>新增会员</a>
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>ID</th>
                        <th>会员邮箱</th>
						<th>推荐人</th>
                        <th>会员姓名</th>
                        <th>手机号</th>
                        <th>账户余额</th>
                        <th>冻结金钱</th>
						<th>注册时间</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['member_id']}</td>
                            <td>{$vo['email']}</td>
							<td>{$vo['pid']}</td>
                            <td>{$vo['name']}</td>
                            <td>{$vo['phone']}</td>
                            <td>{$vo['rmb']}</td>
                            <td>{$vo['forzen_rmb']}</td>
							<td>{$vo['reg_time']|date='Y-m-d H:i:s',###}</td>
                            <td><if condition="$vo['status'] eq 1">
									正常
								</if>
								<if condition="$vo['status'] eq 2">
									禁用
								</if>
								<if condition="$vo['status'] eq 0">
									未填写个人信息(<a href="{:U('Member/saveModify',array('member_id'=>$vo['member_id']))}">填写</a>)
								</if>
								</td>
                            <td>
                                <a class="link-del" href="{:U('Finance/index',array('member_id'=>$vo['member_id']))}">查看财务日志</a>
                                <br>
                                <a class="link-del" href="{:U('Member/show_my_invit',array('member_id'=>$vo['member_id']))}">查看邀请人员</a><br>
                                <a class="link-update" href="{:U('Member/saveMember',array('member_id'=>$vo['member_id']))}">修改|</a>
                                <a class="link-del" href="{:U('Member/delMember',array('member_id'=>$vo['member_id']))}" onclick="return confirm('确认删除吗？')">删除</a>
                                <a class="link-update" href="{:U('Member/show',array('member_id'=>$vo['member_id']))}">查看会员账户</a>
                            </td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(0).addClass("on");
</script>

77:F:\git\coin\bisheng commerce\App\Admin\View\Member\saveMember.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员管理</span></div>
    </div>
    <div class="result-wrap">

        <form action="{:U('Member/saveMember')}" method="post"  enctype="multipart/form-data">
            <div class="config-items">
                <div class="result-content">
                    <table width="100%" class="insert-tab">
					<input type="hidden" value="{$list['member_id']}" name="member_id" />
                        <tbody>
                        <tr>
                            <th width="15%">电子邮件：</th>
                            <td>{$list['email']}</td>
                        </tr>				
						<tr>
                             <th>头像上传：</th>
            				 <td><input type="file" name="head"  style="width:200px;" />
									<img src="{$list['head']}" style="width:50px;height:auto" />
									<input type="hidden" name="headold" value="{$list['head']}" />
							</td>
                        </tr>		
                        <tr>
                            <th> 登录密码：</th>
                            <td><input id="pwd" name="pwd" type="password">
							<span id="showBug" style=" margin-left:10px;color:#FF0000">为空则不修改</span></td>
                        </tr>
                        <tr>
                            <th> 邀请码：</th>
                            <td>{$list['pid']}</td>
                        </tr>
                        <tr>
                            <th> 交易密码：</th>
                            <td><input id="pwdtrade" name="pwdtrade" type="password">
							<span id="showBug" style=" margin-left:10px;color:#FF0000">为空则不修改</span></td>
                        </tr>
						<tr>
                            <th> 金额：</th>
                            <td><input name="rmb" value="{$list['rmb']}" type="text"></td>
                        </tr>
						
						<tr>
                            <th> 冻结金额：</th>
							<td><input name="forzen_rmb" value="{$list['forzen_rmb']}" type="text"></td>
                        </tr>
						<if condition="$list['status']!=0 ">
                            <tr>
                                <th>昵称：</th>
                                <td><input name="nick" id="nick" value="{$list['nick']}" type="text"></td>
                            </tr>
                            <tr>
                                <th> 真实姓名：</th>
                                <td><input name="name" id="name" value="{$list['name']}" onkeyup="value=value.replace(/[^\D]/g,'');" autocomplete="off" maxlength="8" type="text"></td>
                            </tr>
                            <tr>
                                <th> 证件类型：</th>
                                <td>
                                    <select id="cardtype" name="cardtype">
                                        <option value="1"<if condition="$list['cardtype'] eq 1">selected="selected"</if>>身份证</option>
                                        <option value="2" <if condition="$list['cardtype'] eq 2">selected="selected"</if>>护照</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th> 证件号码：</th>
                                <td><input name="idcard" id="idcard" value="{$list['idcard']}" type="text"></td>
                            </tr>
                            <tr>
                                <th> 手机号码：</th>
                                <td><input name="phone" id="mo" value="{$list['phone']}" type="text"></td>
                            </tr>	
							</if>						
							 <tr>
                                <th> 注册Ip：</th>
                                <td>{$list['ip']}<span style="margin-left:20px;">时间： {$list['reg_time']|date='Y-m-d H:i:s',###}</span></td>
                            </tr>
							 <tr>
                                <th>最后一次登录Ip：</th>
                                <td>{$list['login_ip']?$list['login_ip']:'未登录'}<span style="margin-left:20px;">时间： {$list['login_time']?$list['login_time']:''|date='Y-m-d H:i:s',###}</span></td>
                            </tr>
                        <tr>
						 <tr>
                                <th>状态</th>
                                <td>
								<input type="radio" value="0" <if condition="$list['status'] eq 0">checked="checked"</if> name="status" />正常(未填写个人信息)
								<input type="radio" value="1" <if condition="$list['status'] eq 1">checked="checked"</if> name="status" />正常&nbsp;<input type="radio" value="2" <if condition="$list['status'] eq 2">checked="checked"</if> name="status" />禁用</td>				
                            </tr>
                            <th></th>
                            <td>
                                <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Member/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>

<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(0).addClass("on");
</script>

78:F:\git\coin\bisheng commerce\App\Admin\View\Member\saveModify.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Member/saveModify')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>会员用户添加</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
						<input type="hidden" name="member_id" value="{$list['member_id']}"/>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>电子邮件：</th>
                            <td>{$list['email']}</td>
                        </tr>
                        <!-- 修改时显示下方 -->
                            <tr>
                                <th><i class="require-red">*</i>昵称：</th>
                                <td><input name="nick" id="nick" value="" type="text">
								<span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>真实姓名：</th>
                                <td><input name="name" id="name" value="" onkeyup="value=value.replace(/[^\D]/g,'');" autocomplete="off" maxlength="8" type="text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>证件类型：</th>
                                <td>
                                    <select id="cardtype" name="cardtype">
                                        <option value="1" selected="selected">身份证</option>
                                        <!--  <option value="2">护照</option>-->
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>证件号码：</th>
                                <td><input name="idcard" id="idcard" value="" type="text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>手机号码：</th>
                                <td><input name="phone" id="phone" value="" type="text">
								<span id="moshowBug" style=" margin-left:10px;color:#FF0000"></span></td>
                            </tr>
                        <tr>
                            <th></th>
                            <td>
                                <input type="button" onclick="subform()" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Member/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
cknick = 0;
ckphone = 0;
$('#nick').blur(function(){
	var path = "{:U('Member/ajaxCheckNick')}";
	$.ajax({
		type:"get",
		dataType:"json",
		data:{nick:$('#nick').val()},
		url:path,
		success:function(d){
				if(d['status']==0){
					$('#showBug').html(d['msg']);
					$('#nick').focus();
					return false;
				}else{
					$('#showBug').html(d['msg']);
					return cknick = 1 ;
				}
			},
		});
});
$('#phone').blur(function(){
	var path = "{:U('Member/ajaxCheckPhone')}";
	$.ajax({
		type:"get",
		dataType:"json",
		data:{phone:$('#phone').val()},
		url:path,
		success:function(d){
				if(d['status']==0){
					$('#moshowBug').html(d['msg']);
					$('#phone').focus();
					return false;
				}else{
					$('#moshowBug').html(d['msg']);
					return ckphone = 1 ;
				}
			},
		});
});

function subform(){
	if(cknick==1 && ckphone==1){
		$('#myform').submit();
	}else{
		alert('请填写完整信息');
	}
}
</script>
 
<!--/main-->
</div>
</body>
</html>

79:F:\git\coin\bisheng commerce\App\Admin\View\Member\show.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">查看个人账户</span></div>
        </div>
        <div class="result-wrap">
          <table class="result-tab" width="100%">
                <tr>
                    <th>ID</th>
                    <th>会员姓名</th>
                    <th>会员邮箱</th>
                    <th>会员电话</th>     
                </tr>
                    <tr>
                        <td>{$member_info['member_id']}</td>
                        <td>{$member_info['name']}</td>
                        <td>{$member_info['email']}</td>
                        <td>{$member_info['phone']}</td>
                    </tr>
          </table>
        </div>
        <div class="result-wrap">
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>币种名称</th>
                        <th>持有数量</th>
						<th>冻结数量</th>   
						<th>操作</th>   
                    </tr>
                    <volist name='info' id='vo'>
                        <tr>
                            <td>{$vo['currency_name']}</td>
                            <td><input  value="{$vo['num']}" type="text" id="num{$vo['currency_id']}"/></td>
							<td><input value="{$vo['forzen_num']}" type="text" id="forzen_num{$vo['currency_id']}"/></td>
                            <td><a onclick="update({$vo['currency_id']},num{$vo['currency_id']})">修改</a></td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div> 
        <div style="margin: 0 auto; text-align:center; "><br />
        	<input type="button" value="返回" onclick="history.go(-1)" class="btn btn6">
		</div>
    <!--/main-->
</div>
</body>
</html>
<script>
	function update(_this,a){
		layer.confirm('确定修改？', {
	  btn: ['确定','取消'], //按钮
	  title: '修改'
	}, function(){
		var member_id="{$info[0]['member_id']}";
		var num=$("#num"+_this).val();
		var forzen_num=$("#forzen_num"+_this).val();
	  $.post("{:U('Member/updateMemberMoney')}",{currency_id:_this,member_id:member_id,num:num,forzen_num:forzen_num},function(data){
				   if(data['status'] == 1){
					   layer.msg(data['info']);
					   setTimeout(function(){location.reload();},1000);
				   }else{
					   layer.msg(data['info']);
				   }
			})
	}, function(){
	  layer.msg('已取消');
	});

	}
</script>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(0).addClass("on");
</script>

80:F:\git\coin\bisheng commerce\App\Admin\View\Member\show_my_invit.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                    <a href="{:U('Member/index')}">返回</a>
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>ID</th>
                        <th>会员邮箱</th>
                        <th>状态</th>
                        <th>注册时间</th>
                    </tr>
                    <volist name='my_invit' id='vo'>
                        <tr>
                            <td>{$vo['member_id']}</td>
                            <td>{$vo['email']}</td>
							<td>{$vo['status']|getMemberStatus=###}</td>
                            <td>{$vo['reg_time']|date="Y-m-d H:i:s",###}</td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

81:F:\git\coin\bisheng commerce\App\Admin\View\Message\addMessage.html
<include file="App/Admin/View/Public/left.html"/>

    <script type="text/javascript" src="__PUBLIC__/js/jquery-1.8.2.js"></script>
    <script type="text/javascript" src="__PUBLIC__/js/jquery-2.1.1.min.js"></script>
    <script src="__PUBLIC__/js/bootstrap.min.js?v=3.4.0"></script>
    <script type="text/javascript" src="__PUBLIC__/js/layer/layer.js"></script>
    <script src="__PUBLIC__/js/jquery.validate.min.js"></script>
    <script src="__PUBLIC__/js/messages_zh.min.js"></script>
    <script src="__PUBLIC__/js/base.js"></script>
	
	<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/kindeditor.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/lang/zh_CN.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/kindeditor/plugins/prettify.js"></script>

 <script>
						$(function(){
						if($("#all").change()){
							　$('#show').hide();
						}
						 
						　　$("#one").change(function(){
						　　　　$('#show').show();
						　　});
							$("#all").change(function(){
						　　　　$('#show').hide();
						　　});
						});  
						</script>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="/think/admin">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">会员管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Message/addMessage')}" method="post" id="subform" jump-url="{:U('Message/index')}" >
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>会员用户添加</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
						
						 <tr>
                            <th width="15%"><i class="require-red">*</i>类型</th>
                            <td>
							<select name="type">
								<volist name="type" id="row">
								<option value="{$row['id']}" <eq name="row.id" value="$list['type']"> selected="selected" </eq>>{$row['name']}</option>
								</volist>
							</select>
							</td>
                        </tr>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>标题</th>
                            <td><input  style=" width:300px;" name="title" id="title" value="{$list['title']}" type="text"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
											
						<tr>
                            <th width="15%"><i class="require-red">*</i>内容</th>
                            <td>
 
								<textarea id="content" name="content" cols="30" style="width:800px;height:300px;" rows="10">{$list['content']}</textarea>
			<script>									
                    KindEditor.ready(function(K) {
                            window.editor = K.create('#content');	
                    });

            </script>
							</td>
                        </tr>
 						<tr>
                            <th width="15%"><i class="require-red">*</i>发送人员</th>
                            <td>
							<if condition="$list['u_id'] ">
								 <input type="radio"  name="radios" value="all" id="all" <if condition="$list['u_id'] eq -1 ">checked="checked"</if> />群发
								 <input type="radio"  name="radios" value="one" id="one"    <if condition="$list['u_id'] neq -1 ">checked="checked"</if> />个人
								 <else/>
								 <input type="radio"  name="radios" value="all" id="all" checked="checked" />群发
								 <input type="radio"  name="radios" value="one" id="one" />个人
							</if>
 
							</td>
                        </tr>	
						<tr id="show" style="display:none">
                            <th width="15%"><i class="require-red">*</i>请输入个人ID</th>
                            <td>
								 <input type="text"  name="u_id" value="{$list['u_id']}" />
							</td>
                        </tr>	
						<if condition="$list['add_time']">
						 <tr>
                           <th width="15%"><i class="require-red">*</i>添加时间</th>
                            <td><input style=" width:200px;" name="add_time" readonly="readonly" value="{$list['add_time']|date="Y-m-d H:i:s",###}"  /></td>
                        </tr>
						</if>
                        <tr>
                            <th></th>
 
                            <td>
							<if condition="empty($list['id'])">
								<input type="submit"  value="提交" class="btn btn-primary btn6 mr10">
							</if>
                                <a href="{:U('Message/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>
<script>

$("#subform").validate({			   
                rules: {
                    title: {
                        required: true,
                    },
					 content: {
                        required: true,
                    }
                },
                messages: {
                    title: {
                        required: "标题不能为空",
                    },
					 content: {
                        required: "内容不能为空",
                    }
                },
				submitHandler:function(form){
					editor.sync();
					form.submit();
					return false;
				},
				invalidHandler: function() {  //不通过回调 
					  return false; 
				  },
            });
			
</script>



<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(2).addClass("on");
</script>

82:F:\git\coin\bisheng commerce\App\Admin\View\Message\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="/jscss/admin">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">消息管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Message/index')}" method="post">
                    <table class="search-tab">
                        <tr>
                            <th width="70">消息标题:</th>
                            <td><input class="common-text" placeholder="关键字" name="title" type="text"></td>
                            <td><input class="btn btn-primary btn2"  value="查询" type="submit"></td>
                        </tr>
                    </table>
                </form>
				
            </div>
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                    <a href="{:U('Message/addMessage')}"><i class="icon-font"></i>新增消息</a>
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                        <th>ID</th>
						<th>消息类型</th>
                        <th>消息标题</th>
						<th>消息内容</th>
                        <th>添加时间</th>
                        <th>发送人员</th>
                        <th>操作</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['id']}</td>
                            <td><if condition="$vo['type'] eq -1 "><span style="color:#FF0000">【{$vo['type_name']}】</span>
							<else/>【{$vo['type_name']}】
							</if></td>
							<td>{$vo['title']||mb_substr=0,9,"utf-8"}</td>
                            <td>{$vo['content']|mb_substr=0,20,"utf-8"}</td>
                            <td>{$vo['add_time']|date="Y-m-d H:i:s",###}</td>
                            <td><if condition="$vo['u_id'] eq -1">
									群发
								<else/>
									发送至个人ID为({$vo['u_id']})
								</if>
								 
								</td>
                            <td>
                                <a class="link-update" href="{:U('Message/addMessage',array('id'=>$vo['id']))}">查看</a>
                                <a class="link-del" href="{:U('Message/delMessage',array('id'=>$vo['id']))}" onclick="return confirm('确确认删除吗？')">删除</a>
                            </td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(3).show();
$(".sub-menu").eq(3).children("li").eq(2).addClass("on");
</script>

83:F:\git\coin\bisheng commerce\App\Admin\View\Pay\add.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href=":U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">VIP设置</span></div>
        </div>
        <div class="result-wrap">
            <form action="{:U('Flash/add')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
                <div class="config-items">
                    <div class="config-title">
                        <h1><i class="icon-font">&#xe00a;</i>VIP详细信息设置</h1>
                    </div>
                    <div class="result-content">
                        <table width="100%" class="insert-tab">
                            <tbody>
                            <tr>
                                <th width="15%"><i class="require-red">*</i>幻灯图片：</th>
                                <td><img style="width:400px;" src="{$flash.pic}"><input type="hidden" name="pic" value="{$flash.pic}" class="common-text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>幻灯图片上传：</th>
                                <td><input type="file" name="Filedata" class="common-text"></td>
                            </tr>
                            <tr>
                                    <th><i class="require-red">*</i>图片标题：</th>
                                    <td><input type="text" id="" value="{$flash.title}" size="85" name="title" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>排序：</th>
                                    <td><input type="text" id="" value="{$flash.sort}" size="85" name="sort" class="common-text"><input type="hidden" id="" value="{$flash.flash_id}" size="85" name="flash_id" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>跳转地址：</th>
                                    <td><input type="text" id="" value="{$flash.jump_url}" size="85" name="jump_url" class="common-text"></td>
                                </tr>
                                
                             
                                <tr>
                                    <th></th>
                                    <td>
                                        <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                        <a href="{:U('Flash/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                                    </td>
                                </tr>
                            </tbody></table>
                    </div>
                </div>
                
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

84:F:\git\coin\bisheng commerce\App\Admin\View\Pay\admRecharge.html
<include file="App/Admin/View/Public/left.html" />
<!--/sidebar-->
<div class="main-wrap">
	<div class="crumb-wrap">
		<div class="crumb-list">
			<i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span
				class="crumb-step">&gt;</span><span class="crumb-name">添加分红奖励</span>
		</div>
	</div>

	<div class="result-wrap">



		<div style="float: left; width: 30%; margin-right: 20px;">
			<div class="config-title">

				<h1>
					<i class="icon-font">&#xe00a;</i>添加管理员充值
				</h1>
			</div>
			<form action="{:U('Pay/admRecharge')}" method="post" id="myform"
				name="myform"  >
				<div class="config-items">
					<div class="result-content">
						<table width="100%" class="insert-tab">
							<tbody>
								<tr>
									<th style="width: 35%;"><i class="require-red">*</i>充值用户ID：</th>
									<td><input name="member_id" type="text"><span
										id="showBug" style="margin-left: 10px; color: #FF0000"></span></td>
								</tr>
								<tr>
									<th><i class="require-red">*</i>充值币种：</th>
									<td><select name="currency_id" id="category">
											<option value="0">人民币</option>
											<foreach name="currency" item="vo">
											<option value="{$vo.currency_id}">{$vo.currency_name}</option>
											</foreach>
									</select></td>

								</tr>
								<tr>
									<th><i class="require-red">*</i>充值金额：</th>
									<td><input name="money" type="text"></td>
								</tr>
									<tr>
									<th><i class="require-red">*</i>管理员密码：</th>
									<td><input name="password" type="password" /></td>
								</tr>

								<th></th>
								<td><input type="submit" value="提交"
									class="btn btn-primary btn6 mr10"></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</form>
		</div>
		<div style="float: left; width: 65%;">
			<div class="config-title">
				<h1>
					<i class="icon-font">&#xe00a;</i>管理员充值列表
				</h1>
			</div>
            <div class="search-content">
						<form action="{:U('Pay/admRecharge')}" method="get">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="type_id" id="">
											<option value="">全部</option>
											<volist name='type' id='vo'>
											<option value="{$vo.id}">{$vo.name}</option>
											</volist>
										</select>
									</td>
									<th width="70">用户邮箱:</th>
									<td><input class="common-text" placeholder="用户邮箱" name="email" value="{$get.email}" id="" type="text"></td>
                                    <th width="70">用户ID:</th>
									<td><input class="common-text" placeholder="用户ID" name="member_id" value="{$get.name}" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form>
					</div>
                    <br>
			<table class="result-tab" width="100%">
				<tr>
					<th>充值用户ID</th>
					<th>充值用户</th>
					<th>充值币种</th>
					<th>充值金额</th>
				</tr>
				<volist name='list' id='vo'>
				<tr>
					<td>{$vo['member_id']}</td>
					<td>{$vo['member_id']|getMemberEmailByMember_id=###}</td>
					<td>{$vo['currency_id']|getCurrencynameByCurrency=###}</td>
					<td>{$vo['money']|default=0}</td>
				</tr>
				</volist>
			</table>
			  <div class="list-page"> <ul>{$page}</ul></div>
		</div>
		<div style="clear: both;"></div>
	</div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(3).addClass("on");
</script>

85:F:\git\coin\bisheng commerce\App\Admin\View\Pay\fill.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">第三方充值记录</span></div>
        </div>
        <!-- <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/payByMan')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="status" id="">
											<option value="">全部</option>
											<option value="0">未付款</option>
											<option value="1">充值成功</option>
											<option value="2">充值失败</option>
											<option value="3">已失效</option>
										</select>
									</td>
									<th width="70">汇款人:</th>
									<td><input class="common-text" placeholder="汇款人" name="member_name" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form> 
					</div>
				</div>
			</div>
        </div> -->
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>订单号</th>
                            <th>汇款人</th>
                            <th>充值钱数</th>
                            <th>状态</th>
                            <th>时间</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.tradeno}</td>
                     		<td>{$vo.uname}</td>
                            <td>{$vo.num}</td>
                            <td><eq name='vo.status' value='0'>未成功<else/>汇款成功</eq></td>
                            <td>{$vo.ctime|date="Y-m-d H:i:s",###}</td>
                        </tr>
                        </volist>
                    </table>
                     <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

<script>
function pass(id){
	layer.confirm(
	'确定通过审核', 
	{btn:['确定','取消']},
	function(){
	  $.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":1},function(data){
		  if(data.status==0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
	}
	),
	function(){
		layer.msg('已取消');
	}
}

function fail(id){
	layer.confirm(
	'确定不通过审核', 
	{btn: ['确定','取消'],},
	function(){
		//href="{:U('Pay/payUpdate',array('pay_id'=>$vo['pay_id'],'status'=>1))}			
		$.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":2},function(data){
				if(data.status == 0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
					
				}else if(data.status == 2){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
		}
		),
	 function(){
		layer.msg('已取消');
	}
}
</script>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(4).addClass("on");
</script>

86:F:\git\coin\bisheng commerce\App\Admin\View\Pay\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">财务日志</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/index')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="type_id" id="">
											<option value="0">全部</option>
											<volist name='type' id='vo'>
											<option value="{$vo.id}">{$vo.name}</option>
											</volist>
										</select>
									</td>
									<th width="70">用户:</th>
									<td><input class="common-text" placeholder="用户" name="name" value="{$get.name}" id="" type="text"></td>
                                    <th width="70">用户ID:</th>
									<td><input class="common-text" placeholder="用户ID" name="member_id" value="{$get.name}" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>日志编号</th>
                            <th>所属</th>
                            <th>财务类型</th>
                            <th>内容</th>
                            <th>金额</th>
                            <th>币种</th>
							<th>收入/支出</th>
                            <th>时间</th>
                            <th>操作</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.finance_id}</td>
                            <td>{$vo.username}</td>
                            <td>{$vo.typename}</td>
                            <td>{$vo.content}</td>
                            <td>{$vo.money}</td>
                            <td>{$vo.currency_name}</td>
							<td><eq name='vo.money_type' value='1'>收入<else/>支出</eq></td>
                            <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                            <td>
							</td>
                        </tr>
                        </volist>
                    </table>
					<div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(2).addClass("on");
</script>

87:F:\git\coin\bisheng commerce\App\Admin\View\Pay\payByMan.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">人工充值记录管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/payByMan')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="status" id="">
											<option value="">全部</option>
											<option value="0">未付款</option>
											<option value="1">充值成功</option>
											<option value="2">充值失败</option>
											<option value="3">已失效</option>
										</select>
									</td>
									<th width="70">汇款人:</th>
									<td><input class="common-text" placeholder="汇款人" name="member_name" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
									</tr>
                                    <tr>   
                                    <th><i class="require-red">*</i>开始时间：</th>
                                    <td>
                            
                                    <div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="add_time" class="ui_timepicker" id="aaaaa1" placeholder="选择日期时间" value="{$list.add_time|date='Y-m-d H:i:s',###}"  />
                                                </div></div></td>
                                  <script type="text/javascript">
                                    $(function () {
                                        $("#aaaaa1").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                            $("#aaaaa2").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                   
                                    })
                                </script>
                                    <th><i class="require-red">*</i>截止时间：</th>
                                    <td><div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="end_time" class="ui_timepicker" id="aaaaa2" placeholder="选择日期时间" value="{$list.end_time|date='Y-m-d H:i:s',###}" / >
                                                </div></div></td>
									<td><input class="btn btn-primary btn2" name="sub" value="下载表格" type="button" onclick="download()"></td>
								</tr>
								
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>订单号</th>
                            <th>汇款人账号</th>
                            <th>汇款人</th>
                            <th>银行卡号</th>
                            <th>充值钱数</th>
                            <th>实际打款</th>
                            <th>充值奖励</th>
                            <th>状态</th>
                            <th>时间</th>
                            <th>操作</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.pay_id}</td>
                     		<td>{$vo.email}</td>
                            <td>{$vo.member_name}</td>
                            <td>{$vo.account}</td>
                            <td>{$vo.money}</td>
                            <td>{$vo.count}</td>
                            <td>{$vo.pay_reward}</td>
                            <td><eq name='vo.status' value='请付款'>未付款<else/>{$vo.status}</eq></td>
                            <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                            <td>
                            
                                <eq name='vo.status' value='请付款'>
									<a class="link-update"  href="javascript:void(0);" onClick="pass({$vo['pay_id']});">通过</a>
									<a class="link-del" href="javascript:void(0);" onClick="fail({$vo['pay_id']})">不通过</a>
								<else/>
									操作完成
								</eq>
                            </td>
                        </tr>
                        </volist>
                    </table>
                     <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

<script>
function pass(id){
	layer.confirm(
	'确定通过审核', 
	{btn:['确定','取消']},
	function(){
	  $.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":1},function(data){
		  if(data.status==0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
	}
	),
	function(){
		layer.msg('已取消');
	}
}

function fail(id){
	layer.confirm(
	'确定不通过审核', 
	{btn: ['确定','取消'],},
	function(){
		//href="{:U('Pay/payUpdate',array('pay_id'=>$vo['pay_id'],'status'=>1))}			
		$.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":2},function(data){
				if(data.status == 0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
					
				}else if(data.status == 2){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
		}
		),
	 function(){
		layer.msg('已取消');
	}
}
</script>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(1).addClass("on");
</script>
<script>
function download(){
	var add_time=$('#aaaaa1').val();
	var end_time=$('#aaaaa2').val();
	var url="{:U('Pay/derivedExcel')}";
	window.location.href=url+"?add_time="+add_time+"&&end_time="+end_time;
}
</script>

88:F:\git\coin\bisheng commerce\App\Admin\View\Pending\index.html
   <include file="App/Admin/View/Public/left.html"/>
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">提现审核</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
                <form action="{:U('Pending/index')}" method="get">
                    <table class="search-tab">
                        <tr>
                            <th width="120">选择分类:</th>
                            <td>
                                <select name="status" id="">
                                  <option value="0">全部</option>
                                  <option value="1">未通过</option>
                                  <option value="2">通过</option>
                                  <option value="3">审核中</option>
                                </select>
                            </td>
                            <th width="70">提现人:</th>
                            <td><input class="common-text" placeholder="提现人" name="keyname" value="{$inquire}" id="keyname" type="text"></td>					
                  
                            <td><input class="btn btn-primary btn2" value="查询" type="submit"></td>
                            <tr>   
                                    <th><i class="require-red">*</i>开始时间：</th>
                                    <td>
                            
                                    <div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="add_time" class="ui_timepicker" id="aaaaa1" placeholder="选择日期时间" value="{$list.add_time|date='Y-m-d H:i:s',###}"  />
                                                </div></div></td>
                                  <script type="text/javascript">
                                    $(function () {
                                        $("#aaaaa1").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                            $("#aaaaa2").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                   
                                    })
                                </script>
                                    <th><i class="require-red">*</i>截止时间：</th>
                                    <td><div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="end_time" class="ui_timepicker" id="aaaaa2" placeholder="选择日期时间" value="{$list.end_time|date='Y-m-d H:i:s',###}" / >
                                                </div></div></td>
									<td><input class="btn btn-primary btn2" name="sub" value="下载表格" type="button" onclick="download()"></td>
								</tr>
								
                        </tr>
                    </table>
                </form>
            </div>
        </div>
        <div class="result-wrap">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>ID</th>               
                            <th>提现人</th>
                            <th>会员ID</th>
                            <th>银行</th>
                            <th>银行账号</th>
                            <th>银行开户地</th>
                            <th>开户支行</th>
                            <th>提现金额</th>
                            <th>手续费（{$config.fee}%）</th>
                            <th>实际金额</th>
                            <th>订单号</th>
                            <th>提交时间</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
  						<volist name='info' id='vo'>
                        <tr>
                            <td>{$vo.withdraw_id}</td>
                            <td>{$vo.cardname}</td>
                            <td>{$vo.uid}</td>
                            <td>{$vo.bankname}</td>
                            <td>{$vo.cardnum}</td>
                            <td>{$vo.aarea_name}&nbsp;&nbsp;{$vo.barea_name}</td>
                            <td>{$vo.bank_branch|default="暂未填写"}</td>
                            <td>{$vo.all_money}</td>
                            <td>{$vo.withdraw_fee}</td>
                            <td>{$vo.money}</td>
                            <td>{$vo.order_num}</td>
                            <td>{$vo.add_time|date='Y-m-d H:i:s',###}</td>
                            <td><eq name="vo.status" value="1">未通过<else/><eq name="vo.status" value="2">通过<else/>审核中</eq></eq></td>
                            <td>	
                            	<eq name="vo.status" value="3">										
                                <a class="link-update" href="javascript:void(0);" onclick="pass({$vo.withdraw_id});">通过</a>
                                &nbsp;&nbsp;
                                <a class="link-del" href="javascript:void(0);"onclick="fail({$vo.withdraw_id})">不通过</a>
                                <else /> 操作成功</eq>	
                            </td>                        
                            </tr>
                        </volist>
                       
                    </table>
                    <div class="list-page"> <ul>{$page}</ul></div>
                </div>
          
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(6).show();
$(".sub-menu").eq(6).children("li").eq(0).addClass("on");
function pass(id){
	layer.confirm('确定通过审核', {
	  btn: ['确定','取消'], //按钮
	}, function(){
		//location.href = '{:U('Pending/successByid',array('id'=>$vo['withdraw_id']))}';
		$.post("{:U('Pending/successByid')}",{"id":id},function(datas){
				if(datas.status == 0){
					layer.msg(datas['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(datas['info']);
					setTimeout("location.reload()",2000);
				}
			});
	  //layer.msg('');
	}, function(){
		layer.msg('已取消');
	});
}
function fail(id){
	layer.confirm('确定不通过审核', {
	  btn: ['确定','取消'], //按钮
	}, function(){		
	//	location.href = '{:U('Pending/falseByid', array('id'=>$vo['withdraw_id']))}';
		$.post("{:U('Pending/falseByid')}",{"id":id},function(datas){
				if(datas.status == 0){
					layer.msg(datas['info']);
					setTimeout("location.reload()",2000);
				}else if(datas.status == 2){
					layer.msg(datas['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(datas['info']);
					setTimeout("location.reload()",2000);
				}
		});
	  //layer.msg('');
	}, function(){
		layer.msg('已取消');
	});
}
</script>

<script>
function download(){
	var add_time=$('#aaaaa1').val();
	var end_time=$('#aaaaa2').val();
	var url="{:U('Pending/derivedExcel')}";
	window.location.href=url+"?add_time="+add_time+"&&end_time="+end_time;
}
</script>

89:F:\git\coin\bisheng commerce\App\Admin\View\Public\404.html
<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>对不起，未能找到您想要的页面</title>
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" rev="stylesheet" type="text/css" media="all" href="__PUBLIC__/Home/css/basev2.css">
<style>
body { background:url(http://img.kuai.xunlei.com/img/v2/log_bg.jpg) repeat; }
</style>
</head>
<body>
<div class="bg_404"><p>404 对不起，未能找到您想要的页面</p><a class="back_home_btn" href="{:U('Index/index')}" title="返回首页">返回首页</a></div>
<img src="%E8%BF%85%E9%9B%B7%E5%BF%AB%E4%BC%A0-%E5%AF%B9%E4%B8%8D%E8%B5%B7%EF%BC%8C%E6%9C%AA%E8%83%BD%E6%89%BE%E5%88%B0%E6%82%A8%E6%83%B3%E8%A6%81%E7%9A%84%E9%A1%B5%E9%9D%A2_files/r.txt" style="display:none;">

</body></html>

90:F:\git\coin\bisheng commerce\App\Admin\View\Public\left.html
<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" >
	<meta name="renderer" content="webkit">
    <title>网站后台管理</title>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/common.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/css/main.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/iconfont/demo.css">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/iconfont/iconfont.css"/>
    <script type="text/javascript" src="__PUBLIC__/Admin/js/libs/modernizr.min.js"></script>
	<script type="text/javascript" src="__PUBLIC__/Admin/js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/Public/js/layer/layer.js"></script>
    <script type="text/javascript" src="/Public/js/laydate/laydate.js"></script>
    
	<link type="text/css" href="/Public/Admin/css/jquery-ui-1.8.17.custom.css" rel="stylesheet" />
    <link type="text/css" href="/Public/Admin/css/jquery-ui-timepicker-addon.css" rel="stylesheet" />
    <script type="text/javascript" src="/Public/Admin/js/jquery-ui-1.8.17.custom.min.js"></script>
    <script type="text/javascript" src="/Public/Admin/js/jquery-ui-timepicker-addon.js"></script>
    <script type="text/javascript" src="/Public/Admin/js/jquery-ui-timepicker-zh-CN.js"></script>

    <script>
(function ($) {
    // 汉化 Datepicker
    $.datepicker.regional['zh-CN'] =
    {
        clearText: '清除', clearStatus: '清除已选日期',
        closeText: '关闭', closeStatus: '不改变当前选择',
        prevText: '<上月', prevStatus: '显示上月',
        nextText: '下月>', nextStatus: '显示下月',
        currentText: '今天', currentStatus: '显示本月',
        monthNames: ['一月', '二月', '三月', '四月', '五月', '六月',
        '七月', '八月', '九月', '十月', '十一月', '十二月'],
        monthNamesShort: ['一', '二', '三', '四', '五', '六',
        '七', '八', '九', '十', '十一', '十二'],
        monthStatus: '选择月份', yearStatus: '选择年份',
        weekHeader: '周', weekStatus: '年内周次',
        dayNames: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],
        dayNamesShort: ['周日', '周一', '周二', '周三', '周四', '周五', '周六'],
        dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],
        dayStatus: '设置 DD 为一周起始', dateStatus: '选择 m月 d日, DD',
        dateFormat: 'yy-mm-dd', firstDay: 1,
        initStatus: '请选择日期', isRTL: false
    };
    $.datepicker.setDefaults($.datepicker.regional['zh-CN']);
 
    //汉化 Timepicker
  $.timepicker.regional['zh-CN'] = {
    timeOnlyTitle: '选择时间',
    timeText: '时间',
    hourText: '小时',
    minuteText: '分钟',
    secondText: '秒钟',
    millisecText: '微秒',
    timezoneText: '时区',
    currentText: '现在时间',
    closeText: '关闭',
    timeFormat: 'hh:mm',
    amNames: ['AM', 'A'],
    pmNames: ['PM', 'P'],
    ampm: false
  };
  $.timepicker.setDefaults($.timepicker.regional['zh-CN']);
})(jQuery);
</script>
<style>
.iconfont{ padding-right:5px;}
.fsize{ font-size:15px;}
</style>
</head>
<body>
<div class="topbar-wrap white">
    <div class="topbar-inner clearfix">
        <div class="topbar-logo-wrap clearfix">
            <h1 class="topbar-logo none"><a href="index.html" class="navbar-brand">后台管理</a></h1>
            <ul class="navbar-list clearfix">
                <li><a class="on" href="index.html">首页</a></li>
                <li><a href="{:U('Index/index')}" target="_blank">网站首页</a></li>
                <li><a href="{:U('Index/infoStatistics')}" target="_blank">全站统计信息</a></li>
            </ul>
        </div>
        <div class="top-info-wrap">
            <ul class="top-info-list clearfix">
                <li><a href="{:U('Manage/index')}">管理员</a></li>
                <li><a href="{:U('Manage/pwdUpdate')}">修改密码</a></li>
                <li><a href="{:U('Login/loginout')}">退出</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="container clearfix">
<div class="sidebar-wrap">
        <div class="sidebar-title">
            <h1>菜单</h1>
        </div>
        <div class="sidebar-content">
            <ul class="sidebar-list">
                 <notempty name='sys_nav'>
                 <li>
                    <a href="#"><i class="iconfont">&#xe614;</i><span class="fsize">系统管理</span></a>
                    <ul class="sub-menu">
                        
                        	<volist name='sys_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            <!--<li><a href="system.html"><i class="icon-font">&#xe037;</i>清理缓存</a></li>
                            <li><a href="system.html"><i class="icon-font">&#xe046;</i>数据备份</a></li>
                            <li><a href="system.html"><i class="icon-font">&#xe045;</i>数据还原</a></li>-->
                            </volist>
                        
                    </ul>
                </li>
               </notempty>
			   
			   <notempty name='bank_nav'>
                <li>
                    <a href="#"><i class="iconfont">&#xe635;</i><span class="fsize">银行管理</span></a>
                    <ul class="sub-menu">
                        	<volist name='bank_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                    </ul>
                </li>
                </notempty>
				
               <notempty name='common_nav'>
                <li>
                    <a href="#"><i class="iconfont">&#xe635;</i><span class="fsize">常用操作</span></a>
                    <ul class="sub-menu">
                        	<volist name='common_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                    </ul>
                </li>
                </notempty>
                
                <notempty name='user_nav'>
                <li>
                    <a href="#"><i class="iconfont">&#xe64d;</i><span class="fsize">会员管理</span></a>
                    <ul class="sub-menu">
                    
                        	<volist name='user_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                    </ul>
                </li>
                </notempty>
				
                 <notempty name='bonus_nav'>
                <li>
                    <a href="#"><i class="icon-font">&#xe018;</i><span class="fsize">分红管理</span></a>
                    <ul class="sub-menu">
                    
                        	<volist name='bonus_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="icon-font">&#xe017;</i>{$vo.nav_name}</a></li>
                            </volist>
                    </ul>
                </li>
                </notempty>
				
                <notempty name='zhongchou_nav'>
                <li>
                    <a href="#"><i class="iconfont">&#xe650;</i><span class="fsize">众筹管理</span></a>
                     <ul class="sub-menu">
                     
                        	<volist name='zhongchou_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                    </ul>
                </li>
               </notempty>
                
                <notempty name='finance_nav'>
                <li>
                    <a href="#"><i class="iconfont">&#xe6c8;</i><span class="fsize">财务管理</span></a>
                     <ul class="sub-menu">
                     
                        	<volist name='finance_nav' id='vo'>
                        		<li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                    </ul>
                </li>
               </notempty>

                <notempty name='trade_nav'>
                    <li>
                        <a href="#"><i class="iconfont">&#xe631;</i><span class="fsize">交易管理</span></a>
                        <ul class="sub-menu">
                            <volist name='trade_nav' id='vo'>
                                <li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                            <!--<li><a href="{:U('Trade/trade')}"><i class="icon-font">&#xe017;</i>交易记录</a></li>-->
                            <!--<li><a href="{:U('Trade/orders')}"><i class="icon-font">&#xe017;</i>委托记录</a></li>-->
                        </ul>
                    </li>
                </notempty>
                
                <notempty name='wallet_nav'>
                    <li>
                        <a href="#"><i class="iconfont">&#xe631;</i><span class="fsize">钱包币种管理</span></a>
                        <ul class="sub-menu">
                            <volist name='wallet_nav' id='vo'>
                                <li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                            <!--<li><a href="{:U('Trade/trade')}"><i class="icon-font">&#xe017;</i>交易记录</a></li>-->
                            <!--<li><a href="{:U('Trade/orders')}"><i class="icon-font">&#xe017;</i>委托记录</a></li>-->
                        </ul>
                    </li>
                </notempty>
                
                  <notempty name='article_nav'>
                    <li>
                        <a href="#"><i class="iconfont">&#xe6f7;</i><span class="fsize">文章管理</span></a>
                        <ul class="sub-menu">
                            <volist name='article_nav' id='vo'>
                                <li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                            <!--<li><a href="{:U('Trade/trade')}"><i class="icon-font">&#xe017;</i>交易记录</a></li>-->
                            <!--<li><a href="{:U('Trade/orders')}"><i class="icon-font">&#xe017;</i>委托记录</a></li>-->
                        </ul>
                    </li>
                </notempty>
                
                <notempty name='admin_nav'>
                    <li>
                        <a href="#"><i class="iconfont">&#xe64d;</i><span class="fsize">管理员管理</span></a>
                        <ul class="sub-menu">
                            <volist name='admin_nav' id='vo'>
                                <li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                            <!--<li><a href="{:U('Trade/trade')}"><i class="icon-font">&#xe017;</i>交易记录</a></li>-->
                            <!--<li><a href="{:U('Trade/orders')}"><i class="icon-font">&#xe017;</i>委托记录</a></li>-->
                        </ul>
                    </li>
                </notempty>
                <notempty name='tongji_nav'>
                    <li>
                        <a href="#"><i class="iconfont">&#xe64d;</i><span class="fsize">统计</span></a>
                        <ul class="sub-menu">
                            <volist name='tongji_nav' id='vo'>
                                <li><a href="{$vo.nav_url}"><i class="iconfont">{$vo.nav_e}</i>&nbsp;{$vo.nav_name}</a></li>
                            </volist>
                            <!--<li><a href="{:U('Trade/trade')}"><i class="icon-font">&#xe017;</i>交易记录</a></li>-->
                            <!--<li><a href="{:U('Trade/orders')}"><i class="icon-font">&#xe017;</i>委托记录</a></li>-->
                        </ul>
                    </li>
                </notempty>
            </ul>
        </div>
    </div>
<script>
$(".sidebar-list li").children("a").on("click",function(){
	$(this).next(".sub-menu").toggle();
});
</script>

91:F:\git\coin\bisheng commerce\App\Admin\View\Tongji\shuju.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">第三方充值记录</span></div>
        </div>
        <!-- <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/payByMan')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="status" id="">
											<option value="">全部</option>
											<option value="0">未付款</option>
											<option value="1">充值成功</option>
											<option value="2">充值失败</option>
											<option value="3">已失效</option>
										</select>
									</td>
									<th width="70">汇款人:</th>
									<td><input class="common-text" placeholder="汇款人" name="member_name" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form> 
					</div>
				</div>
			</div>
        </div> -->
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
            </form>			
		<div class="result-tab">
				<div class="panel-actions" style="height:50px;">
                <h1 class="fl" style="line-height:50px; margin-left:20px;">
					<i class="icon-font"></i>
					数据统计状况
				</h1>
				    <form action="{:U('Tongji/shuju')}" method="post" class="form-inline form-search" style="fr">					
					<div class="fr" style="line-height:50px;">						
                       <input type="text" name="userid" value=""  class="form-control search-query" style="width:20%;" placeholder="会员id" title="会员id" /> 
								<input type="text" name="stime" class="stime" placeholder="开始时间：如2016-03-22" title="开始时间" readonly="" style="margin-right:20px;" onclick="laydate()">		
								<input type="text" name="etime" class="etime" placeholder="结束时间：如2016-04-21" title="结束时间" readonly="" style="margin-right:20px;" onclick="laydate()">

							<input type="submit" id="submit" class="btn btn-primary" value="搜索" data-loading="稍候..." style="margin-right:20px;">
					</div>
				  </form>
				</div>
			<div class="" style="overflow:hidden;">
				<div class="fl" style="padding-bottom:10px; width:56%; margin-left:15px;">
							<strong>					
								充值统计
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%; border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center">币种</th>
                        <th class="text-center">单数</th>
						<th class="text-center">充值总金额</th>
					</tr>
				</thead>
				<tbody>		
					<volist name="alltj" id="vo" key="key">			
					<tr>
						<td class="text-right ">{$vo['currency_mark']}</td>
						<td class="text-right"><a href="#">{$vo['paytj']['allnum']|default='0'}</a></td>
                        <td class="text-right">{$vo['paytj']['allmoney']|default='0'}</td>                       
					</tr>
					</volist>
				</tbody>
			</table>
				</div>
				<div class="fl" style="padding-bottom:10px; width:40%; margin-left:10px;">
							<strong>					
								提现统计
							</strong>
						<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">单数</th>
						<th class="text-center w-300px">提现总金额</th>
					</tr>
				</thead>
				<tbody>
					<volist name="alltj" id="vo" key="key">			
					<tr>
						<td class="text-right ">{$vo['currency_mark']}</td>
						<td class="text-right"><a href="#">{$vo['allmoney']['allnum']|default='0'}</a></td>
                        <td class="text-right">{$vo['tibitj']['allmoney']|default='0'}</td>                       
					</tr>
					</volist>			
				</tbody>
			</table>
				</div>
                  <div style="padding-bottom:10px; width:97%; clear:both; margin-left:15px;">
							<strong>					
								挂单统计
							</strong>
			<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">交易类型</th>
                        <th class="text-center w-200px">单数</th>
						<th class="text-center w-200px">交易数量</th>
						<th class="text-center w-300px">交易额</th>
					</tr>
				</thead>
				<tbody>
					<volist name="order" id="vo" key="key">	
					<tr>                     
						<td class="text-right ">{$vo['currency_name']['currency_mark']}_{$vo['currency_trade_name']['currency_mark']}</td>
						<td class="text-right "><a>{$vo['num']}</a></td>
                        <td class="text-right ">
						 {$vo['jiaoyinum']}					({$vo['currency_name']['currency_mark']})</td>
                        <td class="text-right ">
						 {$vo['jiaoyiprice']}				({$vo['currency_trade_name']['currency_mark']})</td>
                        
					</tr>
					</volist>	
                    <tr>						
                        <th colspan="2" class="text-right ">合计</th>
                        <td class="text-right " colspan="2">CNY : {$order['0']['allmoney']} <br>                        </td>
					</tr>
					
				</tbody>
			</table>
				</div>
			</div>
            
            
            <div class="" style="overflow:hidden;">
				<div style="padding-bottom:10px; width:97%; clear:both; margin-left:15px;">
							<strong>					
								成交统计
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%; border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">交易类型</th>
                        <th class="text-center w-200px">单数</th>
						<th class="text-center w-200px">交易数量</th>
						<th class="text-center w-300px">交易额</th>
					</tr>
				</thead>
				<tbody>		
					<volist name="trade" id="vo" key="key">				
					<tr>                     
						<td class="text-right ">{$vo['currency_name']['currency_mark']}_{$vo['currency_trade_name']['currency_mark']}</td>
						<td class="text-right "><a>{$vo['num']}</a></td>
                        <td class="text-right ">
						 {$vo['jiaoyinum']}					({$vo['currency_name']['currency_mark']})</td>
                        <td class="text-right ">
						 {$vo['jiaoyiprice']}				({$vo['currency_trade_name']['currency_mark']})</td>
                        
					</tr>    
					</volist>	
	               <tr>
						<th colspan="2" class="text-right ">合计</th>
                        <td colspan="2" class="text-right ">CNY : {$trade['0']['allmoney']} <br></td>
					</tr>
					
				</tbody>
			</table>
				</div>
				<!--<div style="padding-bottom:10px; width:97%; clear:both; margin-left:15px;">
							<strong>					
								充值卡统计
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th colspan="5" class="warning">(充值卡的充值和提现金额已经在充值和提现中统计，这里的数字只是单独列出，方便查看，不需要计入财务报表)</th>
					</tr>
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">充值单数</th>
						<th class="text-center w-200px">充值数量</th>
						<th class="text-center w-200px">提现单数</th>
						<th class="text-center w-200px">提现数量</th>
					</tr>
				</thead>
				<tbody>	
					<tr>
						<td class="text-right ">VRC</td>
						<td class="text-right "><a href="/newadmin.php/Home/List/cardShow/?userid=&amp;coinid=5&amp;stime=2016-03-22&amp;etime=2016-04-21">0</a></td>
                        <td class="text-right ">0
						</td>
                        <td class="text-right ">0</td>
                        <td class="text-right ">0
						</td>
					</tr><tr>
						<td class="text-right ">CNY</td>
						<td class="text-right "><a href="/newadmin.php/Home/List/cardShow/?userid=&amp;coinid=1&amp;stime=2016-03-22&amp;etime=2016-04-21">0</a></td>
                        <td class="text-right ">0
						</td>
                        <td class="text-right ">0</td>
                        <td class="text-right ">0
						</td>
					</tr><tr>
						<td class="text-right ">FHG</td>
						<td class="text-right "><a href="/newadmin.php/Home/List/cardShow/?userid=&amp;coinid=8&amp;stime=2016-03-22&amp;etime=2016-04-21">0</a></td>
                        <td class="text-right ">0
						</td>
                        <td class="text-right ">0</td>
                        <td class="text-right ">0
						</td>
					</tr><tr>
						<td class="text-right ">NEC</td>
						<td class="text-right "><a href="/newadmin.php/Home/List/cardShow/?userid=&amp;coinid=12&amp;stime=2016-03-22&amp;etime=2016-04-21">0</a></td>
                        <td class="text-right ">0
						</td>
                        <td class="text-right ">0</td>
                        <td class="text-right ">0
						</td>
					</tr><tr>
						<td class="text-right ">BLK</td>
						<td class="text-right "><a href="/newadmin.php/Home/List/cardShow/?userid=&amp;coinid=13&amp;stime=2016-03-22&amp;etime=2016-04-21">0</a></td>
                        <td class="text-right ">0
						</td>
                        <td class="text-right ">0</td>
                        <td class="text-right ">0
						</td>
					</tr><tr>
						<td class="text-right ">BC</td>
						<td class="text-right "><a href="/newadmin.php/Home/List/cardShow/?userid=&amp;coinid=14&amp;stime=2016-03-22&amp;etime=2016-04-21">0</a></td>
                        <td class="text-right ">0
						</td>
                        <td class="text-right ">0</td>
                        <td class="text-right ">0
						</td>
					</tr>					
				</tbody>
			</table>
				</div>-->
			</div>
			<div>
				<div style="float:right; clear:none;" class="page form-inline">
					<div class="pagination"></div>
				</div>
			</div>
			</div>	
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

<script>
function pass(id){
	layer.confirm(
	'确定通过审核', 
	{btn:['确定','取消']},
	function(){
	  $.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":1},function(data){
		  if(data.status==0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
	}
	),
	function(){
		layer.msg('已取消');
	}
}

function fail(id){
	layer.confirm(
	'确定不通过审核', 
	{btn: ['确定','取消'],},
	function(){
		//href="{:U('Pay/payUpdate',array('pay_id'=>$vo['pay_id'],'status'=>1))}			
		$.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":2},function(data){
				if(data.status == 0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
					
				}else if(data.status == 2){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
		}
		),
	 function(){
		layer.msg('已取消');
	}
}
</script>
<script>
$(".sub-menu").eq(11).show();
$(".sub-menu").eq(11).children("li").eq(1).addClass("on");
</script>

92:F:\git\coin\bisheng commerce\App\Admin\View\Tongji\tuiguang.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">第三方充值记录</span></div>
        </div>
        <!-- <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/payByMan')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="status" id="">
											<option value="">全部</option>
											<option value="0">未付款</option>
											<option value="1">充值成功</option>
											<option value="2">充值失败</option>
											<option value="3">已失效</option>
										</select>
									</td>
									<th width="70">汇款人:</th>
									<td><input class="common-text" placeholder="汇款人" name="member_name" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form> 
					</div>
				</div>
			</div>
        </div> -->
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
            </form>			
		<div class="result-tab">
				<div class="panel-actions" style="height:50px;">
                <h1 class="fl" style="line-height:50px; margin-left:20px;">
					<i class="icon-font"></i>
					推广统计状况
				</h1>
				    <form action="{:U('Tongji/tuiguang')}" method="post" class="form-inline form-search" style="fr">					
					<div class="fr" style="line-height:50px;">						
                       <input type="text" name="userid" value=""  class="form-control search-query" style="width:20%;" placeholder="会员id" title="会员id" /> 
								<input type="text" name="stime" class="stime" placeholder="开始时间：如2016-03-22" title="开始时间" readonly="" style="margin-right:20px;" onclick="laydate()">		
								<input type="text" name="etime" class="etime" placeholder="结束时间：如2016-04-21" title="结束时间" readonly="" style="margin-right:20px;" onclick="laydate()">

							<input type="submit" id="submit" class="btn btn-primary" value="搜索" data-loading="稍候..." style="margin-right:20px;">
					</div>
				  </form>
				</div>
			<div class="" style="overflow:hidden;">
				<div class="fl" style="padding-bottom:10px; width:32%; margin-left:15px;">
							<strong>					
								按选择检索条件排名
							</strong>
						<table class="table table-striped tablesorter text-center" style="width:100%; border: 1px solid #ddd;">
							<thead>
								<tr>
									<th class="text-center w-100px">序号</th>
									<th class="text-center w-180px">用户名(ID)</th>
									<th class="text-center w-180px">推荐人数</th>
								</tr>
							</thead>
							<tbody>
								<volist name="list" id="vo" key="key">
									<tr>
										<td>{$key}</td>
										<td><a href="{:U('Member/index',array('member_id'=>$vo['pid']))}">{$vo.pname}({$vo.pid})</a></td>
										<td>{$vo.num}</td>
									</tr>
								</volist>
							</tbody>
						</table>
				</div>
				<div class="fl" style="padding-bottom:10px; width:32%; margin-left:10px;">
							<strong>					
								最新周排名
							</strong>
						<table class="table table-striped tablesorter text-center" style="width:100%; border: 1px solid #ddd;">
							<thead>
								<tr>
									<th class="text-center w-100px">序号</th>
									<th class="text-center w-180px">用户名(ID)</th>
									<th class="text-center w-180px">推荐人数</th>
								</tr>
							</thead>
							<tbody>
								<volist name="tomonth" id="vo" key="key">
									<tr>
										<td>{$key}</td>
										<td><a href="{:U('Member/index',array('member_id'=>$vo['pid']))}">{$vo.pname}({$vo.pid})</a></td>
										<td>{$vo.num}</td>
									</tr>
								</volist>				
                             </tbody>
						</table>
				</div>
				<div class="fl" style="padding-bottom:10px; width:32%; margin-left:10px;">
							<strong>					
								最新月排名
							</strong>
						<table class="table table-striped tablesorter text-center" style="width:100%; border: 1px solid #ddd;">
							<thead>
								<tr>
									<th class="text-center w-100px">序号</th>
									<th class="text-center w-180px">用户名(ID)</th>
									<th class="text-center w-180px">推荐人数</th>
								</tr>
							</thead>
							<tbody>
								<volist name="week" id="vo" key="key">
									<tr>
										<td>{$key}</td>
										<td><a href="{:U('Member/index',array('member_id'=>$vo['pid']))}">{$vo.pname}({$vo.pid})</a></td>
										<td>{$vo.num}</td>
									</tr>
								</volist>	
							</tbody>
						</table>
				</div>
			</div>				
			<div>
				<div style="float:right; clear:none;" class="page form-inline">
					<div class="pagination"></div>
				</div>
			</div>
			</div>	
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

<script>
function pass(id){
	layer.confirm(
	'确定通过审核', 
	{btn:['确定','取消']},
	function(){
	  $.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":1},function(data){
		  if(data.status==0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
	}
	),
	function(){
		layer.msg('已取消');
	}
}

function fail(id){
	layer.confirm(
	'确定不通过审核', 
	{btn: ['确定','取消'],},
	function(){
		//href="{:U('Pay/payUpdate',array('pay_id'=>$vo['pay_id'],'status'=>1))}			
		$.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":2},function(data){
				if(data.status == 0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
					
				}else if(data.status == 2){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
		}
		),
	 function(){
		layer.msg('已取消');
	}
}
</script>
<script>
$(".sub-menu").eq(11).show();
$(".sub-menu").eq(11).children("li").eq(0).addClass("on");
</script>

93:F:\git\coin\bisheng commerce\App\Admin\View\Tongji\xiangxi.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">第三方充值记录</span></div>
        </div>
        <!-- <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Pay/payByMan')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="status" id="">
											<option value="">全部</option>
											<option value="0">未付款</option>
											<option value="1">充值成功</option>
											<option value="2">充值失败</option>
											<option value="3">已失效</option>
										</select>
									</td>
									<th width="70">汇款人:</th>
									<td><input class="common-text" placeholder="汇款人" name="member_name" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form> 
					</div>
				</div>
			</div>
        </div> -->
				<div class="panel-actions" style="height:50px;">
                <h1 class="fl" style="line-height:50px; margin-left:20px;">
					<i class="icon-font"></i>
					数据统计状况
				</h1>
				    <form action="{:U('Tongji/xiangxi')}" method="post" class="form-inline form-search" style="fr">					
					<div class="fr" style="line-height:50px;">						
                       <input type="text" name="userid" value=""  class="form-control search-query" style="width:20%;" placeholder="会员id" title="会员id" /> 
								<input type="text" name="stime" class="stime" placeholder="开始时间：如2016-03-22" title="开始时间" readonly="" style="margin-right:20px;" onclick="laydate()">		
								<input type="text" name="etime" class="etime" placeholder="结束时间：如2016-04-21" title="结束时间" readonly="" style="margin-right:20px;" onclick="laydate()">

							<input type="submit" id="submit" class="btn btn-primary" value="搜索" data-loading="稍候..." style="margin-right:20px;">
					</div>
				  </form>
				</div>
        <div class="result-wrap">
        <!--余额统计-->
            <form name="myform" id="myform" method="post"></form>
                <div class="result-tab">
                
                <div class="panel-actions" style="height:50px;">
                <h1 class="fl" style="line-height:50px; margin-left:20px;">
					<i class="icon-font"></i>
					推广统计状况
				</h1>
				    <form action="/newadmin.php/Home/Member/commissionShow/" method="get" class="form-inline form-search" style="fr">					
					<div class="fr" style="line-height:50px;">						
                       <!-- <input type="text" name="userid" value=""  class="form-control search-query" style="width:20%;" placeholder="会员id" title="会员id" /> --> 
								<input type="text" name="stime" class="stime" placeholder="开始时间：如2016-03-22" title="开始时间" readonly="" style="margin-right:20px;" onclick="laydate()">		
								<input type="text" name="etime" class="etime" placeholder="结束时间：如2016-04-21" title="结束时间" readonly="" style="margin-right:20px;" onclick="laydate()">

							<input type="submit" id="submit" class="btn btn-primary" value="搜索" data-loading="稍候..." style="margin-right:20px;">
					</div>
				  </form>
				</div>
                
                    <div class="" style="overflow:hidden;">
				<div class="fl" style="padding-bottom:10px; width:56%; margin-left:15px;">
							<strong>					
								余额统计
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%; border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">总余额</th>
						<th class="text-center w-300px">3684余额</th>
                        <th class="text-center w-300px">实际余额</th>
					</tr>
				</thead>
				<tbody>	
					<volist name="alltj" id="vo" key="key">					
					<tr>
						<td class="text-right ">{$vo['paytj']['currency']['currency_mark']}</td>
						<td class="text-right">{$vo['paytj']['allnum']}</td>
						<td class="text-right"></td>
						<td class="text-right">{$vo['paytj']['allnum']}</td>  
					</tr>
					</volist>
                    </tbody>
			</table>
				</div>
                <!--冻结统计-->
				<div class="fl" style="padding-bottom:10px; width:40%; margin-left:10px;">
							<strong>					
								冻结统计
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">冻结统计</th>
						<th class="text-center w-300px">3684冻结</th>
                        <th class="text-center w-300px">实际冻结</th>
					</tr>
				</thead>
				<tbody>
					<volist name="alltj" id="vo" key="key">					
					<tr>
						<td class="text-right ">{$vo['paytj']['currency']['currency_mark']}</td>
						<td class="text-right">{$vo['paytj']['allcoldnum']}</td>
						<td class="text-right"></td>
						<td class="text-right">{$vo['paytj']['allcoldnum']}</td>  
					</tr>
					</volist>
				</tbody>
			</table>
				</div>
                </div>
                <!--用户余额-->
                <div class="" style="overflow:hidden;">
				<div class="fl" style="padding-bottom:10px; width:56%; margin-left:15px;">
							<strong>					
								用户余额
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%; border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">用户余额</th>
						<th class="text-center w-300px">用户冻结</th>
					</tr>
				</thead>
				<tbody>		
					<volist name="alltj" id="vo" key="key">					
					<tr>
						<td class="text-right ">{$vo['membertj']['currency']['currency_mark']}</td>
						<td class="text-right">{$vo['membertj']['allnum']|default='0.0000'}</td>
						<td class="text-right">{$vo['membertj']['allcoldnum']|default='0.0000'}</td>  
					</tr>
					</volist>				
				</tbody>
			</table>
				</div>
                <!--充值提现-->
				<div class="fl" style="padding-bottom:10px; width:40%; margin-left:10px;">
							<strong>					
								充值提现
							</strong>
				<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">充值</th>
						<th class="text-center w-300px">提现</th>
                        <th class="text-center w-300px">交易</th>
					</tr>
				</thead>
				<tbody>	
					<volist name="alltj" id="vo" key="key">					
					<tr>
						<td class="text-right ">{$vo['cztxtj']['currency']['currency_mark']}</td>
						<td class="text-right">{$vo['cztxtj']['txmoney']['txmoney']|default='0.0000'}</td>
                        <td class="text-right">{$vo['cztxtj']['czmoney']['czmoney']|default='0.0000'}</td> 
                         <td class="text-right">{$vo['cztxtj']['jymoney']['jymoney']|default='0.0000'}</td>  
					</tr>
					</volist>	
				</tbody>
			</table>
				</div>
                </div>
                <!--挂单交易-->
                <div style="overflow:hidden;">
                  <div style="padding-bottom:10px; width:97%; clear:both; margin-left:15px;">
							<strong>					
								挂单交易
							</strong>
			<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-80px">交易类型</th>
                        <th class="text-center w-80px">买入挂单量</th>
                        <th class="text-center w-80px">买入挂单额</th>
                        <th class="text-center w-80px">卖出挂单量</th>
                        <th class="text-center w-80px">卖出挂单额</th>
						<th class="text-center w-80px">买入交易量</th>
						<th class="text-center w-80px">买入交易额</th>
                        <th class="text-center w-80px">卖出交易量</th>
						<th class="text-center w-80px">卖出交易额</th>
					</tr>
				</thead>
				<tbody>
					<volist name="list" id="vo" key="key">	
					<tr>                     
						<td class="text-right ">{$vo['currency']['currency_mark']}_{$vo['trade_currency']['currency_mark']}</td>
						<td class="text-right ">{$trade[$key]['jiaoyinum']}</td>
                        <td class="text-right ">{$trade[$key]['jiaoyiprice']}</td>
                        <td class="text-right ">{$trade[$key]['jiaoyiprice']}</td>
                        <td class="text-right ">{$trade[$key]['jiaoyiprice']}</td>
                        <td class="text-right ">39666890.58940000</td>
                        <td class="text-right ">1457810.50958020</td>
                        <td class="text-right ">39666890.58940000</td>
                        <td class="text-right ">1457810.50958020</td>
					</tr>
					</volist>	
                    <tr>						
                        <th colspan="2" class="text-right ">合计</th>
                        <td class="text-right " colspan="2"></td>
					</tr>
					
				</tbody>
			</table>
				</div>
			</div>
            <!--游戏统计-->
            <div style="overflow:hidden;">
                  <div style="padding-bottom:10px; width:97%; clear:both; margin-left:15px;">
							<strong>					
								游戏统计
							</strong>
			<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
					<tr>
						<th class="text-center w-100px">币种</th>
                        <th class="text-center w-200px">投注</th>
						<th class="text-center w-200px">奖金</th>
						
					</tr>
				</thead>
				<tbody>					
					<tr>
						<td class="text-right ">VRC</td>
						<td class="text-right "></td>
                        <td class="text-right "></td>
                                          
					</tr><tr>
						<td class="text-right ">CNY</td>
						<td class="text-right "></td>
                        <td class="text-right "></td>
                                          
					</tr><tr>
						<td class="text-right ">FHG</td>
						<td class="text-right "></td>
                        <td class="text-right "></td>
                                          
					</tr><tr>
						<td class="text-right ">NEC</td>
						<td class="text-right "></td>
                        <td class="text-right "></td>
                                          
					</tr><tr>
						<td class="text-right ">BLK</td>
						<td class="text-right "></td>
                        <td class="text-right "></td>
                                          
					</tr><tr>
						<td class="text-right ">BC</td>
						<td class="text-right "></td>
                        <td class="text-right "></td>
                                          
					</tr>                    <tr>
						<th colspan="2" class="text-right ">合计</th>
                        <td colspan="2" class="text-right "></td>
					</tr>
					
				</tbody>
			</table>
				</div>
			</div>
            <!--计算-->
            <div style="overflow:hidden;">
                  <div style="padding-bottom:10px; width:97%; clear:both; margin-left:15px;">
							<strong>					
								计算
							</strong>
			<table class="table table-hover table-striped table-bordered" style="width:100%;border: 1px solid #ddd;">
				<thead>	
               		<tr>
						<th class="warning">币种 </th>
					</tr>
					<tr>
						<th class="warning">充值量-提现量+买入量-卖出量+奖金-投注量-挂单量</th>
					</tr>
					<tr>
						<th class="warning">用户余额</th>
					</tr>
				</thead>
				<tbody>	
					<tr>
                    	
						<td class="text-right ">VRC</td>
					</tr>
                    <tr>
                    	
						<td class="text-right ">44706356.232455                        
                        </td>
					</tr>
                    <tr></tr><tr>
                    	
						<td class="text-right ">CNY</td>
					</tr>
                    <tr>
                    	
						<td class="text-right ">3438487.9776789                        
                        </td>
					</tr>
                    <tr></tr><tr>
                    	
						<td class="text-right ">FHG</td>
					</tr>
                    <tr>
                    	
						<td class="text-right ">299826                        
                        </td>
					</tr>
                    <tr></tr><tr>
                    	
						<td class="text-right ">NEC</td>
					</tr>
                    <tr>
                    	
						<td class="text-right ">3249466                        
                        </td>
					</tr>
                    <tr></tr><tr>
                    	
						<td class="text-right ">BLK</td>
					</tr>
                    <tr>
                    	
						<td class="text-right ">5209500.7747685                        
                        </td>
					</tr>
                    <tr></tr><tr>
                    	
						<td class="text-right ">BC</td>
					</tr>
                    <tr>
                    	
						<td class="text-right ">14999152.9                        
                        </td>
					</tr>
                    <tr></tr>					
				</tbody>
			</table>
				</div>
			</div>
                     <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

<script>
function pass(id){
	layer.confirm(
	'确定通过审核', 
	{btn:['确定','取消']},
	function(){
	  $.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":1},function(data){
		  if(data.status==0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
	}
	),
	function(){
		layer.msg('已取消');
	}
}

function fail(id){
	layer.confirm(
	'确定不通过审核', 
	{btn: ['确定','取消'],},
	function(){
		//href="{:U('Pay/payUpdate',array('pay_id'=>$vo['pay_id'],'status'=>1))}			
		$.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":2},function(data){
				if(data.status == 0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
					
				}else if(data.status == 2){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
		}
		),
	 function(){
		layer.msg('已取消');
	}
}
</script>
<script>
$(".sub-menu").eq(11).show();
$(".sub-menu").eq(11).children("li").eq(2).addClass("on");
</script>

94:F:\git\coin\bisheng commerce\App\Admin\View\Tongji\yue.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">第三方充值记录</span></div>
        </div>
       <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Tongji/yue')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="currency_id" id="">
                        				<volist name="currencylist" id="vo" empty="$empty">
											<option value="{$vo['currency_id']}" <eq name='cur.currency_id' value="$vo.currency_id">selected</eq>>{$vo['currency_mark']}</option>
                      					  </volist>
										</select>
									</td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form> 
					</div>
				</div>
			</div>
        </div> 
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>编号</th>
                            <th>用户名(ID)</th>
                            <th>昵称</th>
                            <th>可用资产({$cur.currency_name})</th>
                            <th>冻结资产({$cur.currency_name})</th>
                            <th>总资产({$cur.currency_name})</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty" key="key">
                        <tr>
                            <td>{$key}</td>
                     		<td>{$vo.member.member_id}</td>
                     		<td>{$vo.member.name}</td>
                     		<td>{$vo.num}</td>
                     		<td>{$vo.forzen_num}</td>
                     		<td>{$vo.allmoney}</td>
                        </tr>
                        </volist>
                    </table>
                     <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>

<script>
function pass(id){
	layer.confirm(
	'确定通过审核', 
	{btn:['确定','取消']},
	function(){
	  $.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":1},function(data){
		  if(data.status==0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
	}
	),
	function(){
		layer.msg('已取消');
	}
}

function fail(id){
	layer.confirm(
	'确定不通过审核', 
	{btn: ['确定','取消'],},
	function(){
		//href="{:U('Pay/payUpdate',array('pay_id'=>$vo['pay_id'],'status'=>1))}			
		$.post("{:U('Pay/payUpdate')}",{"pay_id":id,"status":2},function(data){
				if(data.status == 0){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
					
				}else if(data.status == 2){
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}else{
					layer.msg(data['info']);
					setTimeout("location.reload()",2000);
				}
		})
		}
		),
	 function(){
		layer.msg('已取消');
	}
}
</script>
<script>
$(".sub-menu").eq(11).show();
$(".sub-menu").eq(11).children("li").eq(3).addClass("on");
</script>

95:F:\git\coin\bisheng commerce\App\Admin\View\Trade\orders.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">委托记录</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Trade/orders')}" method="post">
							<table class="search-tab">
								<tr>
                                    <th width="120">选择币种:</th>
                                    <td>
                                        <select name="currency_id" id="">
                                            <option value="0">全部</option>
                                            <volist name="currency" id="vo">
                                                <option value="{$vo['currency_id']}" >{$vo['currency_name']}</option>
                                            </volist>
                                        </select>
                                    </td>
									<th width="120">选择分类:</th>
									<td>
										<select name="status_id" id="">
                                            <option value="">全部</option>
											<option value="0">挂单</option>
                                            <option value="1">部分成交</option>
                                            <option value="2">成交</option>
										</select>
									</td>
									<th width="70">购买人:</th>
									<td><input class="common-text" placeholder="购买人email" name="email" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" value="查询" type="submit"></td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>委托编号</th>
                            <th>用户邮箱</th>
                            <th>币种</th>
                            <th>价格</th>
                            <th>挂单数量</th>
                            <th>成交数量</th>
							<th>手续费</th>
                            <th>类型</th>
                            <th>挂单时间</th>
                            <th>成交时间</th>
                            <th>状态</th>
							 <th>操作</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.orders_id}</td>
                            <td>{$vo.email}</td>
                            <td>{$vo.b_name}</td>
                            <td>{$vo.price}</td>
                            <td>{$vo.num}</td>
                            <td>{$vo.trade_num}</td>
                            <td>{$vo['num'] * $vo['fee'] * $vo['price']|number_format=###,4}</td>
                            <td>{$vo.type|getOrdersType=###}</td>
                            <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                            <td><empty name="vo['trade_time']">###<else/>{$vo.trade_time|date="Y-m-d H:i:s",###}</empty></td>
                            <td>{$vo.status|getOrdersStatus=###}</td>
							<td><if condition="($vo['status'] eq  2) or ($vo['status'] eq -1)">{$vo.status|getOrdersStatus=###}<else/><a href="javascript:void(0)"  onclick="cexiao({$vo.orders_id})">撤销</a></if></td>
                        </tr>
                        </volist>
                    </table>
                    <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
	function cexiao(_this){
		layer.confirm('确定撤销委托？', {
	  btn: ['确定','取消'], //按钮
	  title: '撤销委托'
	}, function(){
	  $.post('{:U('Trade/cancel')}',{status:-1,order_id:_this},function(data){
				   if(data['status'] == 2){
					   layer.msg(data['info']);
					   setTimeout(function(){location.reload();},1000);
				   }else{
					   layer.msg(data['info']);
				   }
			})
	}, function(){
	  layer.msg('已取消');
	});

	}
</script>
<script>
$(".sub-menu").eq(7).show();
$(".sub-menu").eq(7).children("li").eq(0).addClass("on");
</script>

96:F:\git\coin\bisheng commerce\App\Admin\View\Trade\trade.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">交易记录</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Trade/trade')}" method="post">
							<table class="search-tab">
								<tr>
                                    <th width="120">选择币种:</th>
                                    <td>
                                        <select name="currency_id" id="">
                                            <option value="0">全部</option>
                                            <volist name="currency" id="vo">
                                                <option value="{$vo['currency_id']}" >{$vo['currency_name']}</option>
                                            </volist>
                                        </select>
                                    </td>
                                    <th width="120">选择类型:</th>
                                    <td>
                                        <select name="type" id="">
                                            <option value="0">全部</option>
                                            <option value="buy" >买入</option>
                                            <option value="sell" >卖出</option>
                                        </select>
                                    </td>

									<th width="70">购买人:</th>
									<td><input class="common-text" placeholder="购买人email" name="email" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" value="查询" type="submit"></td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>成交编号</th>
                            <th>订单号</th>
                            <th>买家email</th>
                            <th>币种</th>
                            <th>数量</th>
                            <th>单价</th>
                            <th>总量</th>
							<th>手续费</th>
							<th>类型</th>
                            <th>成交时间</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.trade_id}</td>
                            <td>{$vo.trade_no}</td>
                            <td>{$vo.email}</td>
                            <td>{$vo.b_name}</td>
                            <td>{$vo.num}</td>
                            <td>{$vo.price}</td>
                            <td>{$vo.money}</td>
							<td>{$vo['fee']|number_format=###,4}</td>
                            <td>{$vo.type_name}</td>
                            <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                        </tr>
                        </volist>
                    </table>
                    <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(7).show();
$(".sub-menu").eq(7).children("li").eq(1).addClass("on");
</script>

97:F:\git\coin\bisheng commerce\App\Admin\View\Websitebank\addBank.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">银行卡管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Websitebank/addBank')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>银行卡添加</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
                        <tr>
                            <th width="15%"><i class="require-red">*</i>收款人：</th>
                            <td><input name="bank_name"  type="text"><span id="showBug" style=" margin-left:10px;color:#FF0000"></span></td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>账号：</th>
                            <td><input id="pwd" name="bank_no" type="text"></td>
                        </tr>
                        <tr>
                            <th><i class="require-red"></i>开户行：</th>
                            <td><input name="bank_adddress" type="text"></td>
                        </tr>
                        <tr>
                            <th></th>
                            <td>
                                <input type="button" onclick="subform()" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Websitebank/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
ckemail = 0;
/*$('#email').blur(function(){
	var path_Email = "{:U('Member/ajaxCheckEmail')}";
	$.ajax({
		type:"get",
		dataType:"json",
		data:{email:$('#email').val()},
		url:path_Email,
		success:function(d){
				if(d['status']==0){
					$('#showBug').html(d['msg']);
					$('#email').focus();
					return false;
				}else{
					$('#showBug').html(d['msg']);
					return ckemail = 1 ;
				}
			},
		});
});*/
function subform(){
	//if(ckemail==1){
		$('#myform').submit();
//	}else{
	//	$('#email').focus();
	//}
}
</script>

<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(1).show();
$(".sub-menu").eq(1).children("li").eq(1).addClass("on");
</script>

98:F:\git\coin\bisheng commerce\App\Admin\View\Websitebank\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">银行卡管理</span></div>
        </div>
        <div class="search-wrap">
            
        </div>
        <div class="result-wrap">

            <div class="result-title">
                <div class="result-list">
                    <a href="{:U('Websitebank/addBank')}"><i class="icon-font"></i>新增银行卡</a>
                </div>
            </div>
            <div class="result-content">
                <table class="result-tab" width="100%">
                    <tr>
                       
                        <th>收款人</th>
						<th>收款人账号</th>
                        <th>收款人开户行</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                    <volist name='list' id='vo'>
                        <tr>
                            <td>{$vo['bank_name']}</td>
                            <td>{$vo['bank_no']}</td>
							<td>{$vo['bank_adddress']}</td>
                            <td><if condition="$vo['status'] eq 1">
									开通
								</if>
								<if condition="$vo['status'] eq 2">
									关闭
								</if>
							
								</td>
                            <td>
                                <a class="link-update" href="{:U('Websitebank/saveBank',array('bank_id'=>$vo['bank_id']))}">修改|</a>
                               <!-- <a class="link-del" href="{:U('Websitebank/delBank',array('bank_id'=>$vo['bank_id']))}" onclick="return confirm('确认删除吗？')">删除</a>-->
								<a href="javascript:void(0)" class="link-del" onclick="cexiao({$vo.bank_id})">删除</a>
                            </td>
                        </tr>
                    </volist>

                </table>
                <div class="list-page"> <ul>{$page}</ul></div>
            </div>

        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
	function cexiao(_this){
		layer.confirm('确定删除银行卡？', {
	  btn: ['确定','取消'], //按钮
	  title: '撤销删除银行卡'
	}, function(){
	  $.post('{:U('Websitebank/delBank')}',{bank_id:_this},function(data){
				   if(data['status'] == 1){
					   layer.msg(data['info']);
					   setTimeout(function(){location.reload();},1000);
				   }else{
					   layer.msg(data['info']);
				   }
			})
	}, function(){
	  layer.msg('已取消');
	});

	}
</script>
<script>
$(".sub-menu").eq(1).show();
$(".sub-menu").eq(1).children("li").eq(0).addClass("on");
</script>

99:F:\git\coin\bisheng commerce\App\Admin\View\Websitebank\saveBank.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">银行卡管理</span></div>
    </div>
    <div class="result-wrap">

        <form action="{:U('Websitebank/saveBank')}" method="post"  enctype="multipart/form-data">
            <div class="config-items">
                <div class="result-content">
                    <table width="100%" class="insert-tab">
					<input type="hidden" value="{$list['member_id']}" name="member_id" />
                        <tbody>
						<tr>
                            <th>收款人：</th>
                            <td><input name="bank_name" value="{$list['bank_name']}" type="text"></td>
                        </tr>
						<if condition="$list['status']!=0 ">
                            <tr>
                                <th>账号：</th>
                                <td><input name="bank_no" id="nick" value="{$list['bank_no']}" type="text"></td>
                            </tr>
                           <input name="bank_id"  value="{$list['bank_id']}" type="hidden">
                            <tr>
                                <th>开户行：</th>
                                <td><input name="bank_adddress" id="idcard" value="{$list['bank_adddress']}" type="text"></td>
                            </tr>
							</if>
                        <tr>
						 <tr>
                                <th>状态</th>
                                <td>
								<input type="radio" value="1" <if condition="$list['status'] eq 1">checked="checked"</if> name="status" />开通&nbsp;<input type="radio" value="2" <if condition="$list['status'] eq 2">checked="checked"</if> name="status" />关闭</td>				
                            </tr>
                            <th></th>
                            <td>
                                <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Member/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody></table>
                </div>
            </div>
        </form>
    </div>
</div>

<!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(1).show();
$(".sub-menu").eq(1).children("li").eq(0).addClass("on");
</script>

100:F:\git\coin\bisheng commerce\App\Admin\View\Zhongchou\add.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
	
    <div class="main-wrap">
        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href=":U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">众筹设置</span></div>
        </div>
        <div class="result-wrap">
            <form action="{:U('Zhongchou/add')}" method="post" id="myform" name="myform" enctype="multipart/form-data">
                <div class="config-items">
                    <div class="config-title">
                        <h1><i class="icon-font">&#xe00a;</i>众筹详细信息设置</h1>
                    </div>
                    <div class="result-content">
                        <table width="100%" class="insert-tab">
                            <tbody>
                            <tr>
                                <th width="15%"><i class="require-red">*</i>图片1：</th>
                                <td><img style="width:400px;" src="{$list.url1}"><input type="hidden" name="url1" value="{$list.url1}" class="common-text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>众筹封面图片上传：</th>
                                <td><input type="file" name="Filedata1" class="common-text"></td>
                            </tr>
                            <tr>
                                <th width="15%"><i class="require-red">*</i>图片2：</th>
                                <td><img style="width:400px;" src="{$list.url2}"><input type="hidden" name="url2" value="{$list.url2}" class="common-text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>众筹详情图片上传：</th>
                                <td><input type="file" name="Filedata2" class="common-text"></td>
                            </tr>
                            <tr>
                                <th><i class="require-red">*</i>需下载文件上传：</th>
                                <td><input type="file" name="wenjian_url" class="common-text"></td>
                            </tr>
                            <tr>
                                    <th><i class="require-red">*</i>标题：</th>
                                    <td><input type="text" id="" value="{$list.title}" size="85" name="title" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>众筹币种：</th>
                                    <td>
                                    <select name="currency_id">
                                    	<volist name='currency' id='vo'>
                                        <option value="{$vo.currency_id}"
                                                <if condition="$list.currency_id eq $vo.currency_id ">selected="selected"</if>
                                        class="common-text">{$vo.currency_name}</option>
                                        </volist>
                                    </select>
                                    </td>
                                </tr>
                            <tr>
                                <th><i class="require-red">*</i>众筹购买币种：</th>
                                <td>
                                    <select name="buy_currency_id">
                                        <option value="0"  <if condition="$list.buy_currency_id eq 0 ">selected="selected"</if> >人民币</option>
                                        <volist name='currency' id='vo'>
                                            <option value="{$vo.currency_id}"
                                                <if condition="$list.buy_currency_id eq $vo.currency_id ">selected="selected"</if>
                                                class="common-text">{$vo.currency_name}
                                            </option>
                                        </volist>
                                    </select>
                                </td>
                            </tr>

                              <tr>
                                <th><i class="require-red">*</i>众筹获得币种是否冻结：</th>
                                <td>
                                    <select name="is_forzen" onchange="show_bl();" id="re_forzen">
                                       <option value='0'>冻结</option>
                                       <option value='1'>可用</option>
                                    </select>
                                    <span id="re_span">&nbsp;&nbsp;&nbsp;&nbsp;解冻比例：<input type="text" name="remove_forzen_bili" value="{$list['remove_forzen_bili']|default=0}" class="common-text" id="re_bl"/>%</span>
                                    <span id="re_cycle">&nbsp;&nbsp;&nbsp;&nbsp;解冻周期：<input type="text" name="remove_forzen_cycle" value="{$list['remove_forzen_cycle']|default=0}" class="common-text" id="re_bl"/>天</span>
                                </td>
                                
                            </tr>
                                <tr>
                                    <th><i class="require-red">*</i>众筹发售量：</th>
                                    <td><input type="text" id="" value="{$list.num}" size="85" name="num" class="common-text"><input type="hidden" id="" value="{$list.id}" size="85" name="id" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>众筹保留量：</th>
                                    <td><input type="text" id="" value="{$list.num_nosell}" size="85" name="num_nosell" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>众筹价格：</th>
                                    <td><input type="text" id="" value="{$list.price}" size="85" name="price" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>每人限购：</th>
                                    <td><input type="text" id="" value="{$list.limit}" size="85" name="limit" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>最低购买：</th>
                                    <td><input type="text" id="" value="{$list.min_limit}" size="85" name="min_limit" class="common-text"></td>
                                </tr>
                                <tr>
                                    <th><i class="require-red">*</i>限购次数：</th>
                                    <td><input type="text" id="" value="{$list.limit_count}" size="85" name="limit_count" class="common-text"></td>
                                </tr>
                                 <tr>
                                    <th><i class="require-red">*</i>众筹成功比例：</th>
                                    <td><input type="text" id="" value="{$list.zhongchou_success_bili}" size="85" name="zhongchou_success_bili" class="common-text">%</td>
                                </tr>
                              	<tr>
                                    <th><i class="require-red">*</i>抢购时间：</th>
                                    <td>
                            
                                    <div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="add_time" class="ui_timepicker" id="aaaaa1" placeholder="选择日期时间" value="{$list.add_time|date='Y-m-d H:i:s',###}"  />
                                                </div></div></td>
                                  </tr>
                                  <script type="text/javascript">
                                    $(function () {
                                        $("#aaaaa1").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                            $("#aaaaa2").datetimepicker({
                                            //showOn: "button",
                                            //buttonImage: "./css/images/icon_calendar.gif",
                                            //buttonImageOnly: true,
                                            showSecond: true,
                                            timeFormat: 'hh:mm:ss',
                                            stepHour: 1,
                                            stepMinute: 1,
                                            stepSecond: 1
                                        })
                                   
                                    })
                                </script>
                                  <tr>
                                    <th><i class="require-red">*</i>结束时间：</th>
                                    <td><div class="row"><div class="col-md-6">
                                                    <i class="fa fa-calendar"></i></span>
                                                    <input type="text" name="end_time" class="ui_timepicker" id="aaaaa2" placeholder="选择日期时间" value="{$list.end_time|date='Y-m-d H:i:s',###}" / >
                                                </div></div></td>
                            
                                  </tr>
                                  <tr>
                                    <td>认购介绍</td>
                                    <td><textarea name="info" cols=100 rows=20>{$info}</textarea>
                                    </td>
                                  </tr>
                             
                                <tr>
                                    <th></th>
                                    <td>
                                    	<input type="hidden" value="{$list.id}" name="id">
                                        <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                        <a href="{:U('Zhongchou/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                                    </td>
                                </tr>
                            </tbody></table>
                    </div>
                </div>
                
            </form>
        </div>
    </div>
    <!--/main-->
</div>

<script language="javascript" src="/Public/plugin/kindeditor/jquery.tools.min.js"></script>
<script language="javascript" src="/Public/plugin/kindeditor/kindeditor-min.js"></script>
<script language="javascript" src="/Public/plugin/kindeditor/zh_CN.js"></script>
<script language="javascript">
$(document).ready(function(){
    $('#all').click(function(){
	    $('.id').attr('checked',true);
	});
	$('#all_return').click(function(){
	    $('.id').attr('checked',false);
	});
    $('#dels').click(function(){

		f = 0;
	    $('.id').each(function(){
		    if($(this).attr('checked')) f = 1;
		});
		
        if(f==0){
		    alert('请选择要删除的项！');
		}else{
		    $('#formid').submit();
		}
	});
	$('#add').click(function(){
	    location.href="?s=Admin/Issue/add";
	});
});

var editor;
KindEditor.ready(function(K) {
	editor = K.create('textarea[name="info"]', {
		resizeType : 1,
		allowPreviewEmoticons : false,
		allowImageUpload : true,
		items : [
			'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline',
			'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
			'insertunorderedlist', '|', 'image', 'link']
	});
});
</script>
<script>
	function show_bl(){
		if($('#re_forzen').val()==0){
			$('#re_span').show();
			$('#re_bl').attr("disabled",false);
			$('#re_cycle').show();
		}else{
			$('#re_span').hide();
			$('#re_bl').attr("disabled",true);
			$('#re_cycle').hide();
		}
		
	}
</script>
</body>
</html>
<script>
$(".sub-menu").eq(5).show();
$(".sub-menu").eq(5).children("li").eq(0).addClass("on");
</script>

101:F:\git\coin\bisheng commerce\App\Admin\View\Zhongchou\awards.html
<include file="App/Admin/View/Public/left.html"/>
<!--/sidebar-->
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">推荐奖励管理</span></div>
    </div>
    <div class="result-wrap">
        <form action="{:U('Zhongchou/awards')}" method="post" id="myform" name="myform">
            <div class="config-items">
                <div class="config-title">
                    <h1><i class="icon-font">&#xe00a;</i>推荐奖励管理</h1>
                </div>
                <div class="result-content">
                    <table width="100%" class="insert-tab">
                        <tbody>
						<input type="hidden" name="id" value="{$list.id}" />
                        <tr>
                            <th width="15%"><i class="require-red">*</i>奖励币种：</th>
                            <td>
                                <select name="zc_awards_currency_id">
                                    <volist name="currency" id="vo">
                                        <option value="{$vo['currency_id']}" <eq name="vo.currency_id" value="$list['zc_awards_currency_id']">selected="selected"</eq> >{$vo['currency_name']}</option>
                                    </volist>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>一级奖励比例：</th>
                            <td><input name="zc_awards_one_ratio" value="{$list['zc_awards_one_ratio']}" type="text">%&nbsp;&nbsp;无比例请填写 0</td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>二级奖励比例：</th>
                            <td><input name="zc_awards_two_ratio" value="{$list['zc_awards_two_ratio']}" type="text">%&nbsp;&nbsp;无比例请填写 0</td>
                        </tr>
                        <tr>
                            <th><i class="require-red">*</i>是否开启奖励：</th>
                            <td><input type="radio" value="1" <eq name="list.zc_awards_status" value="1">checked="checked"</eq> name="zc_awards_status" >开启
                                <input type="radio" value="0" <eq name="list.zc_awards_status" value="0">checked="checked"</eq>name="zc_awards_status" >关闭</td>
                        </tr>
                        <tr>
                            <th></th>
                            <td>
                                <input type="submit" value="提交" class="btn btn-primary btn6 mr10">
                                <a href="{:U('Zhongchou/index')}"><input type="button" value="返回"  class="btn btn6"></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </form>
    </div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>
    $(".sub-menu").eq(5).show();
    $(".sub-menu").eq(5).children("li").eq(0).addClass("on");
</script>

102:F:\git\coin\bisheng commerce\App\Admin\View\Zhongchou\awardsList.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">众筹个人记录</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
        </div>
        <div class="result-wrap">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>编号</th>
                            <th>奖励人员</th>
                            <th>内容</th>
                            <th>奖励币种</th>
                            <th>奖励钱数</th>
                            <th>时间</th>
                        </tr>
                        <volist name="list" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.finance_id}</td>
                            <td>{$vo['member_id']|getMemberEmailByMember_id=###}</td>
                            <td>{$vo.content}</td>
                            <td>{$vo['currency_id']|getCurrencynameByCurrency=###}</td>
                            <td>{$vo.money}</td>
                            <td>{$vo['add_time']|date='Y-m-d H:i:s',###}</td>
                        </tr>
                        </volist>
                    </table>
					 <div class="list-page"> <ul>{$page}</ul></div>
                </div>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(5).show();
$(".sub-menu").eq(5).children("li").eq(2).addClass("on");
</script>

103:F:\git\coin\bisheng commerce\App\Admin\View\Zhongchou\index.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">众筹管理</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
            </div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-title">
                    <div class="result-list">
                        <a href="{:U('Zhongchou/add')}"><i class="icon-font"></i>添加众筹</a>
                    </div>
                </div>
                <div class="result-content">
                    <table class="result-tab" width="100%">
                         <tr>
                         	  <th >币种编号</th>
                              <th >众筹名称</th>	
                              <th >众筹币种</th>
                              <th >购买币种</th>
                              <th >众筹保留量</th>
                              <th >众筹发售量</th>
                              <th >众筹剩余量</th>
                              <th >众筹价格</th>
                              <th >每人限购</th>
                               <th >成功比例</th>
                               <th>开始时间</th>
                               <th>结束时间</th>
                              <th>状态</th>
                              <th>操作</th>
                            </tr>
                            <volist name="list" id="vo">
                              <tr>
                                <td>{$vo.id|default='0'}</td>
                                <td>{$vo.title|default='0'}</td>
                                <td>{$vo.name|default='0'}</td>
                                <td>{$vo.buy_currency_id|getCurrencynameByCurrency=###}</td>
                                <td>{$vo.num_nosell|default='0'}</td>
                                <td>{$vo.num|default='0'}</td>
                                <td>{$vo.deal|default='0'}</td>
                                <td>{$vo.price|default='0'}</td>
                                <td>{$vo.limit|default='0'}</td>
                                <td>{$vo.zhongchou_success_bili|default='0'}%</td>
                                <td>{$vo.add_time|date='Y-m-d H:i:s',###}</td>
                                <td>{$vo.end_time|date='Y-m-d H:i:s',###}</td>
                                <td>{$vo.status|zhongchouStatus=###}</td>
                                <td><a href="{:U('Zhongchou/add',array('id'=>$vo['id']))}">修改</a> <a href="{:U('Zhongchou/del',array('id'=>$vo['id']))}">删除</a> <a href="{:U('Zhongchou/zhongchouEnd',array('id'=>$vo['id']))}">结束众筹</a>&nbsp;<a href="{:U('Zhongchou/zhongchouStart',array('id'=>$vo['id']))}">开启众筹</a>
                                <a href="{:U('Zhongchou/awards',array('id'=>$vo['id']))}">添加众筹推荐奖励</a></td>
                              </tr>
                            </volist>
                            <tr>
                              <td colspan=12 class="page">{$page}</td>
                            </tr>
                    </table>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
$(".sub-menu").eq(5).show();
$(".sub-menu").eq(5).children("li").eq(0).addClass("on");
</script>

104:F:\git\coin\bisheng commerce\App\Admin\View\Zhongchou\log.html
    <include file="App/Admin/View/Public/left.html"/>
    <!--/sidebar-->
    <div class="main-wrap">
		

        <div class="crumb-wrap">
            <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">众筹个人记录</span></div>
        </div>
        <div class="search-wrap">
            <div class="search-content">
				<div class="search-wrap">
					<div class="search-content">
						<form action="{:U('Zhongchou/log')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="iid" >
											<option value="0">全部</option>
											<volist name='issue' id='vo'>
											<option value="{$vo.id}">{$vo.title}</option>
											</volist>
										</select>
									</td>
									<th width="70">用户姓名:</th>
									<td><input class="common-text" placeholder="用户姓名" name="name" value="" id="" type="text"></td>
                                    <th width="70">用户ID:</th>
									<td><input class="common-text" placeholder="用户ID" name="uid" value="" id="" type="text"></td>
                                    <th width="70">用户邮箱:</th>
									<td><input class="common-text" placeholder="用户邮箱" name="email" value="" id="" type="text"></td>
									<td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
								</tr>
							</table>
						</form>
                        <form action="{:U('Zhongchou/jiedongByIid')}" method="post">
							<table class="search-tab">
								<tr>
									<th width="120">选择分类:</th>
									<td>
										<select name="iid" id="zhongchouid">
											<option value="0">全部</option>
											<volist name='issue' id='vo'>
											<option value="{$vo.id}">{$vo.title}</option>
											</volist>
										</select>
									</td>
									<td><input class="btn btn-primary btn2" name="sub" value="开始解冻" type="button" onclick="kaishijiedong()">（按照比例开始第一次解冻）</td>
									<td><input class="btn btn-primary btn2" name="sub" value="解冻该众筹" type="submit">（解冻当前选择众筹全部币种）</td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
        </div>
        <div class="result-wrap">
            <form name="myform" id="myform" method="post">
                <div class="result-content">
                    <table class="result-tab" width="100%">
                        <tr>
                            <th>众筹编号</th>
                            <th>众筹名称</th>
                            <th>购买人</th>
                            <th>购买数量</th>
                            <th>冻结数量</th>
                            <th>单价</th>
                            <th>购买总额</th>
                            <th>时间</th>
                            <th>购买花费币种类型</th>
                            <th>操作</th>
                        </tr>
                        <volist name="log" id="vo" empty="$empty">
                        <tr>
                            <td>{$vo.iid}</td>
                            <td>{$vo.title}</td>
                            <td>{$vo.name}</td>
                            <td>{$vo.num}</td>
                             <td>{$vo.deal}</td>
                            <td>{$vo.price}</td>
                            <td>{$vo.count}</td>
                            <td>{$vo.add_time|date="Y-m-d H:i:s",###}</td>
                            <td>[{$vo.buy_name}]</td>
                            <td><a href="{:U('Zhongchou/jiedongById',array('id'=>$vo['id']))}">解冻</a></td>
                        </tr>
                        </volist>
                    </table>
					 <div class="list-page"> <ul>{$page}</ul></div>
                </div>
            </form>
        </div>
    </div>
    <!--/main-->
</div>
</body>
</html>
<script>
	function kaishijiedong(){
		layer.confirm('确定开始解冻？', {
	  btn: ['确定','取消'], //按钮
	  title: '开始解冻'
	}, function(){
	  $.post("{:U('Zhongchou/jiedong_start')}",{iid:$('#zhongchouid').val()},function(data){
				   if(data['status'] == 2){
					   layer.msg(data['info']);
					   setTimeout(function(){location.reload();},1000);
				   }else{
					   layer.msg(data['info']);
				   }
			})
	}, function(){
	  layer.msg('已取消');
	});

	}
</script>
<script>
$(".sub-menu").eq(5).show();
$(".sub-menu").eq(5).children("li").eq(1).addClass("on");
</script>

105:F:\git\coin\bisheng commerce\App\Common\Api\index.html
<include file="App/Home/View/Public/header.html"/>
<!--top end-->
<!--header end-->
<style>
.pull-left{ float:left;}
.pull-right{ float:right;}
.link a{ color:#000;}
.link{ margin:0px auto; width:100%;}
.on{ border-top-color:rgb(255, 121, 80); }
.on2{ border-bottom-color:rgb(255, 121, 80);}
</style>
<script type="text/javascript" src="__PUBLIC__/Home/js/focus.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/Fnc.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/zc.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/bootstrap.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/jquery.flexslider-min.js"></script>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Home/css/hb_index.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Home/css/zc.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Home/css/flexslider.css">
<!--banner start-->
<div style="height:360px; width:100%; position:relative; overflow:hidden; min-width:1200px;">

<div>
	<div class="flexslider">
		<ul class="slides">
			<volist name='flash' id='vo'>
            	<li><a><img src="{$vo.pic}" alt="{$vo.title}" style="height:320px;"></a></li>
            </volist>
		</ul>
	</div>
	<div class="ybcoin_volume">
    <empty name="member">
        <div style="color:#fff;">
        <form class="form-horizontal m-t"  id="signupForm" jump-url="{:U('Safe/index')}" method="post"  action="{:U('Login/checkLog')}">
			<p style=" font-size:18px; margin-bottom:5px;">登录</p>
			<input  name="username" id="username"  type="text" style="width:258px; height:40px; background-color:#FFF; border:1px solid #adadad;" placeholder="用户名">
			<span class="note" id="emailmsg" style="color:red"></span>
            <input name="pwd" id="pwd" type="password" style="width:258px; height:40px; background-color:#FFF; border:1px solid #adadad; margin-top:10px;" placeholder="密码">
			 <span class="note" id="pwdmsg" style="color:red"></span>
		</div>
					<div class="news_coin"><input class="denglu" value="登录" style="border:0;margin-top:10px;width:260px;" type="button" onclick="checkform()"   >
					</div>
					
        </form>
			<p class="coin_reg"><a style=" float:left" href="{:U('Oauth/index',array('type'=>'qq'))}">QQ登录</a><a style="margin-left:55px;" href="{:U('Reg/reg')}" class="left">免费注册</a><a href="{:U('Login/findPwd')}" class="right">忘记密码</a></p>
            
			</div> 
            <else/>
            <div>
            	<p style="font-size:18px; color:#FFF;">欢迎使用币时代</p>
                <p style="font-size:14px; color:#FFF; margin-top:15px;">您正在使用的账号为：
                	<br><span style="font-size:14px; color:#ff5200;">{$member.username}</span>
                </p>
                <p style="font-size:14px; color:#FFF; margin-top:5px;">ID：
                	<span style="font-size:14px; color:#ff5200;">{$member.member_id}</span>
                </p>
                <p style="font-size:14px; color:#FFF; margin-top:5px;">总资产：
                	<span style="font-size:14px; color:#ff5200;">{$allmoneys|number_format=###,4}</span>
                </p>
                <a href="{:U('User/pay')}" style=" float:left; background-color:#FFF; border:1px solid #f79c6b; width:70px; height:30px; color:#ff5200; line-height:30px; text-align:center; margin-top:15px;">充值</a>
                <a href="{:U('User/draw')}" style="float:left; background-color:#FFF; border:1px solid #f79c6b; width:70px; height:30px; color:#ff5200; line-height:30px; text-align:center; margin-top:15px; margin-left:20px;">提现</a>
                <a href="{:U('Entrust/manage')}" style="float:right; background-color:#FFF; border:1px solid #f79c6b; width:70px; height:30px; color:#ff5200; line-height:30px; text-align:center; margin-top:15px;">委托管理</a>
                <div style="clear:both"></div>
                <a href="{:U('Finance/index')}" style=" float:left; background-color:#ff5200;width:260px; height:40px; color:#FFF;line-height:40px; text-align:center; margin-top:15px; font-size:16px;">去财务中心</a>
                </div>
            </div>
            </empty>
</div>
</div>
<!--banner end-->
<div class="ybcoin_section clearfix" style="border:0;">
<div style="color:#ff5200; margin-top:20px;">币时代友情提示：请控制风险，不要投入超过您风险承受能力的资金，不要投资您所不了解的数字货币，拒绝传销组织，警惕虚假宣传。</div>
    <!--币币交易开始-->
    <div id="tags_coin" class="coinarea left" style="position:relative;">
        <!--<ul id="tags" class="for_coin">
            <li class="selectTag"><a onmouseover="selectTag('tagContent0',this)">对CNY交易区</a></li>
            <li><a onmouseover="selectTag('tagContent3',this)">对TRMB交易区</a></li>
            </ul>
        -->
        <div class="bgcolor" style="display:none;"></div>
        <div style="margin-top:30px;" id="tagContent">
            <!-- 对CNY交易区 结束-->
            <div class="tagContent selectTag" id="tagContent0">
                 <p style="color:#f00; font-size:14px; margin-bottom:10px;">{$config.friendship_tips}</p>
                <table class="coin_list coinarea" border="0" cellpadding="0" cellspacing="0">
                    <thead>
                   <tr>
                        <th>&nbsp;</th>
                        <th style="text-align:left;width: 159px;">币种</th>
                        <th class="header">最新成交价格
                        	
                        </th>
                        <th class="header">24H成交量
                        	
                        </th>
                        <th class="header">24H成交额(CNY)
                       
                        </th>
                        <th class="header">日涨跌
                        
                        </th>
                        <th class="header">价格趋势(7日)
                        </th>
                        <th class="header"></th>
                        <th class="header"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <volist name='currency' id='vo' empty='$empty'>
                        <tr class="coin_num">
                            <td><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}"><img src="{$vo.currency_logo}" style="width:20px; height:20px;"></a></td>
                            <td class="coin_name" style="font-family:黑体;"><a  style="float:left;" href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}">{$vo.currency_name|default='虚拟币'}{$vo.currency_mark|default=''}</a></td>
                            <td><eq name='vo.new_price_status' value='0' ><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}" class="buy"><else/>
							<a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}" class="sell"></eq>
                                {$vo.new_price|default='暂无'}<eq name='vo.new_price_status' value='0'>↓<else/>↑</eq></a></td>
                            <td><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}">{$vo.24H_done_num|number_format=###,4}</a></td>
                            <td><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}">{$vo.24H_done_money|number_format=###,4}</a></td>
                            <td><gt name='vo.24H_change' value='0'><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}" class="sell"><else/><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}" class="buy"></gt>{$vo.24H_change|default='0'}%</a></td>
                            <td><gt name='vo.7D_change' value='0'><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}" class="sell"><else/><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}" class="buy"></gt>{$vo.7D_change|default='0'}%</a></td>
                           <td class="qjy_box"><a href="{:U('Orders/index',array('currency'=>$vo['currency_mark']))}">去交易</a></td>
                        </tr>
                    </volist>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!--币币交易结束-->
    <!--<div class="right coin_news">
        <div class="news_title clearfix">
            <h2 class="left">官方公告</h2>
            <a href="{:U('Art/index',array('id'=>'1'))}" class="right">更多</a>
        </div>
        <ul>
            <volist name="info_red1" id="vo_red1">
                <li>
                    <a href="{:U('Art/details',array('id'=>$vo_red1['article_id']))}">
                        <span class="coin_news_title left" style="color:red;font-weight:bold;">{$vo_red1.title}</span>
                        <span class="right">{$vo_red1.add_time|date='m-d',###}</span>
                    </a>
                </li>
            </volist>
            <volist name="info1" id="vo1">
                <li>
                    <a href="{:U('Art/details',array('id'=>$vo1['article_id']))}">
                        <span class="coin_news_title left">{$vo1.title}</span>
                        <span class="right">{$vo1.add_time|date='m-d',###}</span>
                    </a>
                </li>
            </volist>
        </ul>
        <div class="news_title clearfix" style="margin-top:20px;">
            <h2 class="left">市场动态</h2>
            <a href="{:U('Art/index',array('id'=>'2'))}" class="right">更多</a>
        </div>
        <ul>
        <volist name="info_red2" id="vo_red2">
        
            <li>
                <a href="{:U('Art/details',array('id'=>$vo_red2['article_id']))}">
                    <span class="coin_news_title left" style="color:red;font-weight:bold;">{$vo_red2.title}</span>
                    <span class="right">{$vo_red2.add_time|date='m-d',###}</span>
                </a>
            </li>
        </volist>
        </ul>-->
        <ul>
            <volist name="info2" id="vo2">
                <li><a href="{:U('Art/details',array('id'=>$vo2['article_id']))}"><span class="coin_news_title left">{$vo2.title}</span><span class="right">{$vo2.add_time|date='m-d',###}</span></a></li>
            </volist>
        </ul>
        <!--<div style="margin-top:20px;"><a href="https://www.gemwallet.com/" target="_blank"><img src="images/coin_gemwallet.jpg" alt="竞付宝"></a></div>-->
</div>
<div style="width:1200px; margin-left:auto; margin-right:auto; margin-top:10px;" class="gonggao">
	<div style="width:300px; margin-left:50px; float:left;">
    	<a style="font-size:20px; color:#333; line-height:60px;" href="{:U('Art/index',array('id'=>'127'))}">{$bsdtitle}</a><br>
		<volist name="bsd" id="vo">
        	<a style="font-size:12px; color:#333; line-height:25px;" href="{:U('Art/details',array('id'=>$vo['article_id']))}">{$vo.title}</a><br>
		</volist>
        <a style="font-size:12px; color:#333;line-height:25px;" href="{:U('Art/index',array('id'=>'127'))}">查看更多>></a><br>    
    </div>
    <div style="width:300px; margin-left:100px; float:left;">
    	<a style="font-size:20px; color:#333; line-height:60px;" href="{:U('Art/index',array('id'=>'128'))}">{$btbtitle}</a><br>
		<volist name="btb" id="vo">
        	<a style="font-size:12px; color:#333; line-height:25px;" href="{:U('Art/details',array('id'=>$vo['article_id']))}">{$vo.title}</a><br>
		</volist>
        <a style="font-size:12px; color:#333;line-height:25px;" href="{:U('Art/index',array('id'=>'128'))}">查看更多>></a><br>    
    </div>
    <div style="width:300px; margin-left:100px; float:left;">
    	<a style="font-size:20px; color:#333; line-height:60px;" href="{:U('Art/index',array('id'=>'129'))}">{$szbtitle}</a><br>
		<volist name="szb" id="vo">
        	<a style="font-size:12px; color:#333; line-height:25px;" href="{:U('Art/details',array('id'=>$vo['article_id']))}">{$vo.title}</a><br>
		</volist>
        <a style="font-size:12px; color:#333;line-height:25px;" href="{:U('Art/index',array('id'=>'129'))}">查看更多>></a><br>    
    </div>
</div>




<div style="clear:both;"></div>


<script type="text/javascript" src="__PUBLIC__/Home/js/coinindex.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/tab.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/slide.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/hb_lang.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/hb_sea.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/js/hb_hm.js"></script>
<script src="%EF%BF%A52717.80%20_%20%E3%80%90%E7%81%AB%E5%B8%81%E3%80%91%E8%99%9A%E6%8B%9F%E8%B4%A7%E5%B8%81%E4%BA%A4%E6%98%93_%E6%AF%94%E7%89%B9%E5%B8%81%E4%BA%A4%E6%98%93%E5%B9%B3%E5%8F%B0_%E8%99%9A%E6%8B%9F%E5%B8%81%E8%8E%B1%E7%89%B9%E5%B8%81_%E6%AF%94%E7%89%B9%E5%B8%81%E5%AE%98%E7%BD%91_files/page_glb_var.js"></script>
<script>
    seajs.use("dist/page_index");
    /**/
    function change_vcode(e) {
        e.src = "/account/captcha?" + Math.random();
    }
    /**/

</script>

<script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?18784dd00dc1c9774528d08ae7943072";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<!-- 成功案例 -->
<script>
$(".cagret-up").on("click",function(){
	$(".cagret").removeClass("on on2");
	$(this).addClass("on2");
});
<!--<div class="success-project">
    <div class="page-view">
         <div class="row">
           <p class="sp-title">众筹</p>
        </div>
        <div class="row" style="overflow: hidden;position: relative;">
            <span class="sp-prev"><img src="__PUBLIC__/Home/images/suc_left_arrow.png"></span>
            <span class="sp-next"><img src="__PUBLIC__/Home/images/suc_right_arrow.png"></span>

            <div class="sp-view">
            <volist name="issue_list" id="vo">
                <div style="width: 400px;" class="sp-wrap">
                    <div class="sp-box">
                        <a href="{:U('Zhongchou/details',array('id'=>$vo['id']))}" target="_blank">
                            <div class="sp-info">
                                <div class="pull-right pull-right1">
                                    <h4 style="font-weight: normal;font-size: 16px">{$vo['title']|mb_substr=###,0,8,'utf-8'}</h4>

                                    <p style="font-size: 12px;">{$vo['name']}</p>
                                </div>
                                <img src="{$vo['url1']}" style="width: 82px;height: 82px;">
                                <!--                                    <img src="--><!--" style="width: 82px;height: 82px;">-->
                   <!-- </div> 
                        </a>

                        <div class="sp-step">
                            <div class="pull-left sp-time">
                                <p><span>{$vo['end_time']|date="Y-m-d",###}</span></p>
                                <p><span>{$vo['add_time']|date="Y-m-d",###}</span></p>
                                <p><span>{$vo['ctime']|date="Y-m-d",###}</span></p>
                            </div>
                            <div class="pull-right">
                                <p>众筹完成</p>
                                <p>众筹开始</p>
                                <p>初创项目</p>
                            </div>
                        </div>
                    </div>
                </div>
            </volist>
                <!--<div style="width: 400px;" class="sp-wrap">-->
                    <!--<div class="sp-box">-->
                        <!--<a href="https://www.yuanbaohui.com/project_index/?id=209" target="_blank">-->
                            <!--<div class="sp-info">-->
                                <!--<div class="pull-right pull-right1">-->
                                    <!--<h4 style="font-weight: normal;font-size: 16px">第二次元宝币与太一股认...</h4>-->

                                    <!--<p style="font-size: 12px;">元宝币兑换太一股</p>-->
                                <!--</div>-->
                                <!--<img src="__PUBLIC__/Home/images/c3aa0c2605711db444b4fbf2fd235b4a.png" style="width: 82px;height: 82px;">-->
                                <!--&lt;!&ndash;                                    <img src="&ndash;&gt;&lt;!&ndash;" style="width: 82px;height: 82px;">&ndash;&gt;-->
                            <!--</div>-->
                        <!--</a>-->

                        <!--<div class="sp-step">-->
                            <!--<div class="pull-left sp-time">-->
                                <!--<p><span>2015-08-12</span></p>-->
                                <!--<p><span>2015-08-10</span></p>-->
                                <!--<p><span>2015-07-30</span></p>-->
                            <!--</div>-->
                            <!--<div class="pull-right">-->
                                <!--<p>众筹完成</p>-->
                                <!--<p>众筹开始</p>-->
                                <!--<p>初创项目</p>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
                <!---->
                <!--<div style="width: 400px;" class="sp-wrap">-->
                    <!--<div class="sp-box">-->
                        <!--<a href="https://www.yuanbaohui.com/project_index/?id=201" target="_blank">-->
                            <!--<div class="sp-info">-->
                                <!--<div class="pull-right pull-right1">-->
                                    <!--<h4 style="font-weight: normal;font-size: 16px">首次元宝币与太一股（A...</h4>-->


$(".cagret-down").on("click",function(){
	$(".cagret").removeClass("on on2");
	$(this).addClass("on");
});

</script>








                        <!--<div class="sp-step">-->
                            <!--<div class="pull-left sp-time">-->
                                <!--<p><span>2015-04-17</span></p>-->
                                <!--<p><span>2015-04-13</span></p>-->
                                <!--<p><span>2015-04-12</span></p>-->
                            <!--</div>-->
                            <!--<div class="pull-right">-->
                                <!--<p>众筹完成</p>-->
                                <!--<p>众筹开始</p>-->
                                <!--<p>初创项目</p>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
           <!-- </div>
        </div>
    </div>
</div> -->
<!-- 客服信息 -->
<div class="autobox">
    <ul class="web_service clear pl30">
        <li class="w265"><a id="BizQQWPA" href="{config['qqcode']}"><div class="web_service_pic service_1"></div><div class="web_service_pic_num"><p>{$config.qq|default="暂无"}</p><div class="qqsecvice">在线QQ客服</div></div></a></li>
        <li class="w245"><div class="web_service_pic service_2"></div><div class="web_service_pic_num"><p>{$config.tel|default="暂无"}</p><div>工作日:9-19时 节假日:9-18时</div></div></li>
        <li class="w265"><a href="{$config['weibo']}" target="_blank"><div class="web_service_pic service_3"></div><div class="web_service_pic_num"><p>{$config['weibo']|default="暂无"}</p><div>新浪官方微博</div></div></a></li>
        <li><div class="web_service_pic service_4"></div><div class="web_service_pic_num"><p>2群：{$config['qqqun2']|default="暂无"}</p><div class="h_underl">交流QQ群<!--  <a href="javascript:;" class="orange">查看更多</a>   --></div></div></li>
    </ul>
</div>



<div class="safety_tips">
    <div style="border-top:#d8d8d8 dotted 1px;width: 1000px; margin: 0 auto; margin-bottom: 20px;"></div>
    <h3>专业的安全保障</h3>
    <div class="autobox">
        <ul class="safety_tips_ul clear">
            <li>
                <img src="/Public/Home/images/safe_1.jpg" alt="" height="70" width="70">
                <h4>系统可靠</h4>
                <p>银行级用户数据加密、动态身份验证，多级风险识别控制，保障交易安全</p>
            </li>
            <li>
                <img src="/Public/Home/images/safe_2.jpg" alt="" height="70" width="70">
                <h4>资金安全</h4>
                <p>钱包多层加密，离线存储于银行保险柜，资金第三方托管，确保安全</p>
            </li>
            <li>
                <img src="/Public/Home/images/safe_3.jpg" alt="" height="70" width="70">
                <h4>快捷方便</h4>
                <p>充值即时、提现迅速，每秒万单的高性能交易引擎，保证一切快捷方便</p>
            </li>
            <li>
                <img src="/Public/Home/images/safe_4.jpg" alt="" height="70" width="70">
                <h4>服务专业</h4>
                <p>专业的客服团队，400电话和24小时在线QQ，VIP一对一专业服务</p>
            </li>
        </ul>
    </div>
</div>
<!--友情链接-->
<div class="link">
    <div class="linkbox">
        <h4>友情链接</h4>
        <ul>
            <volist name = "link_info" id = "vo">
                <li><a target="_blank" href="http://{$vo['url']}" style=" font-size:16px;">{$vo.name}</a> </li>
            </volist>

        </ul>
    </div>
</div>
<script>
    vali = {username: 0, pwd: 0};
    $('#username').bind('blur', function(){
        $.post("{:U('Login/checkIp')}",{username:$(this).val()},
                function(d){
                    if(d.status==1){
                        $("#birthcheck").show();
                        $('#birthmsg').html(d.msg);
                    }
                    if(d.status==2){
                        validateMsg('username',d.msg, vali.username = 0);
                    }else{
                        return validateMsg('username', '', vali.username = 1);
                    }
                }, 'json');

    });
    $('#pwd').bind('blur', function(){
        var pLen = $(this).val().length;
        if(pLen < 6 || pLen > 20) return validateMsg('pwd', '密码长度在6-20个字符之间', 0);
        return validateMsg('pwd', '', vali.pwd = 1);
    });
    function checkform(){
        if(vali.email==0){
            $('#username').focus();
            return false;
        }
        if(vali.pwd==0){
            $('#pwd').focus();
            return false;
        }
//       return true;
        $('#signupForm').submit();
    }
</script>
<script>
    $("#signupForm").validate({
        rules: {
        },
        messages: {
        },
        submitHandler:function(form){
            ajax_submit_form(form)
            return false;
        },
        invalidHandler: function() {  //不通过回调
            return false;
        }
    });
</script>
<script src="__PUBLIC__/Home/js/form.js"></script>
<!--footer start-->
<include file="App/Home/View/Public/footer.html"/>
<!--footer end-->
<script>
$(function() { 
    $(".flexslider").flexslider({
		directionNav: true,
		pauseOnAction: false
});
});

</script>

106:F:\git\coin\bisheng commerce\App\Common\Api\QQConnect.class.php
<?php
namespace Common\Api;
class QQConnect{
     /**
     * 获取QQconnect Login 跳转到的地址值
     * @return array 返回包含code state
     * 
**/ 
 public function login($app_id, $callback, $scope){
        $_SESSION['state'] = md5(uniqid(rand())); //CSRF protection
        $login_url = "https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=" 
            .$app_id. "&redirect_uri=" . urlencode($callback)
            . "&state=" . $_SESSION['state']
            . "&scope=".urlencode($scope);
//显示出登录地址
         header('Location:'.$login_url);

    }
    /**
     * 获取access_token值
     * @return array 返回包含access_token,过期时间的数组
     * */
private function get_token($app_id,$app_key,$code,$callback,$state){
        if($state !== $_SESSION['state']){
return false;
exit();
        }
           $url = "https://graph.qq.com/oauth2.0/token";
            $param = array(
                "grant_type"    =>    "authorization_code",
                "client_id"     =>    $app_id,
                "client_secret" =>    $app_key,
                "code"          =>    $code,
                "state"         =>    $state,
                "redirect_uri"  =>    $callback
            );
            $response = $this->get_url($url, $param);
            if($response == false) {
                return false;
            }
            $params = array();
            parse_str($response, $params);
            return $params["access_token"];
}
     
    /**
     * 获取client_id 和 openid
     * @param $access_token access_token验证码
     * @return array 返回包含 openid的数组
     * */
    private  function get_openid($access_token) {
        $url = "https://graph.qq.com/oauth2.0/me"; 
        $param = array(
            "access_token"    => $access_token
        );
        $response  = $this->get_url($url, $param);
        if($response == false) {
            return false;
        }
        if (strpos($response, "callback") !== false) {
            $lpos = strpos($response, "(");
            $rpos = strrpos($response, ")");
            $response  = substr($response, $lpos + 1, $rpos - $lpos -1);
        }
        $user = json_decode($response);
        if (isset($user->error) || $user->openid == "") {
            return false;
        }
        return $user->openid;
    }
    /**
     * 获取用户信息
     * @param $client_id
     * @param $access_token
     * @param $openid
     * @return array 用户的信息数组
     * */
    public function get_user_info($app_id,$token,$openid){
$url = 'https://graph.qq.com/user/get_user_info?oauth_consumer_key='.$app_id.'&access_token='.$token.'&openid='.$openid.'&format=json';
        $str = $this->get_url($url);
        if($str == false) {
        return false;
        }
        $arr = json_decode($str,true);
        return $arr;
}
 
     /**
     * 请求URL地址，返回callback得到返回字符串
     * @param $url qq提供的api接口地址
     * */
    
    public function callback($app_id, $app_key, $callback) {
    $code = $_GET['code'];
    $state = $_GET['state'];
    $token = $this->get_token($app_id,$app_key,$code,$callback,$state);
    $openid = $this->get_openid($token);
    if(!$token || !$openid) {
    return false;
    exit();
    }
       return array('openid' => $openid, 'token' => $token);
    }
    
    
    /*
     * HTTP GET Request
    */
    private  function get_url($url, $param = null) {
    if($param != null) {
    $query = http_build_query($param);
    $url = $url . '?' . $query;
    }
    $ch = curl_init();
    if(stripos($url, "https://") !== false){
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
    }
    
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1 );
    $content = curl_exec($ch);
    $status = curl_getinfo($ch);
    curl_close($ch);
    if(intval($status["http_code"]) == 200) {
    return $content;
    }else{
    echo $status["http_code"];
    return false;
    }
    }
    
    /*
     * HTTP POST Request
    */
    private  function post_url($url, $params) {
    $ch = curl_init();
    if(stripos($url, "https://") !== false) {
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
    }
    
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1 );
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $params);
    $content = curl_exec($ch);
    $status = curl_getinfo($ch);
    curl_close($ch);
    if(intval($status["http_code"]) == 200) {
    return $content;
    } else {
    return false;
    }
    }
}

107:F:\git\coin\bisheng commerce\App\Common\Common\class.phpmailer.php
<?php
/*~ class.phpmailer.php
.---------------------------------------------------------------------------.
|  Software: PHPMailer - PHP email class                                    |
|   Version: 2.3                                                            |
|   Contact: via sourceforge.net support pages (also www.codeworxtech.com)  |
|      Info: http://phpmailer.sourceforge.net                               |
|   Support: http://sourceforge.net/projects/phpmailer/                     |
| ------------------------------------------------------------------------- |
|    Author: Andy Prevost (project admininistrator)                         |
|    Author: Brent R. Matzelle (original founder)                           |
| Copyright (c) 2004-2007, Andy Prevost. All Rights Reserved.               |
| Copyright (c) 2001-2003, Brent R. Matzelle                                |
| ------------------------------------------------------------------------- |
|   License: Distributed under the Lesser General Public License (LGPL)     |
|            http://www.gnu.org/copyleft/lesser.html                        |
| This program is distributed in the hope that it will be useful - WITHOUT  |
| ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or     |
| FITNESS FOR A PARTICULAR PURPOSE.                                         |
| ------------------------------------------------------------------------- |
| We offer a number of paid services (www.codeworxtech.com):                |
| - Web Hosting on highly optimized fast and secure servers                 |
| - Technology Consulting                                                   |
| - Oursourcing (highly qualified programmers and graphic designers)        |
'---------------------------------------------------------------------------'

/**
 * PHPMailer - PHP email transport class
 * NOTE: Designed for use with PHP version 5 and up
 * @package PHPMailer
 * @author Andy Prevost
 * @copyright 2004 - 2008 Andy Prevost
 */

class PHPMailer {

  /////////////////////////////////////////////////
  // PROPERTIES, PUBLIC
  /////////////////////////////////////////////////

  /**
   * Email priority (1 = High, 3 = Normal, 5 = low).
   * @var int
   */
  public $Priority          = 3;

  /**
   * Sets the CharSet of the message.
   * @var string
   */
  public $CharSet           = 'UTF-8';

  /**
   * Sets the Content-type of the message.
   * @var string
   */
  public $ContentType       = 'text/plain';

  /**
   * Sets the Encoding of the message. Options for this are "8bit",
   * "7bit", "binary", "base64", and "quoted-printable".
   * @var string
   */
  public $Encoding          = '8bit';

  /**
   * Holds the most recent mailer error message.
   * @var string
   */
  public $ErrorInfo         = '';

  /**
   * Sets the From email address for the message.
   * @var string
   */
  public $From              = 'cs@zhangduoren.com';

  /**
   * Sets the From name of the message.
   * @var string
   */
  public $FromName          = '';

  /**
   * Sets the Sender email (Return-Path) of the message.  If not empty,
   * will be sent via -f to sendmail or as 'MAIL FROM' in smtp mode.
   * @var string
   */
  public $Sender            = '';

  /**
   * Sets the Subject of the message.
   * @var string
   */
  public $Subject           = '';

  /**
   * Sets the Body of the message.  This can be either an HTML or text body.
   * If HTML then run IsHTML(true).
   * @var string
   */
  public $Body              = '';

  /**
   * Sets the text-only body of the message.  This automatically sets the
   * email to multipart/alternative.  This body can be read by mail
   * clients that do not have HTML email capability such as mutt. Clients
   * that can read HTML will view the normal Body.
   * @var string
   */
  public $AltBody           = '';

  /**
   * Sets word wrapping on the body of the message to a given number of
   * characters.
   * @var int
   */
  public $WordWrap          = 0;

  /**
   * Method to send mail: ("mail", "sendmail", or "smtp").
   * @var string
   */
  public $Mailer            = 'mail';

  /**
   * Sets the path of the sendmail program.
   * @var string
   */
  public $Sendmail          = '/usr/sbin/sendmail';

  /**
   * Path to PHPMailer plugins.  This is now only useful if the SMTP class
   * is in a different directory than the PHP include path.
   * @var string
   */
  public $PluginDir         = '';

  /**
   * Holds PHPMailer version.
   * @var string
   */
  public $Version           = "2.3";

  /**
   * Sets the email address that a reading confirmation will be sent.
   * @var string
   */
  public $ConfirmReadingTo  = '';

  /**
   * Sets the hostname to use in Message-Id and Received headers
   * and as default HELO string. If empty, the value returned
   * by SERVER_NAME is used or 'localhost.localdomain'.
   * @var string
   */
  public $Hostname          = '';

  /**
   * Sets the message ID to be used in the Message-Id header.
   * If empty, a unique id will be generated.
   * @var string
   */
  public $MessageID      = '';

  /////////////////////////////////////////////////
  // PROPERTIES FOR SMTP
  /////////////////////////////////////////////////

  /**
   * Sets the SMTP hosts.  All hosts must be separated by a
   * semicolon.  You can also specify a different port
   * for each host by using this format: [hostname:port]
   * (e.g. "smtp1.example.com:25;smtp2.example.com").
   * Hosts will be tried in order.
   * @var string
   */
  public $Host        = 'localhost';

  /**
   * Sets the default SMTP server port.
   * @var int
   */
  public $Port        = 25;

  /**
   * Sets the SMTP HELO of the message (Default is $Hostname).
   * @var string
   */
  public $Helo        = '';

  /**
   * Sets connection prefix.
   * Options are "", "ssl" or "tls"
   * @var string
   */
  public $SMTPSecure = "";

  /**
   * Sets SMTP authentication. Utilizes the Username and Password variables.
   * @var bool
   */
  public $SMTPAuth     = false;

  /**
   * Sets SMTP username.
   * @var string
   */
  public $Username     = '';

  /**
   * Sets SMTP password.
   * @var string
   */
  public $Password     = '';

  /**
   * Sets the SMTP server timeout in seconds. This function will not
   * work with the win32 version.
   * @var int
   */
  public $Timeout      = 10;

  /**
   * Sets SMTP class debugging on or off.
   * @var bool
   */
  public $SMTPDebug    = false;

  /**
   * Prevents the SMTP connection from being closed after each mail
   * sending.  If this is set to true then to close the connection
   * requires an explicit call to SmtpClose().
   * @var bool
   */
  public $SMTPKeepAlive = false;

  /**
   * Provides the ability to have the TO field process individual
   * emails, instead of sending to entire TO addresses
   * @var bool
   */
  public $SingleTo = false;

  /**
   * Provides the ability to change the line ending
   * @var string
   */
  public $LE              = "\r\n";

  /////////////////////////////////////////////////
  // PROPERTIES, PRIVATE
  /////////////////////////////////////////////////

  private $smtp            = NULL;
  private $to              = array();
  private $cc              = array();
  private $bcc             = array();
  private $ReplyTo         = array();
  private $attachment      = array();
  private $CustomHeader    = array();
  private $message_type    = '';
  private $boundary        = array();
  private $language        = array();
  private $error_count     = 0;
  private $sign_cert_file  = "";
  private $sign_key_file   = "";
  private $sign_key_pass   = "";

  /////////////////////////////////////////////////
  // METHODS, VARIABLES
  /////////////////////////////////////////////////

  /**
   * Sets message type to HTML.
   * @param bool $bool
   * @return void
   */
  public function IsHTML($bool) {
    if($bool == true) {
      $this->ContentType = 'text/html';
    } else {
      $this->ContentType = 'text/plain';
    }
  }

  /**
   * Sets Mailer to send message using SMTP.
   * @return void
   */
  public function IsSMTP() {
    $this->Mailer = 'smtp';
  }

  /**
   * Sets Mailer to send message using PHP mail() function.
   * @return void
   */
  public function IsMail() {
    $this->Mailer = 'mail';
  }

  /**
   * Sets Mailer to send message using the $Sendmail program.
   * @return void
   */
  public function IsSendmail() {
    $this->Mailer = 'sendmail';
  }

  /**
   * Sets Mailer to send message using the qmail MTA.
   * @return void
   */
  public function IsQmail() {
    $this->Sendmail = '/var/qmail/bin/sendmail';
    $this->Mailer   = 'sendmail';
  }

  /////////////////////////////////////////////////
  // METHODS, RECIPIENTS
  /////////////////////////////////////////////////

  /**
   * Adds a "To" address.
   * @param string $address
   * @param string $name
   * @return void
   */
  public function AddAddress($address, $name = '') {
    $cur = count($this->to);
    $this->to[$cur][0] = trim($address);
    $this->to[$cur][1] = $name;
  }

  /**
   * Adds a "Cc" address. Note: this function works
   * with the SMTP mailer on win32, not with the "mail"
   * mailer.
   * @param string $address
   * @param string $name
   * @return void
   */
  public function AddCC($address, $name = '') {
    $cur = count($this->cc);
    $this->cc[$cur][0] = trim($address);
    $this->cc[$cur][1] = $name;
  }

  /**
   * Adds a "Bcc" address. Note: this function works
   * with the SMTP mailer on win32, not with the "mail"
   * mailer.
   * @param string $address
   * @param string $name
   * @return void
   */
  public function AddBCC($address, $name = '') {
    $cur = count($this->bcc);
    $this->bcc[$cur][0] = trim($address);
    $this->bcc[$cur][1] = $name;
  }

  /**
   * Adds a "Reply-to" address.
   * @param string $address
   * @param string $name
   * @return void
   */
  public function AddReplyTo($address, $name = '') {
    $cur = count($this->ReplyTo);
    $this->ReplyTo[$cur][0] = trim($address);
    $this->ReplyTo[$cur][1] = $name;
  }

  /////////////////////////////////////////////////
  // METHODS, MAIL SENDING
  /////////////////////////////////////////////////

  /**
   * Creates message and assigns Mailer. If the message is
   * not sent successfully then it returns false.  Use the ErrorInfo
   * variable to view description of the error.
   * @return bool
   */
  public function Send() {
    $header = '';
    $body = '';
    $result = true;

    if((count($this->to) + count($this->cc) + count($this->bcc)) < 1) {
      $this->SetError($this->Lang('provide_address'));
      return false;
    }

    /* Set whether the message is multipart/alternative */
    if(!empty($this->AltBody)) {
      $this->ContentType = 'multipart/alternative';
    }

    $this->error_count = 0; // reset errors
    $this->SetMessageType();
    $header .= $this->CreateHeader();
    $body = $this->CreateBody();

    if($body == '') {
      return false;
    }

    /* Choose the mailer */
    switch($this->Mailer) {
      case 'sendmail':
        $result = $this->SendmailSend($header, $body);
        break;
      case 'smtp':
        $result = $this->SmtpSend($header, $body);
        break;
      case 'mail':
        $result = $this->MailSend($header, $body);
        break;
      default:
        $result = $this->MailSend($header, $body);
        break;
        //$this->SetError($this->Mailer . $this->Lang('mailer_not_supported'));
        //$result = false;
        //break;
    }

    return $result;
  }

  /**
   * Sends mail using the $Sendmail program.
   * @access public
   * @return bool
   */
  public function SendmailSend($header, $body) {
    if ($this->Sender != '') {
      $sendmail = sprintf("%s -oi -f %s -t", escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));
    } else {
      $sendmail = sprintf("%s -oi -t", escapeshellcmd($this->Sendmail));
    }

    if(!@$mail = popen($sendmail, 'w')) {
      $this->SetError($this->Lang('execute') . $this->Sendmail);
      return false;
    }

    fputs($mail, $header);
    fputs($mail, $body);

    $result = pclose($mail);
    if (version_compare(phpversion(), '4.2.3') == -1) {
      $result = $result >> 8 & 0xFF;
    }
    if($result != 0) {
      $this->SetError($this->Lang('execute') . $this->Sendmail);
      return false;
    }

    return true;
  }

  /**
   * Sends mail using the PHP mail() function.
   * @access public
   * @return bool
   */
  public function MailSend($header, $body) {

    $to = '';
    for($i = 0; $i < count($this->to); $i++) {
      if($i != 0) { $to .= ', '; }
      $to .= $this->AddrFormat($this->to[$i]);
    }

    $toArr = split(',', $to);

    $params = sprintf("-oi -f %s", $this->Sender);
    if ($this->Sender != '' && strlen(ini_get('safe_mode'))< 1) {
      $old_from = ini_get('sendmail_from');
      ini_set('sendmail_from', $this->Sender);
      if ($this->SingleTo === true && count($toArr) > 1) {
        foreach ($toArr as $key => $val) {
          $rt = @mail($val, $this->EncodeHeader($this->SecureHeader($this->Subject)), $body, $header, $params);
        }
      } else {
        $rt = @mail($to, $this->EncodeHeader($this->SecureHeader($this->Subject)), $body, $header, $params);
      }
    } else {
      if ($this->SingleTo === true && count($toArr) > 1) {
        foreach ($toArr as $key => $val) {
          $rt = @mail($val, $this->EncodeHeader($this->SecureHeader($this->Subject)), $body, $header, $params);
        }
      } else {
        $rt = @mail($to, $this->EncodeHeader($this->SecureHeader($this->Subject)), $body, $header);
      }
    }

    if (isset($old_from)) {
      ini_set('sendmail_from', $old_from);
    }

    if(!$rt) {
      $this->SetError($this->Lang('instantiate'));
      return false;
    }

    return true;
  }

  /**
   * Sends mail via SMTP using PhpSMTP (Author:
   * Chris Ryan).  Returns bool.  Returns false if there is a
   * bad MAIL FROM, RCPT, or DATA input.
   * @access public
   * @return bool
   */
  public function SmtpSend($header, $body) {
    include_once($this->PluginDir . 'class.smtp.php');
    $error = '';
    $bad_rcpt = array();

    if(!$this->SmtpConnect()) {
      return false;
    }

    $smtp_from = ($this->Sender == '') ? $this->From : $this->Sender;
    if(!$this->smtp->Mail($smtp_from)) {
      $error = $this->Lang('from_failed') . $smtp_from;
      $this->SetError($error);
      $this->smtp->Reset();
      return false;
    }

    /* Attempt to send attach all recipients */
    for($i = 0; $i < count($this->to); $i++) {
      if(!$this->smtp->Recipient($this->to[$i][0])) {
        $bad_rcpt[] = $this->to[$i][0];
      }
    }
    for($i = 0; $i < count($this->cc); $i++) {
      if(!$this->smtp->Recipient($this->cc[$i][0])) {
        $bad_rcpt[] = $this->cc[$i][0];
      }
    }
    for($i = 0; $i < count($this->bcc); $i++) {
      if(!$this->smtp->Recipient($this->bcc[$i][0])) {
        $bad_rcpt[] = $this->bcc[$i][0];
      }
    }

    if(count($bad_rcpt) > 0) { // Create error message
      for($i = 0; $i < count($bad_rcpt); $i++) {
        if($i != 0) {
          $error .= ', ';
        }
        $error .= $bad_rcpt[$i];
      }
      $error = $this->Lang('recipients_failed') . $error;
      $this->SetError($error);
      $this->smtp->Reset();
      return false;
    }

    if(!$this->smtp->Data($header . $body)) {
      $this->SetError($this->Lang('data_not_accepted'));
      $this->smtp->Reset();
      return false;
    }
    if($this->SMTPKeepAlive == true) {
      $this->smtp->Reset();
    } else {
      $this->SmtpClose();
    }

    return true;
  }

  /**
   * Initiates a connection to an SMTP server.  Returns false if the
   * operation failed.
   * @access public
   * @return bool
   */
  public function SmtpConnect() {
    if($this->smtp == NULL) {
      $this->smtp = new SMTP();
    }

    $this->smtp->do_debug = $this->SMTPDebug;
    $hosts = explode(';', $this->Host);
    $index = 0;
    $connection = ($this->smtp->Connected());

    /* Retry while there is no connection */
    while($index < count($hosts) && $connection == false) {
      $hostinfo = array();
      if(preg_match('/^(.+):([0-9]+)$/', $hosts[$index], $hostinfo)) {
        $host = $hostinfo[1];
        $port = $hostinfo[2];
      } else {
        $host = $hosts[$index];
        $port = $this->Port;
      }

      $tls = ($this->SMTPSecure == 'tls');
      $ssl = ($this->SMTPSecure == 'ssl');

      if($this->smtp->Connect(($ssl ? 'ssl://':'').$host, $port, $this->Timeout)) {

        $hello = ($this->Helo != '' ? $this->Helo : $this->ServerHostname());
        $this->smtp->Hello($hello);

        if($tls) {
          if(!$this->smtp->StartTLS()) {
            $this->SetError($this->Lang("tls"));
            $this->smtp->Reset();
            $connection = false;
          }

          //We must resend HELLO after tls negociation
          $this->smtp->Hello($hello);
        }

        $connection = true;
        if($this->SMTPAuth) {
          if(!$this->smtp->Authenticate($this->Username, $this->Password)) {
            $this->SetError($this->Lang('authenticate'));
            $this->smtp->Reset();
            $connection = false;
          }
        }
      }
      $index++;
    }
    if(!$connection) {
      $this->SetError($this->Lang('connect_host'));
    }

    return $connection;
  }

  /**
   * Closes the active SMTP session if one exists.
   * @return void
   */
  public function SmtpClose() {
    if($this->smtp != NULL) {
      if($this->smtp->Connected()) {
        $this->smtp->Quit();
        $this->smtp->Close();
      }
    }
  }

  /**
   * Sets the language for all class error messages.  Returns false
   * if it cannot load the language file.  The default language type
   * is English.
   * @param string $lang_type Type of language (e.g. Portuguese: "br")
   * @param string $lang_path Path to the language file directory
   * @access public
   * @return bool
   */
  function SetLanguage($lang_type = 'en', $lang_path = 'language/') {
    if( !(@include $lang_path.'phpmailer.lang-'.$lang_type.'.php') ) {
      $PHPMAILER_LANG = array();
      $PHPMAILER_LANG["provide_address"]      = 'You must provide at least one ' .
      $PHPMAILER_LANG["mailer_not_supported"] = ' mailer is not supported.';
      $PHPMAILER_LANG["execute"]              = 'Could not execute: ';
      $PHPMAILER_LANG["instantiate"]          = 'Could not instantiate mail function.';
      $PHPMAILER_LANG["authenticate"]         = 'SMTP Error: Could not authenticate.';
      $PHPMAILER_LANG["from_failed"]          = 'The following From address failed: ';
      $PHPMAILER_LANG["recipients_failed"]    = 'SMTP Error: The following ' .
      $PHPMAILER_LANG["data_not_accepted"]    = 'SMTP Error: Data not accepted.';
      $PHPMAILER_LANG["connect_host"]         = 'SMTP Error: Could not connect to SMTP host.';
      $PHPMAILER_LANG["file_access"]          = 'Could not access file: ';
      $PHPMAILER_LANG["file_open"]            = 'File Error: Could not open file: ';
      $PHPMAILER_LANG["encoding"]             = 'Unknown encoding: ';
      $PHPMAILER_LANG["signing"]              = 'Signing Error: ';
    }
    $this->language = $PHPMAILER_LANG;
    return true;
  }

  /////////////////////////////////////////////////
  // METHODS, MESSAGE CREATION
  /////////////////////////////////////////////////

  /**
   * Creates recipient headers.
   * @access public
   * @return string
   */
  public function AddrAppend($type, $addr) {
    $addr_str = $type . ': ';
    $addr_str .= $this->AddrFormat($addr[0]);
    if(count($addr) > 1) {
      for($i = 1; $i < count($addr); $i++) {
        $addr_str .= ', ' . $this->AddrFormat($addr[$i]);
      }
    }
    $addr_str .= $this->LE;

    return $addr_str;
  }

  /**
   * Formats an address correctly.
   * @access public
   * @return string
   */
  public function AddrFormat($addr) {
    if(empty($addr[1])) {
      $formatted = $this->SecureHeader($addr[0]);
    } else {
      $formatted = $this->EncodeHeader($this->SecureHeader($addr[1]), 'phrase') . " <" . $this->SecureHeader($addr[0]) . ">";
    }

    return $formatted;
  }

  /**
   * Wraps message for use with mailers that do not
   * automatically perform wrapping and for quoted-printable.
   * Original written by philippe.
   * @access public
   * @return string
   */
  public function WrapText($message, $length, $qp_mode = false) {
    $soft_break = ($qp_mode) ? sprintf(" =%s", $this->LE) : $this->LE;
    // If utf-8 encoding is used, we will need to make sure we don't
    // split multibyte characters when we wrap
    $is_utf8 = (strtolower($this->CharSet) == "utf-8");

    $message = $this->FixEOL($message);
    if (substr($message, -1) == $this->LE) {
      $message = substr($message, 0, -1);
    }

    $line = explode($this->LE, $message);
    $message = '';
    for ($i=0 ;$i < count($line); $i++) {
      $line_part = explode(' ', $line[$i]);
      $buf = '';
      for ($e = 0; $e<count($line_part); $e++) {
        $word = $line_part[$e];
        if ($qp_mode and (strlen($word) > $length)) {
          $space_left = $length - strlen($buf) - 1;
          if ($e != 0) {
            if ($space_left > 20) {
              $len = $space_left;
              if ($is_utf8) {
                $len = $this->UTF8CharBoundary($word, $len);
              } elseif (substr($word, $len - 1, 1) == "=") {
                $len--;
              } elseif (substr($word, $len - 2, 1) == "=") {
                $len -= 2;
              }
              $part = substr($word, 0, $len);
              $word = substr($word, $len);
              $buf .= ' ' . $part;
              $message .= $buf . sprintf("=%s", $this->LE);
            } else {
              $message .= $buf . $soft_break;
            }
            $buf = '';
          }
          while (strlen($word) > 0) {
            $len = $length;
            if ($is_utf8) {
              $len = $this->UTF8CharBoundary($word, $len);
            } elseif (substr($word, $len - 1, 1) == "=") {
              $len--;
            } elseif (substr($word, $len - 2, 1) == "=") {
              $len -= 2;
            }
            $part = substr($word, 0, $len);
            $word = substr($word, $len);

            if (strlen($word) > 0) {
              $message .= $part . sprintf("=%s", $this->LE);
            } else {
              $buf = $part;
            }
          }
        } else {
          $buf_o = $buf;
          $buf .= ($e == 0) ? $word : (' ' . $word);

          if (strlen($buf) > $length and $buf_o != '') {
            $message .= $buf_o . $soft_break;
            $buf = $word;
          }
        }
      }
      $message .= $buf . $this->LE;
    }

    return $message;
  }

  /**
   * Finds last character boundary prior to maxLength in a utf-8
   * quoted (printable) encoded string.
   * Original written by Colin Brown.
   * @access public
   * @param string $encodedText utf-8 QP text
   * @param int    $maxLength   find last character boundary prior to this length
   * @return int
   */
  public function UTF8CharBoundary($encodedText, $maxLength) {
    $foundSplitPos = false;
    $lookBack = 3;
    while (!$foundSplitPos) {
      $lastChunk = substr($encodedText, $maxLength - $lookBack, $lookBack);
      $encodedCharPos = strpos($lastChunk, "=");
      if ($encodedCharPos !== false) {
        // Found start of encoded character byte within $lookBack block.
        // Check the encoded byte value (the 2 chars after the '=')
        $hex = substr($encodedText, $maxLength - $lookBack + $encodedCharPos + 1, 2);
        $dec = hexdec($hex);
        if ($dec < 128) { // Single byte character.
          // If the encoded char was found at pos 0, it will fit
          // otherwise reduce maxLength to start of the encoded char
          $maxLength = ($encodedCharPos == 0) ? $maxLength :
          $maxLength - ($lookBack - $encodedCharPos);
          $foundSplitPos = true;
        } elseif ($dec >= 192) { // First byte of a multi byte character
          // Reduce maxLength to split at start of character
          $maxLength = $maxLength - ($lookBack - $encodedCharPos);
          $foundSplitPos = true;
        } elseif ($dec < 192) { // Middle byte of a multi byte character, look further back
          $lookBack += 3;
        }
      } else {
        // No encoded character found
        $foundSplitPos = true;
      }
    }
    return $maxLength;
  }


  /**
   * Set the body wrapping.
   * @access public
   * @return void
   */
  public function SetWordWrap() {
    if($this->WordWrap < 1) {
      return;
    }

    switch($this->message_type) {
      case 'alt':
        /* fall through */
      case 'alt_attachments':
        $this->AltBody = $this->WrapText($this->AltBody, $this->WordWrap);
        break;
      default:
        $this->Body = $this->WrapText($this->Body, $this->WordWrap);
        break;
    }
  }

  /**
   * Assembles message header.
   * @access public
   * @return string
   */
  public function CreateHeader() {
    $result = '';

    /* Set the boundaries */
    $uniq_id = md5(uniqid(time()));
    $this->boundary[1] = 'b1_' . $uniq_id;
    $this->boundary[2] = 'b2_' . $uniq_id;

    $result .= $this->HeaderLine('Date', $this->RFCDate());
    if($this->Sender == '') {
      $result .= $this->HeaderLine('Return-Path', trim($this->From));
    } else {
      $result .= $this->HeaderLine('Return-Path', trim($this->Sender));
    }

    /* To be created automatically by mail() */
    if($this->Mailer != 'mail') {
      if(count($this->to) > 0) {
        $result .= $this->AddrAppend('To', $this->to);
      } elseif (count($this->cc) == 0) {
        $result .= $this->HeaderLine('To', 'undisclosed-recipients:;');
      }
    }

    $from = array();
    $from[0][0] = trim($this->From);
    $from[0][1] = $this->FromName;
    $result .= $this->AddrAppend('From', $from);

    /* sendmail and mail() extract Cc from the header before sending */
    if((($this->Mailer == 'sendmail') || ($this->Mailer == 'mail')) && (count($this->cc) > 0)) {
      $result .= $this->AddrAppend('Cc', $this->cc);
    }

    /* sendmail and mail() extract Bcc from the header before sending */
    if((($this->Mailer == 'sendmail') || ($this->Mailer == 'mail')) && (count($this->bcc) > 0)) {
      $result .= $this->AddrAppend('Bcc', $this->bcc);
    }

    if(count($this->ReplyTo) > 0) {
      $result .= $this->AddrAppend('Reply-to', $this->ReplyTo);
    }

    /* mail() sets the subject itself */
    if($this->Mailer != 'mail') {
      $result .= $this->HeaderLine('Subject', $this->EncodeHeader($this->SecureHeader($this->Subject)));
    }

    if($this->MessageID != '') {
      $result .= $this->HeaderLine('Message-ID',$this->MessageID);
    } else {
      $result .= sprintf("Message-ID: <%s@%s>%s", $uniq_id, $this->ServerHostname(), $this->LE);
    }
    $result .= $this->HeaderLine('X-Priority', $this->Priority);
    $result .= $this->HeaderLine('X-Mailer', 'PHPMailer (phpmailer.codeworxtech.com) [version ' . $this->Version . ']');

    if($this->ConfirmReadingTo != '') {
      $result .= $this->HeaderLine('Disposition-Notification-To', '<' . trim($this->ConfirmReadingTo) . '>');
    }

    // Add custom headers
    for($index = 0; $index < count($this->CustomHeader); $index++) {
      $result .= $this->HeaderLine(trim($this->CustomHeader[$index][0]), $this->EncodeHeader(trim($this->CustomHeader[$index][1])));
    }
    if (!$this->sign_key_file) {
      $result .= $this->HeaderLine('MIME-Version', '1.0');
      $result .= $this->GetMailMIME();
    }

    return $result;
  }

  /**
   * Returns the message MIME.
   * @access public
   * @return string
   */
  public function GetMailMIME() {
    $result = '';
    switch($this->message_type) {
      case 'plain':
        $result .= $this->HeaderLine('Content-Transfer-Encoding', $this->Encoding);
        $result .= sprintf("Content-Type: %s; charset=\"%s\"", $this->ContentType, $this->CharSet);
        break;
      case 'attachments':
        /* fall through */
      case 'alt_attachments':
        if($this->InlineImageExists()){
          $result .= sprintf("Content-Type: %s;%s\ttype=\"text/html\";%s\tboundary=\"%s\"%s", 'multipart/related', $this->LE, $this->LE, $this->boundary[1], $this->LE);
        } else {
          $result .= $this->HeaderLine('Content-Type', 'multipart/mixed;');
          $result .= $this->TextLine("\tboundary=\"" . $this->boundary[1] . '"');
        }
        break;
      case 'alt':
        $result .= $this->HeaderLine('Content-Type', 'multipart/alternative;');
        $result .= $this->TextLine("\tboundary=\"" . $this->boundary[1] . '"');
        break;
    }

    if($this->Mailer != 'mail') {
      $result .= $this->LE.$this->LE;
    }

    return $result;
  }

  /**
   * Assembles the message body.  Returns an empty string on failure.
   * @access public
   * @return string
   */
  public function CreateBody() {
    $result = '';

    if ($this->sign_key_file) {
      $result .= $this->GetMailMIME();
    }

    $this->SetWordWrap();

    switch($this->message_type) {
      case 'alt':
        $result .= $this->GetBoundary($this->boundary[1], '', 'text/plain', '');
        $result .= $this->EncodeString($this->AltBody, $this->Encoding);
        $result .= $this->LE.$this->LE;
        $result .= $this->GetBoundary($this->boundary[1], '', 'text/html', '');
        $result .= $this->EncodeString($this->Body, $this->Encoding);
        $result .= $this->LE.$this->LE;
        $result .= $this->EndBoundary($this->boundary[1]);
        break;
      case 'plain':
        $result .= $this->EncodeString($this->Body, $this->Encoding);
        break;
      case 'attachments':
        $result .= $this->GetBoundary($this->boundary[1], '', '', '');
        $result .= $this->EncodeString($this->Body, $this->Encoding);
        $result .= $this->LE;
        $result .= $this->AttachAll();
        break;
      case 'alt_attachments':
        $result .= sprintf("--%s%s", $this->boundary[1], $this->LE);
        $result .= sprintf("Content-Type: %s;%s" . "\tboundary=\"%s\"%s", 'multipart/alternative', $this->LE, $this->boundary[2], $this->LE.$this->LE);
        $result .= $this->GetBoundary($this->boundary[2], '', 'text/plain', '') . $this->LE; // Create text body
        $result .= $this->EncodeString($this->AltBody, $this->Encoding);
        $result .= $this->LE.$this->LE;
        $result .= $this->GetBoundary($this->boundary[2], '', 'text/html', '') . $this->LE; // Create the HTML body
        $result .= $this->EncodeString($this->Body, $this->Encoding);
        $result .= $this->LE.$this->LE;
        $result .= $this->EndBoundary($this->boundary[2]);
        $result .= $this->AttachAll();
        break;
    }

    if($this->IsError()) {
      $result = '';
    } else if ($this->sign_key_file) {
      $file = tempnam("", "mail");
      $fp = fopen($file, "w");
      fwrite($fp, $result);
      fclose($fp);
      $signed = tempnam("", "signed");

      if (@openssl_pkcs7_sign($file, $signed, "file://".$this->sign_cert_file, array("file://".$this->sign_key_file, $this->sign_key_pass), null)) {
        $fp = fopen($signed, "r");
        $result = '';
        while(!feof($fp)){
          $result = $result . fread($fp, 1024);
        }
        fclose($fp);
      } else {
        $this->SetError($this->Lang("signing").openssl_error_string());
        $result = '';
      }

      unlink($file);
      unlink($signed);
    }

    return $result;
  }

  /**
   * Returns the start of a message boundary.
   * @access public
   */
  public function GetBoundary($boundary, $charSet, $contentType, $encoding) {
    $result = '';
    if($charSet == '') {
      $charSet = $this->CharSet;
    }
    if($contentType == '') {
      $contentType = $this->ContentType;
    }
    if($encoding == '') {
      $encoding = $this->Encoding;
    }
    $result .= $this->TextLine('--' . $boundary);
    $result .= sprintf("Content-Type: %s; charset = \"%s\"", $contentType, $charSet);
    $result .= $this->LE;
    $result .= $this->HeaderLine('Content-Transfer-Encoding', $encoding);
    $result .= $this->LE;

    return $result;
  }

  /**
   * Returns the end of a message boundary.
   * @access public
   */
  public function EndBoundary($boundary) {
    return $this->LE . '--' . $boundary . '--' . $this->LE;
  }

  /**
   * Sets the message type.
   * @access public
   * @return void
   */
  public function SetMessageType() {
    if(count($this->attachment) < 1 && strlen($this->AltBody) < 1) {
      $this->message_type = 'plain';
    } else {
      if(count($this->attachment) > 0) {
        $this->message_type = 'attachments';
      }
      if(strlen($this->AltBody) > 0 && count($this->attachment) < 1) {
        $this->message_type = 'alt';
      }
      if(strlen($this->AltBody) > 0 && count($this->attachment) > 0) {
        $this->message_type = 'alt_attachments';
      }
    }
  }

  /* Returns a formatted header line.
   * @access public
   * @return string
   */
  public function HeaderLine($name, $value) {
    return $name . ': ' . $value . $this->LE;
  }

  /**
   * Returns a formatted mail line.
   * @access public
   * @return string
   */
  public function TextLine($value) {
    return $value . $this->LE;
  }

  /////////////////////////////////////////////////
  // CLASS METHODS, ATTACHMENTS
  /////////////////////////////////////////////////

  /**
   * Adds an attachment from a path on the filesystem.
   * Returns false if the file could not be found
   * or accessed.
   * @param string $path Path to the attachment.
   * @param string $name Overrides the attachment name.
   * @param string $encoding File encoding (see $Encoding).
   * @param string $type File extension (MIME) type.
   * @return bool
   */
  public function AddAttachment($path, $name = '', $encoding = 'base64', $type = 'application/octet-stream') {
    if(!@is_file($path)) {
      $this->SetError($this->Lang('file_access') . $path);
      return false;
    }

    $filename = basename($path);
    if($name == '') {
      $name = $filename;
    }

    $cur = count($this->attachment);
    $this->attachment[$cur][0] = $path;
    $this->attachment[$cur][1] = $filename;
    $this->attachment[$cur][2] = $name;
    $this->attachment[$cur][3] = $encoding;
    $this->attachment[$cur][4] = $type;
    $this->attachment[$cur][5] = false; // isStringAttachment
    $this->attachment[$cur][6] = 'attachment';
    $this->attachment[$cur][7] = 0;

    return true;
  }

  /**
   * Attaches all fs, string, and binary attachments to the message.
   * Returns an empty string on failure.
   * @access public
   * @return string
   */
  public function AttachAll() {
    /* Return text of body */
    $mime = array();

    /* Add all attachments */
    for($i = 0; $i < count($this->attachment); $i++) {
      /* Check for string attachment */
      $bString = $this->attachment[$i][5];
      if ($bString) {
        $string = $this->attachment[$i][0];
      } else {
        $path = $this->attachment[$i][0];
      }

      $filename    = $this->attachment[$i][1];
      $name        = $this->attachment[$i][2];
      $encoding    = $this->attachment[$i][3];
      $type        = $this->attachment[$i][4];
      $disposition = $this->attachment[$i][6];
      $cid         = $this->attachment[$i][7];

      $mime[] = sprintf("--%s%s", $this->boundary[1], $this->LE);
      //$mime[] = sprintf("Content-Type: %s; name=\"%s\"%s", $type, $name, $this->LE);
      $mime[] = sprintf("Content-Type: %s; name=\"%s\"%s", $type, $this->EncodeHeader($this->SecureHeader($name)), $this->LE);
      $mime[] = sprintf("Content-Transfer-Encoding: %s%s", $encoding, $this->LE);

      if($disposition == 'inline') {
        $mime[] = sprintf("Content-ID: <%s>%s", $cid, $this->LE);
      }

      //$mime[] = sprintf("Content-Disposition: %s; filename=\"%s\"%s", $disposition, $name, $this->LE.$this->LE);
      $mime[] = sprintf("Content-Disposition: %s; filename=\"%s\"%s", $disposition, $this->EncodeHeader($this->SecureHeader($name)), $this->LE.$this->LE);

      /* Encode as string attachment */
      if($bString) {
        $mime[] = $this->EncodeString($string, $encoding);
        if($this->IsError()) {
          return '';
        }
        $mime[] = $this->LE.$this->LE;
      } else {
        $mime[] = $this->EncodeFile($path, $encoding);
        if($this->IsError()) {
          return '';
        }
        $mime[] = $this->LE.$this->LE;
      }
    }

    $mime[] = sprintf("--%s--%s", $this->boundary[1], $this->LE);

    return join('', $mime);
  }

  /**
   * Encodes attachment in requested format.  Returns an
   * empty string on failure.
   * @access public
   * @return string
   */
  public function EncodeFile ($path, $encoding = 'base64') {
    if(!@$fd = fopen($path, 'rb')) {
      $this->SetError($this->Lang('file_open') . $path);
      return '';
    }
    if (function_exists('get_magic_quotes')) {
        function get_magic_quotes() {
            return false;
        }
}
    if (PHP_VERSION < 6) {
      $magic_quotes = get_magic_quotes_runtime();
      @set_magic_quotes_runtime(0);
    }
    $file_buffer  = file_get_contents($path);
    $file_buffer  = $this->EncodeString($file_buffer, $encoding);
    fclose($fd);
    if (PHP_VERSION < 6) { @set_magic_quotes_runtime($magic_quotes); }
    return $file_buffer;
  }

  /**
   * Encodes string to requested format. Returns an
   * empty string on failure.
   * @access public
   * @return string
   */
  public function EncodeString ($str, $encoding = 'base64') {
    $encoded = '';
    switch(strtolower($encoding)) {
      case 'base64':
        $encoded = chunk_split(base64_encode($str), 76, $this->LE);
        break;
      case '7bit':
      case '8bit':
        $encoded = $this->FixEOL($str);
        if (substr($encoded, -(strlen($this->LE))) != $this->LE)
          $encoded .= $this->LE;
        break;
      case 'binary':
        $encoded = $str;
        break;
      case 'quoted-printable':
        $encoded = $this->EncodeQP($str);
        break;
      default:
        $this->SetError($this->Lang('encoding') . $encoding);
        break;
    }
    return $encoded;
  }

  /**
   * Encode a header string to best of Q, B, quoted or none.
   * @access public
   * @return string
   */
  public function EncodeHeader ($str, $position = 'text') {
    $x = 0;

    switch (strtolower($position)) {
      case 'phrase':
        if (!preg_match('/[\200-\377]/', $str)) {
          /* Can't use addslashes as we don't know what value has magic_quotes_sybase. */
          $encoded = addcslashes($str, "\0..\37\177\\\"");
          if (($str == $encoded) && !preg_match('/[^A-Za-z0-9!#$%&\'*+\/=?^_`{|}~ -]/', $str)) {
            return ($encoded);
          } else {
            return ("\"$encoded\"");
          }
        }
        $x = preg_match_all('/[^\040\041\043-\133\135-\176]/', $str, $matches);
        break;
      case 'comment':
        $x = preg_match_all('/[()"]/', $str, $matches);
        /* Fall-through */
      case 'text':
      default:
        $x += preg_match_all('/[\000-\010\013\014\016-\037\177-\377]/', $str, $matches);
        break;
    }

    if ($x == 0) {
      return ($str);
    }

    $maxlen = 75 - 7 - strlen($this->CharSet);
    /* Try to select the encoding which should produce the shortest output */
    if (strlen($str)/3 < $x) {
      $encoding = 'B';
      if (function_exists('mb_strlen') && $this->HasMultiBytes($str)) {
     // Use a custom function which correctly encodes and wraps long
     // multibyte strings without breaking lines within a character
        $encoded = $this->Base64EncodeWrapMB($str);
      } else {
        $encoded = base64_encode($str);
        $maxlen -= $maxlen % 4;
        $encoded = trim(chunk_split($encoded, $maxlen, "\n"));
      }
    } else {
      $encoding = 'Q';
      $encoded = $this->EncodeQ($str, $position);
      $encoded = $this->WrapText($encoded, $maxlen, true);
      $encoded = str_replace('='.$this->LE, "\n", trim($encoded));
    }

    $encoded = preg_replace('/^(.*)$/m', " =?".$this->CharSet."?$encoding?\\1?=", $encoded);
    $encoded = trim(str_replace("\n", $this->LE, $encoded));

    return $encoded;
  }

  /**
   * Checks if a string contains multibyte characters.
   * @access public
   * @param string $str multi-byte text to wrap encode
   * @return bool
   */
  public function HasMultiBytes($str) {
    if (function_exists('mb_strlen')) {
      return (strlen($str) > mb_strlen($str, $this->CharSet));
    } else { // Assume no multibytes (we can't handle without mbstring functions anyway)
      return False;
    }
  }

  /**
   * Correctly encodes and wraps long multibyte strings for mail headers
   * without breaking lines within a character.
   * Adapted from a function by paravoid at http://uk.php.net/manual/en/function.mb-encode-mimeheader.php
   * @access public
   * @param string $str multi-byte text to wrap encode
   * @return string
   */
  public function Base64EncodeWrapMB($str) {
    $start = "=?".$this->CharSet."?B?";
    $end = "?=";
    $encoded = "";

    $mb_length = mb_strlen($str, $this->CharSet);
    // Each line must have length <= 75, including $start and $end
    $length = 75 - strlen($start) - strlen($end);
    // Average multi-byte ratio
    $ratio = $mb_length / strlen($str);
    // Base64 has a 4:3 ratio
    $offset = $avgLength = floor($length * $ratio * .75);

    for ($i = 0; $i < $mb_length; $i += $offset) {
      $lookBack = 0;

      do {
        $offset = $avgLength - $lookBack;
        $chunk = mb_substr($str, $i, $offset, $this->CharSet);
        $chunk = base64_encode($chunk);
        $lookBack++;
      }
      while (strlen($chunk) > $length);

      $encoded .= $chunk . $this->LE;
    }

    // Chomp the last linefeed
    $encoded = substr($encoded, 0, -strlen($this->LE));
    return $encoded;
  }

  /**
  * Encode string to quoted-printable.
  * @access public
  * @param string $string the text to encode
  * @param integer $line_max Number of chars allowed on a line before wrapping
  * @return string
  */
  public function EncodeQP( $input = '', $line_max = 76, $space_conv = false ) {
    $hex = array('0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F');
    $lines = preg_split('/(?:\r\n|\r|\n)/', $input);
    $eol = "\r\n";
    $escape = '=';
    $output = '';
    while( list(, $line) = each($lines) ) {
      $linlen = strlen($line);
      $newline = '';
      for($i = 0; $i < $linlen; $i++) {
        $c = substr( $line, $i, 1 );
        $dec = ord( $c );
        if ( ( $i == 0 ) && ( $dec == 46 ) ) { // convert first point in the line into =2E
          $c = '=2E';
        }
        if ( $dec == 32 ) {
          if ( $i == ( $linlen - 1 ) ) { // convert space at eol only
            $c = '=20';
          } else if ( $space_conv ) {
            $c = '=20';
          }
        } elseif ( ($dec == 61) || ($dec < 32 ) || ($dec > 126) ) { // always encode "\t", which is *not* required
          $h2 = floor($dec/16);
          $h1 = floor($dec%16);
          $c = $escape.$hex[$h2].$hex[$h1];
        }
        if ( (strlen($newline) + strlen($c)) >= $line_max ) { // CRLF is not counted
          $output .= $newline.$escape.$eol; //  soft line break; " =\r\n" is okay
          $newline = '';
          // check if newline first character will be point or not
          if ( $dec == 46 ) {
            $c = '=2E';
          }
        }
        $newline .= $c;
      } // end of for
      $output .= $newline.$eol;
    } // end of while
    return $output;
  }

  /**
   * Encode string to q encoding.
   * @access public
   * @return string
   */
  public function EncodeQ ($str, $position = 'text') {
    /* There should not be any EOL in the string */
    $encoded = preg_replace("[\r\n]", '', $str);

    switch (strtolower($position)) {
      case 'phrase':
        $encoded = preg_replace("/([^A-Za-z0-9!*+\/ -])/e", "'='.sprintf('%02X', ord('\\1'))", $encoded);
        break;
      case 'comment':
        $encoded = preg_replace("/([\(\)\"])/e", "'='.sprintf('%02X', ord('\\1'))", $encoded);
      case 'text':
      default:
        /* Replace every high ascii, control =, ? and _ characters */
        $encoded = preg_replace('/([\000-\011\013\014\016-\037\075\077\137\177-\377])/e',
              "'='.sprintf('%02X', ord('\\1'))", $encoded);
        break;
    }

    /* Replace every spaces to _ (more readable than =20) */
    $encoded = str_replace(' ', '_', $encoded);

    return $encoded;
  }

  /**
   * Adds a string or binary attachment (non-filesystem) to the list.
   * This method can be used to attach ascii or binary data,
   * such as a BLOB record from a database.
   * @param string $string String attachment data.
   * @param string $filename Name of the attachment.
   * @param string $encoding File encoding (see $Encoding).
   * @param string $type File extension (MIME) type.
   * @return void
   */
  public function AddStringAttachment($string, $filename, $encoding = 'base64', $type = 'application/octet-stream') {
    /* Append to $attachment array */
    $cur = count($this->attachment);
    $this->attachment[$cur][0] = $string;
    $this->attachment[$cur][1] = $filename;
    $this->attachment[$cur][2] = $filename;
    $this->attachment[$cur][3] = $encoding;
    $this->attachment[$cur][4] = $type;
    $this->attachment[$cur][5] = true; // isString
    $this->attachment[$cur][6] = 'attachment';
    $this->attachment[$cur][7] = 0;
  }

  /**
   * Adds an embedded attachment.  This can include images, sounds, and
   * just about any other document.  Make sure to set the $type to an
   * image type.  For JPEG images use "image/jpeg" and for GIF images
   * use "image/gif".
   * @param string $path Path to the attachment.
   * @param string $cid Content ID of the attachment.  Use this to identify
   *        the Id for accessing the image in an HTML form.
   * @param string $name Overrides the attachment name.
   * @param string $encoding File encoding (see $Encoding).
   * @param string $type File extension (MIME) type.
   * @return bool
   */
  public function AddEmbeddedImage($path, $cid, $name = '', $encoding = 'base64', $type = 'application/octet-stream') {

    if(!@is_file($path)) {
      $this->SetError($this->Lang('file_access') . $path);
      return false;
    }

    $filename = basename($path);
    if($name == '') {
      $name = $filename;
    }

    /* Append to $attachment array */
    $cur = count($this->attachment);
    $this->attachment[$cur][0] = $path;
    $this->attachment[$cur][1] = $filename;
    $this->attachment[$cur][2] = $name;
    $this->attachment[$cur][3] = $encoding;
    $this->attachment[$cur][4] = $type;
    $this->attachment[$cur][5] = false;
    $this->attachment[$cur][6] = 'inline';
    $this->attachment[$cur][7] = $cid;

    return true;
  }

  /**
   * Returns true if an inline attachment is present.
   * @access public
   * @return bool
   */
  public function InlineImageExists() {
    $result = false;
    for($i = 0; $i < count($this->attachment); $i++) {
      if($this->attachment[$i][6] == 'inline') {
        $result = true;
        break;
      }
    }

    return $result;
  }

  /////////////////////////////////////////////////
  // CLASS METHODS, MESSAGE RESET
  /////////////////////////////////////////////////

  /**
   * Clears all recipients assigned in the TO array.  Returns void.
   * @return void
   */
  public function ClearAddresses() {
    $this->to = array();
  }

  /**
   * Clears all recipients assigned in the CC array.  Returns void.
   * @return void
   */
  public function ClearCCs() {
    $this->cc = array();
  }

  /**
   * Clears all recipients assigned in the BCC array.  Returns void.
   * @return void
   */
  public function ClearBCCs() {
    $this->bcc = array();
  }

  /**
   * Clears all recipients assigned in the ReplyTo array.  Returns void.
   * @return void
   */
  public function ClearReplyTos() {
    $this->ReplyTo = array();
  }

  /**
   * Clears all recipients assigned in the TO, CC and BCC
   * array.  Returns void.
   * @return void
   */
  public function ClearAllRecipients() {
    $this->to = array();
    $this->cc = array();
    $this->bcc = array();
  }

  /**
   * Clears all previously set filesystem, string, and binary
   * attachments.  Returns void.
   * @return void
   */
  public function ClearAttachments() {
    $this->attachment = array();
  }

  /**
   * Clears all custom headers.  Returns void.
   * @return void
   */
  public function ClearCustomHeaders() {
    $this->CustomHeader = array();
  }

  /////////////////////////////////////////////////
  // CLASS METHODS, MISCELLANEOUS
  /////////////////////////////////////////////////

  /**
   * Adds the error message to the error container.
   * Returns void.
   * @access private
   * @return void
   */
  private function SetError($msg) {
    $this->error_count++;
    $this->ErrorInfo = $msg;
  }

  /**
   * Returns the proper RFC 822 formatted date.
   * @access private
   * @return string
   */
  private static function RFCDate() {
    $tz = date('Z');
    $tzs = ($tz < 0) ? '-' : '+';
    $tz = abs($tz);
    $tz = (int)($tz/3600)*100 + ($tz%3600)/60;
    $result = sprintf("%s %s%04d", date('D, j M Y H:i:s'), $tzs, $tz);

    return $result;
  }

  /**
   * Returns the server hostname or 'localhost.localdomain' if unknown.
   * @access private
   * @return string
   */
  private function ServerHostname() {
    if (!empty($this->Hostname)) {
      $result = $this->Hostname;
    } elseif (isset($_SERVER['SERVER_NAME'])) {
      $result = $_SERVER['SERVER_NAME'];
    } else {
      $result = "localhost.localdomain";
    }

    return $result;
  }

  /**
   * Returns a message in the appropriate language.
   * @access private
   * @return string
   */
  private function Lang($key) {
    if(count($this->language) < 1) {
      $this->SetLanguage('en'); // set the default language
    }

    if(isset($this->language[$key])) {
      return $this->language[$key];
    } else {
      return 'Language string failed to load: ' . $key;
    }
  }

  /**
   * Returns true if an error occurred.
   * @access public
   * @return bool
   */
  public function IsError() {
    return ($this->error_count > 0);
  }

  /**
   * Changes every end of line from CR or LF to CRLF.
   * @access private
   * @return string
   */
  private function FixEOL($str) {
    $str = str_replace("\r\n", "\n", $str);
    $str = str_replace("\r", "\n", $str);
    $str = str_replace("\n", $this->LE, $str);
    return $str;
  }

  /**
   * Adds a custom header.
   * @access public
   * @return void
   */
  public function AddCustomHeader($custom_header) {
    $this->CustomHeader[] = explode(':', $custom_header, 2);
  }

  /**
   * Evaluates the message and returns modifications for inline images and backgrounds
   * @access public
   * @return $message
   */
  public function MsgHTML($message,$basedir='') {
    preg_match_all("/(src|background)=\"(.*)\"/Ui", $message, $images);
    if(isset($images[2])) {
      foreach($images[2] as $i => $url) {
        // do not change urls for absolute images (thanks to corvuscorax)
        if (!preg_match('/^[A-z][A-z]*:\/\//',$url)) {
          $filename = basename($url);
          $directory = dirname($url);
          ($directory == '.')?$directory='':'';
          $cid = 'cid:' . md5($filename);
          $fileParts = split("\.", $filename);
          $ext = $fileParts[1];
          $mimeType = $this->_mime_types($ext);
          if ( strlen($basedir) > 1 && substr($basedir,-1) != '/') { $basedir .= '/'; }
          if ( strlen($directory) > 1 && substr($directory,-1) != '/') { $directory .= '/'; }
          if ( $this->AddEmbeddedImage($basedir.$directory.$filename, md5($filename), $filename, 'base64',$mimeType) ) {
            $message = preg_replace("/".$images[1][$i]."=\"".preg_quote($url, '/')."\"/Ui", $images[1][$i]."=\"".$cid."\"", $message);
          }
        }
      }
    }
    $this->IsHTML(true);
    $this->Body = $message;
    $textMsg = trim(strip_tags(preg_replace('/<(head|title|style|script)[^>]*>.*?<\/\\1>/s','',$message)));
    if ( !empty($textMsg) && empty($this->AltBody) ) {
      $this->AltBody = html_entity_decode($textMsg);
    }
    if ( empty($this->AltBody) ) {
      $this->AltBody = 'To view this email message, open the email in with HTML compatibility!' . "\n\n";
    }
  }

  /**
   * Gets the mime type of the embedded or inline image
   * @access public
   * @return mime type of ext
   */
  public function _mime_types($ext = '') {
    $mimes = array(
      'hqx'   =>  'application/mac-binhex40',
      'cpt'   =>  'application/mac-compactpro',
      'doc'   =>  'application/msword',
      'bin'   =>  'application/macbinary',
      'dms'   =>  'application/octet-stream',
      'lha'   =>  'application/octet-stream',
      'lzh'   =>  'application/octet-stream',
      'exe'   =>  'application/octet-stream',
      'class' =>  'application/octet-stream',
      'psd'   =>  'application/octet-stream',
      'so'    =>  'application/octet-stream',
      'sea'   =>  'application/octet-stream',
      'dll'   =>  'application/octet-stream',
      'oda'   =>  'application/oda',
      'pdf'   =>  'application/pdf',
      'ai'    =>  'application/postscript',
      'eps'   =>  'application/postscript',
      'ps'    =>  'application/postscript',
      'smi'   =>  'application/smil',
      'smil'  =>  'application/smil',
      'mif'   =>  'application/vnd.mif',
      'xls'   =>  'application/vnd.ms-excel',
      'ppt'   =>  'application/vnd.ms-powerpoint',
      'wbxml' =>  'application/vnd.wap.wbxml',
      'wmlc'  =>  'application/vnd.wap.wmlc',
      'dcr'   =>  'application/x-director',
      'dir'   =>  'application/x-director',
      'dxr'   =>  'application/x-director',
      'dvi'   =>  'application/x-dvi',
      'gtar'  =>  'application/x-gtar',
      'php'   =>  'application/x-httpd-php',
      'php4'  =>  'application/x-httpd-php',
      'php3'  =>  'application/x-httpd-php',
      'phtml' =>  'application/x-httpd-php',
      'phps'  =>  'application/x-httpd-php-source',
      'js'    =>  'application/x-javascript',
      'swf'   =>  'application/x-shockwave-flash',
      'sit'   =>  'application/x-stuffit',
      'tar'   =>  'application/x-tar',
      'tgz'   =>  'application/x-tar',
      'xhtml' =>  'application/xhtml+xml',
      'xht'   =>  'application/xhtml+xml',
      'zip'   =>  'application/zip',
      'mid'   =>  'audio/midi',
      'midi'  =>  'audio/midi',
      'mpga'  =>  'audio/mpeg',
      'mp2'   =>  'audio/mpeg',
      'mp3'   =>  'audio/mpeg',
      'aif'   =>  'audio/x-aiff',
      'aiff'  =>  'audio/x-aiff',
      'aifc'  =>  'audio/x-aiff',
      'ram'   =>  'audio/x-pn-realaudio',
      'rm'    =>  'audio/x-pn-realaudio',
      'rpm'   =>  'audio/x-pn-realaudio-plugin',
      'ra'    =>  'audio/x-realaudio',
      'rv'    =>  'video/vnd.rn-realvideo',
      'wav'   =>  'audio/x-wav',
      'bmp'   =>  'image/bmp',
      'gif'   =>  'image/gif',
      'jpeg'  =>  'image/jpeg',
      'jpg'   =>  'image/jpeg',
      'jpe'   =>  'image/jpeg',
      'png'   =>  'image/png',
      'tiff'  =>  'image/tiff',
      'tif'   =>  'image/tiff',
      'css'   =>  'text/css',
      'html'  =>  'text/html',
      'htm'   =>  'text/html',
      'shtml' =>  'text/html',
      'txt'   =>  'text/plain',
      'text'  =>  'text/plain',
      'log'   =>  'text/plain',
      'rtx'   =>  'text/richtext',
      'rtf'   =>  'text/rtf',
      'xml'   =>  'text/xml',
      'xsl'   =>  'text/xml',
      'mpeg'  =>  'video/mpeg',
      'mpg'   =>  'video/mpeg',
      'mpe'   =>  'video/mpeg',
      'qt'    =>  'video/quicktime',
      'mov'   =>  'video/quicktime',
      'avi'   =>  'video/x-msvideo',
      'movie' =>  'video/x-sgi-movie',
      'doc'   =>  'application/msword',
      'word'  =>  'application/msword',
      'xl'    =>  'application/excel',
      'eml'   =>  'message/rfc822'
    );
    return ( ! isset($mimes[strtolower($ext)])) ? 'application/octet-stream' : $mimes[strtolower($ext)];
  }

  /**
   * Set (or reset) Class Objects (variables)
   *
   * Usage Example:
   * $page->set('X-Priority', '3');
   *
   * @access public
   * @param string $name Parameter Name
   * @param mixed $value Parameter Value
   * NOTE: will not work with arrays, there are no arrays to set/reset
   */
  public function set ( $name, $value = '' ) {
    if ( isset($this->$name) ) {
      $this->$name = $value;
    } else {
      $this->SetError('Cannot set or reset variable ' . $name);
      return false;
    }
  }

  /**
   * Read a file from a supplied filename and return it.
   *
   * @access public
   * @param string $filename Parameter File Name
   */
  public function getFile($filename) {
    $return = '';
    if ($fp = fopen($filename, 'rb')) {
      while (!feof($fp)) {
        $return .= fread($fp, 1024);
      }
      fclose($fp);
      return $return;
    } else {
      return false;
    }
  }

  /**
   * Strips newlines to prevent header injection.
   * @access public
   * @param string $str String
   * @return string
   */
  public function SecureHeader($str) {
    $str = trim($str);
    $str = str_replace("\r", "", $str);
    $str = str_replace("\n", "", $str);
    return $str;
  }

  /**
   * Set the private key file and password to sign the message.
   *
   * @access public
   * @param string $key_filename Parameter File Name
   * @param string $key_pass Password for private key
   */
  public function Sign($cert_filename, $key_filename, $key_pass) {
    $this->sign_cert_file = $cert_filename;
    $this->sign_key_file = $key_filename;
    $this->sign_key_pass = $key_pass;
  }
}

?>
